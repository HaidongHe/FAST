!STARTOFREGISTRYGENERATEDFILE './ElastoDyn_Types.f90'

! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
!*********************************************************************************************************************************
! ElastoDyn_Types
!.................................................................................................................................
! LICENSING
! Copyright (C) 2012 National Renewable Energy Laboratory
!
! This file is part of ElastoDyn.
!
! ElastoDyn is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as
! published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
!
! This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty
! of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
!
! You should have received a copy of the GNU General Public License along with ElastoDyn.
! If not, see <http://www.gnu.org/licenses/>.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE ElastoDyn_Types
! This module contains all of the user-defined types needed in ElastoDyn. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE NWTC_Library
IMPLICIT NONE
! =========  BladeInputData  =======
  TYPE, PUBLIC :: BladeInputData
    INTEGER(IntKi)  :: NBlInpSt 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlFract 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PitchAx 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StrcTwst 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BMassDen 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpStff 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgStff 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: GJStff 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EAStff 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Alpha 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PrecrvRef 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PreswpRef 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpcgOf 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgcgOf 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpEAOf 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgEAOf 
    REAL(ReKi) , DIMENSION(1:2)  :: BldFlDmp 
    REAL(ReKi) , DIMENSION(1:1)  :: BldEdDmp 
    REAL(ReKi) , DIMENSION(1:2)  :: FlStTunr 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldFl1Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldFl2Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldEdgSh 
  END TYPE BladeInputData
! =======================
! =========  ED_BladeMeshInputData  =======
  TYPE, PUBLIC :: ED_BladeMeshInputData
    INTEGER(IntKi)  :: BldNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AeroTwst 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Chord 
  END TYPE ED_BladeMeshInputData
! =======================
! =========  ED_InputFile  =======
  TYPE, PUBLIC :: ED_InputFile
    REAL(DbKi)  :: DT 
    REAL(ReKi)  :: Gravity 
    LOGICAL  :: FlapDOF1 
    LOGICAL  :: FlapDOF2 
    LOGICAL  :: EdgeDOF 
    LOGICAL  :: TeetDOF 
    LOGICAL  :: DrTrDOF 
    LOGICAL  :: GenDOF 
    LOGICAL  :: YawDOF 
    LOGICAL  :: TwFADOF1 
    LOGICAL  :: TwFADOF2 
    LOGICAL  :: TwSSDOF1 
    LOGICAL  :: TwSSDOF2 
    LOGICAL  :: PtfmSgDOF 
    LOGICAL  :: PtfmSwDOF 
    LOGICAL  :: PtfmHvDOF 
    LOGICAL  :: PtfmRDOF 
    LOGICAL  :: PtfmPDOF 
    LOGICAL  :: PtfmYDOF 
    REAL(ReKi)  :: OoPDefl 
    REAL(ReKi)  :: IPDefl 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch 
    REAL(ReKi)  :: TeetDefl 
    REAL(ReKi)  :: Azimuth 
    REAL(ReKi)  :: RotSpeed 
    REAL(ReKi)  :: NacYaw 
    REAL(ReKi)  :: TTDspFA 
    REAL(ReKi)  :: TTDspSS 
    REAL(ReKi)  :: PtfmSurge 
    REAL(ReKi)  :: PtfmSway 
    REAL(ReKi)  :: PtfmHeave 
    REAL(ReKi)  :: PtfmRoll 
    REAL(ReKi)  :: PtfmPitch 
    REAL(ReKi)  :: PtfmYaw 
    INTEGER(IntKi)  :: NumBl 
    REAL(ReKi)  :: TipRad 
    REAL(ReKi)  :: HubRad 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PreCone 
    REAL(ReKi)  :: HubCM 
    REAL(ReKi)  :: UndSling 
    REAL(ReKi)  :: Delta3 
    REAL(ReKi)  :: AzimB1Up 
    REAL(ReKi)  :: OverHang 
    REAL(ReKi)  :: ShftGagL 
    REAL(ReKi)  :: ShftTilt 
    REAL(ReKi)  :: NacCMxn 
    REAL(ReKi)  :: NacCMyn 
    REAL(ReKi)  :: NacCMzn 
    REAL(ReKi)  :: NcIMUxn 
    REAL(ReKi)  :: NcIMUyn 
    REAL(ReKi)  :: NcIMUzn 
    REAL(ReKi)  :: Twr2Shft 
    REAL(ReKi)  :: TowerHt 
    REAL(ReKi)  :: TowerBsHt 
    REAL(ReKi)  :: PtfmCMxt 
    REAL(ReKi)  :: PtfmCMyt 
    REAL(ReKi)  :: PtfmCMzt 
    REAL(ReKi)  :: PtfmRefzt 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TipMass 
    REAL(ReKi)  :: HubMass 
    REAL(ReKi)  :: HubIner 
    REAL(ReKi)  :: GenIner 
    REAL(ReKi)  :: NacMass 
    REAL(ReKi)  :: NacYIner 
    REAL(ReKi)  :: YawBrMass 
    REAL(ReKi)  :: PtfmMass 
    REAL(ReKi)  :: PtfmRIner 
    REAL(ReKi)  :: PtfmPIner 
    REAL(ReKi)  :: PtfmYIner 
    TYPE(ED_BladeMeshInputData) , DIMENSION(:), ALLOCATABLE  :: InpBlMesh 
    TYPE(BladeInputData) , DIMENSION(:), ALLOCATABLE  :: InpBl 
    INTEGER(IntKi)  :: TeetMod 
    REAL(ReKi)  :: TeetDmpP 
    REAL(ReKi)  :: TeetDmp 
    REAL(ReKi)  :: TeetCDmp 
    REAL(ReKi)  :: TeetSStP 
    REAL(ReKi)  :: TeetHStP 
    REAL(ReKi)  :: TeetSSSp 
    REAL(ReKi)  :: TeetHSSp 
    REAL(ReKi)  :: GBoxEff 
    REAL(ReKi)  :: GBRatio 
    REAL(ReKi)  :: DTTorSpr 
    REAL(ReKi)  :: DTTorDmp 
    LOGICAL  :: Furling 
    INTEGER(IntKi)  :: TwrNodes 
    LOGICAL  :: SumPrint 
    INTEGER(IntKi)  :: OutFile 
    LOGICAL  :: TabDelim 
    CHARACTER(20)  :: OutFmt 
    REAL(DbKi)  :: Tstart 
    INTEGER(IntKi)  :: DecFact 
    INTEGER(IntKi)  :: NTwGages 
    INTEGER(IntKi) , DIMENSION(1:9)  :: TwrGagNd 
    INTEGER(IntKi)  :: NBlGages 
    INTEGER(IntKi) , DIMENSION(1:9)  :: BldGagNd 
    INTEGER(IntKi)  :: NumOuts 
    CHARACTER(10) , DIMENSION(:), ALLOCATABLE  :: OutList 
    INTEGER(IntKi)  :: NTwInpSt 
    REAL(ReKi) , DIMENSION(1:2)  :: TwrFADmp 
    REAL(ReKi) , DIMENSION(1:2)  :: TwrSSDmp 
    REAL(ReKi) , DIMENSION(1:2)  :: FAStTunr 
    REAL(ReKi) , DIMENSION(1:2)  :: SSStTunr 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HtFract 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TMassDen 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAStif 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSStif 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAM1Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAM2Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSM1Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSM2Sh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwGJStif 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwEAStif 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAcgOf 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSScgOf 
    LOGICAL  :: RFrlDOF 
    LOGICAL  :: TFrlDOF 
    REAL(ReKi)  :: RotFurl 
    REAL(ReKi)  :: TailFurl 
    REAL(ReKi)  :: Yaw2Shft 
    REAL(ReKi)  :: ShftSkew 
    REAL(ReKi)  :: RFrlCMxn 
    REAL(ReKi)  :: RFrlCMyn 
    REAL(ReKi)  :: RFrlCMzn 
    REAL(ReKi)  :: BoomCMxn 
    REAL(ReKi)  :: BoomCMyn 
    REAL(ReKi)  :: BoomCMzn 
    REAL(ReKi)  :: TFinCMxn 
    REAL(ReKi)  :: TFinCMyn 
    REAL(ReKi)  :: TFinCMzn 
    REAL(ReKi)  :: TFinCPxn 
    REAL(ReKi)  :: TFinCPyn 
    REAL(ReKi)  :: TFinCPzn 
    REAL(ReKi)  :: TFinSkew 
    REAL(ReKi)  :: TFinTilt 
    REAL(ReKi)  :: TFinBank 
    REAL(ReKi)  :: RFrlPntxn 
    REAL(ReKi)  :: RFrlPntyn 
    REAL(ReKi)  :: RFrlPntzn 
    REAL(ReKi)  :: RFrlSkew 
    REAL(ReKi)  :: RFrlTilt 
    REAL(ReKi)  :: TFrlPntxn 
    REAL(ReKi)  :: TFrlPntyn 
    REAL(ReKi)  :: TFrlPntzn 
    REAL(ReKi)  :: TFrlSkew 
    REAL(ReKi)  :: TFrlTilt 
    REAL(ReKi)  :: RFrlMass 
    REAL(ReKi)  :: BoomMass 
    REAL(ReKi)  :: TFinMass 
    REAL(ReKi)  :: RFrlIner 
    REAL(ReKi)  :: TFrlIner 
    INTEGER(IntKi)  :: RFrlMod 
    REAL(ReKi)  :: RFrlSpr 
    REAL(ReKi)  :: RFrlDmp 
    REAL(ReKi)  :: RFrlCDmp 
    REAL(ReKi)  :: RFrlUSSP 
    REAL(ReKi)  :: RFrlDSSP 
    REAL(ReKi)  :: RFrlUSSpr 
    REAL(ReKi)  :: RFrlDSSpr 
    REAL(ReKi)  :: RFrlUSDP 
    REAL(ReKi)  :: RFrlDSDP 
    REAL(ReKi)  :: RFrlUSDmp 
    REAL(ReKi)  :: RFrlDSDmp 
    INTEGER(IntKi)  :: TFrlMod 
    REAL(ReKi)  :: TFrlSpr 
    REAL(ReKi)  :: TFrlDmp 
    REAL(ReKi)  :: TFrlCDmp 
    REAL(ReKi)  :: TFrlUSSP 
    REAL(ReKi)  :: TFrlDSSP 
    REAL(ReKi)  :: TFrlUSSpr 
    REAL(ReKi)  :: TFrlDSSpr 
    REAL(ReKi)  :: TFrlUSDP 
    REAL(ReKi)  :: TFrlDSDP 
    REAL(ReKi)  :: TFrlUSDmp 
    REAL(ReKi)  :: TFrlDSDmp 
    INTEGER(IntKi)  :: method 
  END TYPE ED_InputFile
! =======================
! =========  ED_CoordSys  =======
  TYPE, PUBLIC :: ED_CoordSys
    REAL(ReKi) , DIMENSION(1:3)  :: a1 
    REAL(ReKi) , DIMENSION(1:3)  :: a2 
    REAL(ReKi) , DIMENSION(1:3)  :: a3 
    REAL(ReKi) , DIMENSION(1:3)  :: b1 
    REAL(ReKi) , DIMENSION(1:3)  :: b2 
    REAL(ReKi) , DIMENSION(1:3)  :: b3 
    REAL(ReKi) , DIMENSION(1:3)  :: c1 
    REAL(ReKi) , DIMENSION(1:3)  :: c2 
    REAL(ReKi) , DIMENSION(1:3)  :: c3 
    REAL(ReKi) , DIMENSION(1:3)  :: d1 
    REAL(ReKi) , DIMENSION(1:3)  :: d2 
    REAL(ReKi) , DIMENSION(1:3)  :: d3 
    REAL(ReKi) , DIMENSION(1:3)  :: e1 
    REAL(ReKi) , DIMENSION(1:3)  :: e2 
    REAL(ReKi) , DIMENSION(1:3)  :: e3 
    REAL(ReKi) , DIMENSION(1:3)  :: f1 
    REAL(ReKi) , DIMENSION(1:3)  :: f2 
    REAL(ReKi) , DIMENSION(1:3)  :: f3 
    REAL(ReKi) , DIMENSION(1:3)  :: g1 
    REAL(ReKi) , DIMENSION(1:3)  :: g2 
    REAL(ReKi) , DIMENSION(1:3)  :: g3 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i3 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j3 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m2 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m3 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n2 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n3 
    REAL(ReKi) , DIMENSION(1:3)  :: p1 
    REAL(ReKi) , DIMENSION(1:3)  :: p2 
    REAL(ReKi) , DIMENSION(1:3)  :: p3 
    REAL(ReKi) , DIMENSION(1:3)  :: rf1 
    REAL(ReKi) , DIMENSION(1:3)  :: rf2 
    REAL(ReKi) , DIMENSION(1:3)  :: rf3 
    REAL(ReKi) , DIMENSION(1:3)  :: rfa 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t3 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te2 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te3 
    REAL(ReKi) , DIMENSION(1:3)  :: tf1 
    REAL(ReKi) , DIMENSION(1:3)  :: tf2 
    REAL(ReKi) , DIMENSION(1:3)  :: tf3 
    REAL(ReKi) , DIMENSION(1:3)  :: tfa 
    REAL(ReKi) , DIMENSION(1:3)  :: z1 
    REAL(ReKi) , DIMENSION(1:3)  :: z2 
    REAL(ReKi) , DIMENSION(1:3)  :: z3 
  END TYPE ED_CoordSys
! =======================
! =========  ED_ActiveDOFs  =======
  TYPE, PUBLIC :: ED_ActiveDOFs
    INTEGER(IntKi)  :: NActvDOF 
    INTEGER(IntKi)  :: NPCE 
    INTEGER(IntKi)  :: NPDE 
    INTEGER(IntKi)  :: NPIE 
    INTEGER(IntKi)  :: NPTE 
    INTEGER(IntKi)  :: NPTTE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NPSBE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NPSE 
    INTEGER(IntKi)  :: NPUE 
    INTEGER(IntKi)  :: NPYE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PCE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PDE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PIE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PTE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PTTE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PS 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PSBE 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PSE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PUE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PYE 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: SrtPS 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: SrtPSNAUG 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: Diag 
  END TYPE ED_ActiveDOFs
! =======================
! =========  ED_RtHndSide  =======
  TYPE, PUBLIC :: ED_RtHndSide
    REAL(ReKi) , DIMENSION(1:3)  :: rO 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rQS 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rS 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rS0S 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rT 
    REAL(ReKi) , DIMENSION(1:3)  :: rT0O 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rT0T 
    REAL(ReKi) , DIMENSION(1:3)  :: rZ 
    REAL(ReKi) , DIMENSION(1:3)  :: rZO 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rZT 
    REAL(ReKi) , DIMENSION(1:3)  :: rPQ 
    REAL(ReKi) , DIMENSION(1:3)  :: rP 
    REAL(ReKi) , DIMENSION(1:3)  :: rV 
    REAL(ReKi) , DIMENSION(1:3)  :: rZY 
    REAL(ReKi) , DIMENSION(1:3)  :: rOU 
    REAL(ReKi) , DIMENSION(1:3)  :: rOV 
    REAL(ReKi) , DIMENSION(1:3)  :: rVD 
    REAL(ReKi) , DIMENSION(1:3)  :: rOW 
    REAL(ReKi) , DIMENSION(1:3)  :: rPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rPS0 
    REAL(ReKi) , DIMENSION(1:3)  :: rQC 
    REAL(ReKi) , DIMENSION(1:3)  :: rVIMU 
    REAL(ReKi) , DIMENSION(1:3)  :: rVP 
    REAL(ReKi) , DIMENSION(1:3)  :: rWI 
    REAL(ReKi) , DIMENSION(1:3)  :: rWJ 
    REAL(ReKi) , DIMENSION(1:3)  :: rWK 
    REAL(ReKi) , DIMENSION(1:3)  :: rZT0 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngPosEF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngPosXF 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AngPosHM 
    REAL(ReKi) , DIMENSION(1:3)  :: AngPosXB 
    REAL(ReKi) , DIMENSION(1:3)  :: AngPosEX 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEA 
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: PAngVelEF 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEG 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEH 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEL 
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PAngVelEM 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEN 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEA 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEB 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelER 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEX 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEG 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEH 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEL 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEN 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEB 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelER 
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEX 
    REAL(ReKi)  :: TeetAngVel 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEBt 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccERt 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEXt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngAccEFt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngVelEF 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEAt 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEGt 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEHt 
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccENt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccECt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEDt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEIt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEJt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEUt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEYt 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: LinVelES 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: LinVelET 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: LinVelESm2 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEIMU 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEO 
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PLinVelES 
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: PLinVelET 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEZ 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEC 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelED 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEI 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEJ 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEK 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEP 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEQ 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEU 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEV 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEW 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEY 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEIMUt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEOt 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: LinAccESt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: LinAccETt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEZt 
    REAL(ReKi) , DIMENSION(1:3)  :: LinVelEIMU 
    REAL(ReKi) , DIMENSION(1:3)  :: LinVelEZ 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcONcRtt 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcPRott 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FrcS0Bt 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcT0Trbt 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FSAero 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSTipDrag 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FTHydrot 
    REAL(ReKi) , DIMENSION(1:3)  :: FZHydrot 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MFHydrot 
    REAL(ReKi) , DIMENSION(1:3)  :: MomBNcRtt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MomH0Bt 
    REAL(ReKi) , DIMENSION(1:3)  :: MomLPRott 
    REAL(ReKi) , DIMENSION(1:3)  :: MomNGnRtt 
    REAL(ReKi) , DIMENSION(1:3)  :: MomNTailt 
    REAL(ReKi) , DIMENSION(1:3)  :: MomX0Trbt 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: MMAero 
    REAL(ReKi) , DIMENSION(1:3)  :: MXHydrot 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcONcRt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcPRot 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PFrcS0B 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcT0Trb 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PFTHydro 
    REAL(ReKi) , DIMENSION(1:6,1:3)  :: PFZHydro 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PMFHydro 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomBNcRt 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PMomH0B 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomLPRot 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomNGnRt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomNTail 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomX0Trb 
    REAL(ReKi) , DIMENSION(1:6,1:3)  :: PMXHydro 
    REAL(ReKi)  :: TeetAng 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcVGnRtt 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcWTailt 
    REAL(ReKi) , DIMENSION(1:3)  :: FrcZAllt 
    REAL(ReKi) , DIMENSION(1:3)  :: MomXAllt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcVGnRt 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcWTail 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcZAll 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomXAll 
    REAL(ReKi)  :: TeetMom 
    REAL(ReKi)  :: TFrlMom 
    REAL(ReKi)  :: RFrlMom 
    REAL(ReKi)  :: GBoxEffFac 
  END TYPE ED_RtHndSide
! =======================
! =========  ED_InitInputType  =======
  TYPE, PUBLIC :: ED_InitInputType
    CHARACTER(1024)  :: InputFile 
    CHARACTER(1024)  :: ADInputFile 
    CHARACTER(1024)  :: RootName 
  END TYPE ED_InitInputType
! =======================
! =========  ED_InitOutputType  =======
  TYPE, PUBLIC :: ED_InitOutputType
    CHARACTER(10) , DIMENSION(:), ALLOCATABLE  :: WriteOutputHdr 
    CHARACTER(10) , DIMENSION(:), ALLOCATABLE  :: WriteOutputUnt 
    TYPE(ProgDesc)  :: Ver 
    INTEGER(IntKi)  :: NumBl 
    REAL(ReKi)  :: Gravity 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch 
  END TYPE ED_InitOutputType
! =======================
! =========  ED_ContinuousStateType  =======
  TYPE, PUBLIC :: ED_ContinuousStateType
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QT 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QDT 
  END TYPE ED_ContinuousStateType
! =======================
! =========  ED_DiscreteStateType  =======
  TYPE, PUBLIC :: ED_DiscreteStateType
    REAL(ReKi)  :: DummyDiscState 
  END TYPE ED_DiscreteStateType
! =======================
! =========  ED_ConstraintStateType  =======
  TYPE, PUBLIC :: ED_ConstraintStateType
    REAL(ReKi)  :: DummyConstrState 
  END TYPE ED_ConstraintStateType
! =======================
! =========  ED_OtherStateType  =======
  TYPE, PUBLIC :: ED_OtherStateType
    TYPE(ED_CoordSys)  :: CoordSys 
    TYPE(ED_RtHndSide)  :: RtHS 
    INTEGER(IntKi)  :: n 
    TYPE(ED_ContinuousStateType) , DIMENSION(1:4)  :: xdot 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: IC 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QD2T 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AugMat 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AugMatOut 
    TYPE(ED_ContinuousStateType)  :: k1 
  END TYPE ED_OtherStateType
! =======================
! =========  ED_ParameterType  =======
  TYPE, PUBLIC :: ED_ParameterType
    REAL(DbKi)  :: DT 
    REAL(DbKi)  :: DT24 
    INTEGER(IntKi)  :: BldNodes 
    INTEGER(IntKi)  :: TipNode 
    INTEGER(IntKi)  :: NDOF 
    REAL(ReKi)  :: TwoPiNB 
    INTEGER(IntKi)  :: NAug 
    INTEGER(IntKi)  :: NPH 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PH 
    INTEGER(IntKi)  :: NPM 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PM 
    LOGICAL , DIMENSION(:), ALLOCATABLE  :: DOF_Flag 
    CHARACTER(99) , DIMENSION(:), ALLOCATABLE  :: DOF_Desc 
    TYPE(ED_ActiveDOFs)  :: DOFs 
    INTEGER(IntKi)  :: NumOuts = 0 
    CHARACTER(20)  :: OutFmt 
    INTEGER(IntKi)  :: NBlGages = 0 
    INTEGER(IntKi)  :: NTwGages = 0 
    TYPE(OutParmType) , DIMENSION(:), ALLOCATABLE  :: OutParam 
    CHARACTER(1)  :: Delim 
    REAL(ReKi)  :: AvgNrmTpRd 
    REAL(ReKi)  :: AzimB1Up 
    REAL(ReKi)  :: CosDel3 = 1.0 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CosPreC 
    REAL(ReKi)  :: CRFrlSkew 
    REAL(ReKi)  :: CRFrlSkw2 
    REAL(ReKi)  :: CRFrlTilt 
    REAL(ReKi)  :: CRFrlTlt2 
    REAL(ReKi)  :: CShftSkew 
    REAL(ReKi)  :: CShftTilt 
    REAL(ReKi)  :: CSRFrlSkw 
    REAL(ReKi)  :: CSRFrlTlt 
    REAL(ReKi)  :: CSTFrlSkw 
    REAL(ReKi)  :: CSTFrlTlt 
    REAL(ReKi)  :: CTFinBank 
    REAL(ReKi)  :: CTFinSkew 
    REAL(ReKi)  :: CTFinTilt 
    REAL(ReKi)  :: CTFrlSkew 
    REAL(ReKi)  :: CTFrlSkw2 
    REAL(ReKi)  :: CTFrlTilt 
    REAL(ReKi)  :: CTFrlTlt2 
    REAL(ReKi)  :: FASTHH 
    REAL(ReKi)  :: HubCM 
    REAL(ReKi)  :: HubRad 
    REAL(ReKi)  :: NacCMxn 
    REAL(ReKi)  :: NacCMyn 
    REAL(ReKi)  :: NacCMzn 
    REAL(ReKi)  :: OverHang 
    REAL(ReKi)  :: ProjArea 
    REAL(ReKi)  :: PtfmRefzt 
    REAL(ReKi)  :: RefTwrHt 
    REAL(ReKi)  :: RFrlPntxn 
    REAL(ReKi)  :: RFrlPntyn 
    REAL(ReKi)  :: RFrlPntzn 
    REAL(ReKi)  :: rVDxn 
    REAL(ReKi)  :: rVDyn 
    REAL(ReKi)  :: rVDzn 
    REAL(ReKi)  :: rVIMUxn 
    REAL(ReKi)  :: rVIMUyn 
    REAL(ReKi)  :: rVIMUzn 
    REAL(ReKi)  :: rVPxn 
    REAL(ReKi)  :: rVPyn 
    REAL(ReKi)  :: rVPzn 
    REAL(ReKi)  :: rWIxn 
    REAL(ReKi)  :: rWIyn 
    REAL(ReKi)  :: rWIzn 
    REAL(ReKi)  :: rWJxn 
    REAL(ReKi)  :: rWJyn 
    REAL(ReKi)  :: rWJzn 
    REAL(ReKi)  :: rWKxn 
    REAL(ReKi)  :: rWKyn 
    REAL(ReKi)  :: rWKzn 
    REAL(ReKi)  :: rZT0zt 
    REAL(ReKi)  :: rZYzt 
    REAL(ReKi)  :: SinDel3 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SinPreC 
    REAL(ReKi)  :: SRFrlSkew 
    REAL(ReKi)  :: SRFrlSkw2 
    REAL(ReKi)  :: SRFrlTilt 
    REAL(ReKi)  :: SRFrlTlt2 
    REAL(ReKi)  :: SShftSkew 
    REAL(ReKi)  :: SShftTilt 
    REAL(ReKi)  :: STFinBank 
    REAL(ReKi)  :: STFinSkew 
    REAL(ReKi)  :: STFinTilt 
    REAL(ReKi)  :: STFrlSkew 
    REAL(ReKi)  :: STFrlSkw2 
    REAL(ReKi)  :: STFrlTilt 
    REAL(ReKi)  :: STFrlTlt2 
    REAL(ReKi)  :: TFrlPntxn 
    REAL(ReKi)  :: TFrlPntyn 
    REAL(ReKi)  :: TFrlPntzn 
    REAL(ReKi)  :: TipRad 
    REAL(ReKi)  :: TowerHt 
    REAL(ReKi)  :: TowerBsHt 
    REAL(ReKi)  :: UndSling 
    INTEGER(IntKi)  :: NumBl 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AxRedTFA 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AxRedTSS 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: CTFA 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: CTSS 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DHNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HNodesNorm 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: KTFA 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: KTSS 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: MassT 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTSS 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrFASF 
    REAL(ReKi)  :: TwrFlexL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrSSSF 
    INTEGER(IntKi)  :: TTopNode 
    INTEGER(IntKi)  :: TwrNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: InerTFA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: InerTSS 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTGJ 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTEA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTFA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: cgOffTFA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: cgOffTSS 
    REAL(ReKi)  :: AtfaIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldCG 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldMass 
    REAL(ReKi)  :: BoomMass 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FirstMom 
    REAL(ReKi)  :: GenIner 
    REAL(ReKi)  :: Hubg1Iner 
    REAL(ReKi)  :: Hubg2Iner 
    REAL(ReKi)  :: HubMass 
    REAL(ReKi)  :: Nacd2Iner 
    REAL(ReKi)  :: NacMass 
    REAL(ReKi)  :: PtfmMass 
    REAL(ReKi)  :: PtfmPIner 
    REAL(ReKi)  :: PtfmRIner 
    REAL(ReKi)  :: PtfmYIner 
    REAL(ReKi)  :: RFrlMass 
    REAL(ReKi)  :: RotIner 
    REAL(ReKi)  :: RotMass 
    REAL(ReKi)  :: RrfaIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SecondMom 
    REAL(ReKi)  :: TFinMass 
    REAL(ReKi)  :: TFrlIner 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TipMass 
    REAL(ReKi)  :: TurbMass 
    REAL(ReKi)  :: TwrMass 
    REAL(ReKi)  :: TwrTpMass 
    REAL(ReKi)  :: YawBrMass 
    REAL(ReKi)  :: AirDens 
    REAL(ReKi)  :: Gravity 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PitchAxis 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AeroTwst 
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: AxRedBld 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BAlpha 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldEDamp 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFDamp 
    REAL(ReKi)  :: BldFlexL 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CAeroTwst 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CBE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CBF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: cgOffBEdg 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: cgOffBFlp 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Chord 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CThetaS 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DRNodes 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: EAOffBEdg 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: EAOffBFlp 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FStTunr 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: InerBEdg 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: InerBFlp 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: KBE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: KBF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MassB 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: RefAxisxb 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: RefAxisyb 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodesNorm 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rSAerCenn1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rSAerCenn2 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SAeroTwst 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBEA 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBGJ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SThetaS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ThetaS 
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: TwistedSF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFl1Sh 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFl2Sh 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldEdgSh 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FreqBE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FreqBF 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: FreqTFA 
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: FreqTSS 
    REAL(ReKi)  :: TeetCDmp 
    REAL(ReKi)  :: TeetDmp 
    REAL(ReKi)  :: TeetDmpP 
    REAL(ReKi)  :: TeetHSSp 
    REAL(ReKi)  :: TeetHStP 
    REAL(ReKi)  :: TeetSSSp 
    REAL(ReKi)  :: TeetSStP 
    INTEGER(IntKi)  :: TeetMod 
    REAL(ReKi)  :: TFrlCDmp 
    REAL(ReKi)  :: TFrlDmp 
    REAL(ReKi)  :: TFrlDSDmp 
    REAL(ReKi)  :: TFrlDSDP 
    REAL(ReKi)  :: TFrlDSSP 
    REAL(ReKi)  :: TFrlDSSpr 
    REAL(ReKi)  :: TFrlSpr 
    REAL(ReKi)  :: TFrlUSDmp 
    REAL(ReKi)  :: TFrlUSDP 
    REAL(ReKi)  :: TFrlUSSP 
    REAL(ReKi)  :: TFrlUSSpr 
    INTEGER(IntKi)  :: TFrlMod 
    REAL(ReKi)  :: RFrlCDmp 
    REAL(ReKi)  :: RFrlDmp 
    REAL(ReKi)  :: RFrlDSDmp 
    REAL(ReKi)  :: RFrlDSDP 
    REAL(ReKi)  :: RFrlDSSP 
    REAL(ReKi)  :: RFrlDSSpr 
    REAL(ReKi)  :: RFrlSpr 
    REAL(ReKi)  :: RFrlUSDmp 
    REAL(ReKi)  :: RFrlUSDP 
    REAL(ReKi)  :: RFrlUSSP 
    REAL(ReKi)  :: RFrlUSSpr 
    INTEGER(IntKi)  :: RFrlMod 
    REAL(ReKi)  :: ShftGagL 
    INTEGER(IntKi) , DIMENSION(1:9)  :: BldGagNd 
    INTEGER(IntKi) , DIMENSION(1:9)  :: TwrGagNd 
    REAL(DbKi)  :: TStart 
    REAL(ReKi)  :: DTTorDmp 
    REAL(ReKi)  :: DTTorSpr 
    REAL(ReKi)  :: GBRatio 
    REAL(ReKi)  :: GBoxEff 
    REAL(ReKi)  :: RotSpeed 
    CHARACTER(1024)  :: RootName 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BElmntMass 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TElmntMass 
    INTEGER(IntKi)  :: method 
    REAL(ReKi)  :: PtfmCMxt 
    REAL(ReKi)  :: PtfmCMyt 
  END TYPE ED_ParameterType
! =======================
! =========  ED_InputType  =======
  TYPE, PUBLIC :: ED_InputType
    TYPE(MeshType)  :: PlatformPtMesh 
    TYPE(MeshType)  :: TowerLn2Mesh 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrAddedMass 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: PtfmAddedMass 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitchCom 
    REAL(ReKi)  :: YawMom 
    REAL(ReKi)  :: GenTrq 
    REAL(ReKi)  :: HSSBrTrq 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AeroBladeForce 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AeroBladeMoment 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FTAero 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MFAero 
  END TYPE ED_InputType
! =======================
! =========  ED_OutputType  =======
  TYPE, PUBLIC :: ED_OutputType
    TYPE(MeshType)  :: PlatformPtMesh 
    TYPE(MeshType)  :: TowerLn2Mesh 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AllOuts 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: WriteOutput 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch 
    REAL(ReKi)  :: Yaw 
    REAL(ReKi)  :: YawRate 
    REAL(ReKi)  :: LSS_Spd 
    REAL(ReKi)  :: HSS_Spd 
    REAL(ReKi)  :: RotSpeed 
    REAL(ReKi)  :: TwrAccel 
    REAL(ReKi)  :: YawAngle 
    REAL(ReKi) , DIMENSION(1:3)  :: RootMyc 
    REAL(ReKi)  :: YawBrTAxp 
    REAL(ReKi)  :: YawBrTAyp 
    REAL(ReKi)  :: LSSTipPxa 
    REAL(ReKi) , DIMENSION(1:3)  :: RootMxc 
    REAL(ReKi)  :: LSSTipMya 
    REAL(ReKi)  :: LSSTipMza 
    REAL(ReKi)  :: LSSTipMys 
    REAL(ReKi)  :: LSSTipMzs 
    REAL(ReKi)  :: YawBrMyn 
    REAL(ReKi)  :: YawBrMzn 
    REAL(ReKi)  :: NcIMURAxs 
    REAL(ReKi)  :: NcIMURAys 
    REAL(ReKi)  :: NcIMURAzs 
    REAL(ReKi)  :: RotPwr 
  END TYPE ED_OutputType
! =======================
CONTAINS
 SUBROUTINE ED_Copybladeinputdata( SrcbladeinputdataData, DstbladeinputdataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(bladeinputdata), INTENT(INOUT) :: SrcbladeinputdataData
   TYPE(bladeinputdata), INTENT(INOUT) :: DstbladeinputdataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstbladeinputdataData%NBlInpSt = SrcbladeinputdataData%NBlInpSt
IF (ALLOCATED(SrcbladeinputdataData%BlFract)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%BlFract,1)
   i1_u = UBOUND(SrcbladeinputdataData%BlFract,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%BlFract)) THEN 
      ALLOCATE(DstbladeinputdataData%BlFract(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%BlFract.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%BlFract = SrcbladeinputdataData%BlFract
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%PitchAx)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%PitchAx,1)
   i1_u = UBOUND(SrcbladeinputdataData%PitchAx,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%PitchAx)) THEN 
      ALLOCATE(DstbladeinputdataData%PitchAx(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%PitchAx.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%PitchAx = SrcbladeinputdataData%PitchAx
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%StrcTwst)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%StrcTwst,1)
   i1_u = UBOUND(SrcbladeinputdataData%StrcTwst,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%StrcTwst)) THEN 
      ALLOCATE(DstbladeinputdataData%StrcTwst(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%StrcTwst.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%StrcTwst = SrcbladeinputdataData%StrcTwst
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%BMassDen)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%BMassDen,1)
   i1_u = UBOUND(SrcbladeinputdataData%BMassDen,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%BMassDen)) THEN 
      ALLOCATE(DstbladeinputdataData%BMassDen(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%BMassDen.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%BMassDen = SrcbladeinputdataData%BMassDen
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%FlpStff)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%FlpStff,1)
   i1_u = UBOUND(SrcbladeinputdataData%FlpStff,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%FlpStff)) THEN 
      ALLOCATE(DstbladeinputdataData%FlpStff(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%FlpStff.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%FlpStff = SrcbladeinputdataData%FlpStff
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%EdgStff)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%EdgStff,1)
   i1_u = UBOUND(SrcbladeinputdataData%EdgStff,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%EdgStff)) THEN 
      ALLOCATE(DstbladeinputdataData%EdgStff(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%EdgStff.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%EdgStff = SrcbladeinputdataData%EdgStff
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%GJStff)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%GJStff,1)
   i1_u = UBOUND(SrcbladeinputdataData%GJStff,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%GJStff)) THEN 
      ALLOCATE(DstbladeinputdataData%GJStff(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%GJStff.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%GJStff = SrcbladeinputdataData%GJStff
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%EAStff)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%EAStff,1)
   i1_u = UBOUND(SrcbladeinputdataData%EAStff,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%EAStff)) THEN 
      ALLOCATE(DstbladeinputdataData%EAStff(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%EAStff.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%EAStff = SrcbladeinputdataData%EAStff
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%Alpha)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%Alpha,1)
   i1_u = UBOUND(SrcbladeinputdataData%Alpha,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%Alpha)) THEN 
      ALLOCATE(DstbladeinputdataData%Alpha(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%Alpha.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%Alpha = SrcbladeinputdataData%Alpha
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%FlpIner)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%FlpIner,1)
   i1_u = UBOUND(SrcbladeinputdataData%FlpIner,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%FlpIner)) THEN 
      ALLOCATE(DstbladeinputdataData%FlpIner(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%FlpIner.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%FlpIner = SrcbladeinputdataData%FlpIner
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%EdgIner)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%EdgIner,1)
   i1_u = UBOUND(SrcbladeinputdataData%EdgIner,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%EdgIner)) THEN 
      ALLOCATE(DstbladeinputdataData%EdgIner(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%EdgIner.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%EdgIner = SrcbladeinputdataData%EdgIner
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%PrecrvRef)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%PrecrvRef,1)
   i1_u = UBOUND(SrcbladeinputdataData%PrecrvRef,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%PrecrvRef)) THEN 
      ALLOCATE(DstbladeinputdataData%PrecrvRef(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%PrecrvRef.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%PrecrvRef = SrcbladeinputdataData%PrecrvRef
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%PreswpRef)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%PreswpRef,1)
   i1_u = UBOUND(SrcbladeinputdataData%PreswpRef,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%PreswpRef)) THEN 
      ALLOCATE(DstbladeinputdataData%PreswpRef(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%PreswpRef.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%PreswpRef = SrcbladeinputdataData%PreswpRef
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%FlpcgOf)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%FlpcgOf,1)
   i1_u = UBOUND(SrcbladeinputdataData%FlpcgOf,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%FlpcgOf)) THEN 
      ALLOCATE(DstbladeinputdataData%FlpcgOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%FlpcgOf.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%FlpcgOf = SrcbladeinputdataData%FlpcgOf
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%EdgcgOf)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%EdgcgOf,1)
   i1_u = UBOUND(SrcbladeinputdataData%EdgcgOf,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%EdgcgOf)) THEN 
      ALLOCATE(DstbladeinputdataData%EdgcgOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%EdgcgOf.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%EdgcgOf = SrcbladeinputdataData%EdgcgOf
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%FlpEAOf)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%FlpEAOf,1)
   i1_u = UBOUND(SrcbladeinputdataData%FlpEAOf,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%FlpEAOf)) THEN 
      ALLOCATE(DstbladeinputdataData%FlpEAOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%FlpEAOf.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%FlpEAOf = SrcbladeinputdataData%FlpEAOf
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%EdgEAOf)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%EdgEAOf,1)
   i1_u = UBOUND(SrcbladeinputdataData%EdgEAOf,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%EdgEAOf)) THEN 
      ALLOCATE(DstbladeinputdataData%EdgEAOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%EdgEAOf.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%EdgEAOf = SrcbladeinputdataData%EdgEAOf
ENDIF
   DstbladeinputdataData%BldFlDmp = SrcbladeinputdataData%BldFlDmp
   DstbladeinputdataData%BldEdDmp = SrcbladeinputdataData%BldEdDmp
   DstbladeinputdataData%FlStTunr = SrcbladeinputdataData%FlStTunr
IF (ALLOCATED(SrcbladeinputdataData%BldFl1Sh)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%BldFl1Sh,1)
   i1_u = UBOUND(SrcbladeinputdataData%BldFl1Sh,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%BldFl1Sh)) THEN 
      ALLOCATE(DstbladeinputdataData%BldFl1Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%BldFl1Sh.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%BldFl1Sh = SrcbladeinputdataData%BldFl1Sh
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%BldFl2Sh)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%BldFl2Sh,1)
   i1_u = UBOUND(SrcbladeinputdataData%BldFl2Sh,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%BldFl2Sh)) THEN 
      ALLOCATE(DstbladeinputdataData%BldFl2Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%BldFl2Sh.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%BldFl2Sh = SrcbladeinputdataData%BldFl2Sh
ENDIF
IF (ALLOCATED(SrcbladeinputdataData%BldEdgSh)) THEN
   i1_l = LBOUND(SrcbladeinputdataData%BldEdgSh,1)
   i1_u = UBOUND(SrcbladeinputdataData%BldEdgSh,1)
   IF (.NOT.ALLOCATED(DstbladeinputdataData%BldEdgSh)) THEN 
      ALLOCATE(DstbladeinputdataData%BldEdgSh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copybladeinputdata: Error allocating DstbladeinputdataData%BldEdgSh.'
         RETURN
      END IF
   END IF
   DstbladeinputdataData%BldEdgSh = SrcbladeinputdataData%BldEdgSh
ENDIF
 END SUBROUTINE ED_Copybladeinputdata

 SUBROUTINE ED_Destroybladeinputdata( bladeinputdataData, ErrStat, ErrMsg )
  TYPE(bladeinputdata), INTENT(INOUT) :: bladeinputdataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(bladeinputdataData%BlFract) ) DEALLOCATE(bladeinputdataData%BlFract)
  IF ( ALLOCATED(bladeinputdataData%PitchAx) ) DEALLOCATE(bladeinputdataData%PitchAx)
  IF ( ALLOCATED(bladeinputdataData%StrcTwst) ) DEALLOCATE(bladeinputdataData%StrcTwst)
  IF ( ALLOCATED(bladeinputdataData%BMassDen) ) DEALLOCATE(bladeinputdataData%BMassDen)
  IF ( ALLOCATED(bladeinputdataData%FlpStff) ) DEALLOCATE(bladeinputdataData%FlpStff)
  IF ( ALLOCATED(bladeinputdataData%EdgStff) ) DEALLOCATE(bladeinputdataData%EdgStff)
  IF ( ALLOCATED(bladeinputdataData%GJStff) ) DEALLOCATE(bladeinputdataData%GJStff)
  IF ( ALLOCATED(bladeinputdataData%EAStff) ) DEALLOCATE(bladeinputdataData%EAStff)
  IF ( ALLOCATED(bladeinputdataData%Alpha) ) DEALLOCATE(bladeinputdataData%Alpha)
  IF ( ALLOCATED(bladeinputdataData%FlpIner) ) DEALLOCATE(bladeinputdataData%FlpIner)
  IF ( ALLOCATED(bladeinputdataData%EdgIner) ) DEALLOCATE(bladeinputdataData%EdgIner)
  IF ( ALLOCATED(bladeinputdataData%PrecrvRef) ) DEALLOCATE(bladeinputdataData%PrecrvRef)
  IF ( ALLOCATED(bladeinputdataData%PreswpRef) ) DEALLOCATE(bladeinputdataData%PreswpRef)
  IF ( ALLOCATED(bladeinputdataData%FlpcgOf) ) DEALLOCATE(bladeinputdataData%FlpcgOf)
  IF ( ALLOCATED(bladeinputdataData%EdgcgOf) ) DEALLOCATE(bladeinputdataData%EdgcgOf)
  IF ( ALLOCATED(bladeinputdataData%FlpEAOf) ) DEALLOCATE(bladeinputdataData%FlpEAOf)
  IF ( ALLOCATED(bladeinputdataData%EdgEAOf) ) DEALLOCATE(bladeinputdataData%EdgEAOf)
  IF ( ALLOCATED(bladeinputdataData%BldFl1Sh) ) DEALLOCATE(bladeinputdataData%BldFl1Sh)
  IF ( ALLOCATED(bladeinputdataData%BldFl2Sh) ) DEALLOCATE(bladeinputdataData%BldFl2Sh)
  IF ( ALLOCATED(bladeinputdataData%BldEdgSh) ) DEALLOCATE(bladeinputdataData%BldEdgSh)
 END SUBROUTINE ED_Destroybladeinputdata

 SUBROUTINE ED_Packbladeinputdata( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(bladeinputdata),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NBlInpSt
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlFract )  ! BlFract 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PitchAx )  ! PitchAx 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StrcTwst )  ! StrcTwst 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BMassDen )  ! BMassDen 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlpStff )  ! FlpStff 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EdgStff )  ! EdgStff 
  Re_BufSz    = Re_BufSz    + SIZE( InData%GJStff )  ! GJStff 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EAStff )  ! EAStff 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Alpha )  ! Alpha 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlpIner )  ! FlpIner 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EdgIner )  ! EdgIner 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PrecrvRef )  ! PrecrvRef 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PreswpRef )  ! PreswpRef 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlpcgOf )  ! FlpcgOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EdgcgOf )  ! EdgcgOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlpEAOf )  ! FlpEAOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EdgEAOf )  ! EdgEAOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFlDmp )  ! BldFlDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdDmp )  ! BldEdDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlStTunr )  ! FlStTunr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl1Sh )  ! BldFl1Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl2Sh )  ! BldFl2Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdgSh )  ! BldEdgSh 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%BlFract) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlFract))-1 ) =  PACK(InData%BlFract ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlFract)
  ENDIF
  IF ( ALLOCATED(InData%PitchAx) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PitchAx))-1 ) =  PACK(InData%PitchAx ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PitchAx)
  ENDIF
  IF ( ALLOCATED(InData%StrcTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StrcTwst))-1 ) =  PACK(InData%StrcTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StrcTwst)
  ENDIF
  IF ( ALLOCATED(InData%BMassDen) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BMassDen))-1 ) =  PACK(InData%BMassDen ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BMassDen)
  ENDIF
  IF ( ALLOCATED(InData%FlpStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpStff))-1 ) =  PACK(InData%FlpStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpStff)
  ENDIF
  IF ( ALLOCATED(InData%EdgStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgStff))-1 ) =  PACK(InData%EdgStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgStff)
  ENDIF
  IF ( ALLOCATED(InData%GJStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%GJStff))-1 ) =  PACK(InData%GJStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%GJStff)
  ENDIF
  IF ( ALLOCATED(InData%EAStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAStff))-1 ) =  PACK(InData%EAStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAStff)
  ENDIF
  IF ( ALLOCATED(InData%Alpha) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Alpha))-1 ) =  PACK(InData%Alpha ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Alpha)
  ENDIF
  IF ( ALLOCATED(InData%FlpIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpIner))-1 ) =  PACK(InData%FlpIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpIner)
  ENDIF
  IF ( ALLOCATED(InData%EdgIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgIner))-1 ) =  PACK(InData%EdgIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgIner)
  ENDIF
  IF ( ALLOCATED(InData%PrecrvRef) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PrecrvRef))-1 ) =  PACK(InData%PrecrvRef ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PrecrvRef)
  ENDIF
  IF ( ALLOCATED(InData%PreswpRef) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PreswpRef))-1 ) =  PACK(InData%PreswpRef ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PreswpRef)
  ENDIF
  IF ( ALLOCATED(InData%FlpcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpcgOf))-1 ) =  PACK(InData%FlpcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpcgOf)
  ENDIF
  IF ( ALLOCATED(InData%EdgcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgcgOf))-1 ) =  PACK(InData%EdgcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgcgOf)
  ENDIF
  IF ( ALLOCATED(InData%FlpEAOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpEAOf))-1 ) =  PACK(InData%FlpEAOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpEAOf)
  ENDIF
  IF ( ALLOCATED(InData%EdgEAOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgEAOf))-1 ) =  PACK(InData%EdgEAOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgEAOf)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFlDmp))-1 ) =  PACK(InData%BldFlDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%BldFlDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdDmp))-1 ) =  PACK(InData%BldEdDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlStTunr))-1 ) =  PACK(InData%FlStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FlStTunr)
  IF ( ALLOCATED(InData%BldFl1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl1Sh))-1 ) =  PACK(InData%BldFl1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldFl2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl2Sh))-1 ) =  PACK(InData%BldFl2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldEdgSh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdgSh))-1 ) =  PACK(InData%BldEdgSh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdgSh)
  ENDIF
 END SUBROUTINE ED_Packbladeinputdata

 SUBROUTINE ED_UnPackbladeinputdata( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(bladeinputdata), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NBlInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%BlFract) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlFract,1))); mask1 = .TRUE.
    OutData%BlFract = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlFract))-1 ),mask1,OutData%BlFract)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlFract)
  ENDIF
  IF ( ALLOCATED(OutData%PitchAx) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PitchAx,1))); mask1 = .TRUE.
    OutData%PitchAx = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PitchAx))-1 ),mask1,OutData%PitchAx)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PitchAx)
  ENDIF
  IF ( ALLOCATED(OutData%StrcTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StrcTwst,1))); mask1 = .TRUE.
    OutData%StrcTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StrcTwst))-1 ),mask1,OutData%StrcTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StrcTwst)
  ENDIF
  IF ( ALLOCATED(OutData%BMassDen) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BMassDen,1))); mask1 = .TRUE.
    OutData%BMassDen = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BMassDen))-1 ),mask1,OutData%BMassDen)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BMassDen)
  ENDIF
  IF ( ALLOCATED(OutData%FlpStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpStff,1))); mask1 = .TRUE.
    OutData%FlpStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpStff))-1 ),mask1,OutData%FlpStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpStff)
  ENDIF
  IF ( ALLOCATED(OutData%EdgStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgStff,1))); mask1 = .TRUE.
    OutData%EdgStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgStff))-1 ),mask1,OutData%EdgStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgStff)
  ENDIF
  IF ( ALLOCATED(OutData%GJStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%GJStff,1))); mask1 = .TRUE.
    OutData%GJStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%GJStff))-1 ),mask1,OutData%GJStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%GJStff)
  ENDIF
  IF ( ALLOCATED(OutData%EAStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EAStff,1))); mask1 = .TRUE.
    OutData%EAStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAStff))-1 ),mask1,OutData%EAStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAStff)
  ENDIF
  IF ( ALLOCATED(OutData%Alpha) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Alpha,1))); mask1 = .TRUE.
    OutData%Alpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Alpha))-1 ),mask1,OutData%Alpha)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Alpha)
  ENDIF
  IF ( ALLOCATED(OutData%FlpIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpIner,1))); mask1 = .TRUE.
    OutData%FlpIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpIner))-1 ),mask1,OutData%FlpIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpIner)
  ENDIF
  IF ( ALLOCATED(OutData%EdgIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgIner,1))); mask1 = .TRUE.
    OutData%EdgIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgIner))-1 ),mask1,OutData%EdgIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgIner)
  ENDIF
  IF ( ALLOCATED(OutData%PrecrvRef) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PrecrvRef,1))); mask1 = .TRUE.
    OutData%PrecrvRef = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PrecrvRef))-1 ),mask1,OutData%PrecrvRef)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PrecrvRef)
  ENDIF
  IF ( ALLOCATED(OutData%PreswpRef) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PreswpRef,1))); mask1 = .TRUE.
    OutData%PreswpRef = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PreswpRef))-1 ),mask1,OutData%PreswpRef)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PreswpRef)
  ENDIF
  IF ( ALLOCATED(OutData%FlpcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpcgOf,1))); mask1 = .TRUE.
    OutData%FlpcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpcgOf))-1 ),mask1,OutData%FlpcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%EdgcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgcgOf,1))); mask1 = .TRUE.
    OutData%EdgcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgcgOf))-1 ),mask1,OutData%EdgcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%FlpEAOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpEAOf,1))); mask1 = .TRUE.
    OutData%FlpEAOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpEAOf))-1 ),mask1,OutData%FlpEAOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpEAOf)
  ENDIF
  IF ( ALLOCATED(OutData%EdgEAOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgEAOf,1))); mask1 = .TRUE.
    OutData%EdgEAOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgEAOf))-1 ),mask1,OutData%EdgEAOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgEAOf)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%BldFlDmp,1))); mask1 = .TRUE.
  OutData%BldFlDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFlDmp))-1 ),mask1,OutData%BldFlDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFlDmp)
  ALLOCATE(mask1(SIZE(OutData%BldEdDmp,1))); mask1 = .TRUE.
  OutData%BldEdDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdDmp))-1 ),mask1,OutData%BldEdDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdDmp)
  ALLOCATE(mask1(SIZE(OutData%FlStTunr,1))); mask1 = .TRUE.
  OutData%FlStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlStTunr))-1 ),mask1,OutData%FlStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FlStTunr)
  IF ( ALLOCATED(OutData%BldFl1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldFl1Sh,1))); mask1 = .TRUE.
    OutData%BldFl1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl1Sh))-1 ),mask1,OutData%BldFl1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldFl2Sh,1))); mask1 = .TRUE.
    OutData%BldFl2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl2Sh))-1 ),mask1,OutData%BldFl2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldEdgSh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldEdgSh,1))); mask1 = .TRUE.
    OutData%BldEdgSh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdgSh))-1 ),mask1,OutData%BldEdgSh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdgSh)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackbladeinputdata

 SUBROUTINE ED_Copyblademeshinputdata( SrcblademeshinputdataData, DstblademeshinputdataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ed_blademeshinputdata), INTENT(INOUT) :: SrcblademeshinputdataData
   TYPE(ed_blademeshinputdata), INTENT(INOUT) :: DstblademeshinputdataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstblademeshinputdataData%BldNodes = SrcblademeshinputdataData%BldNodes
IF (ALLOCATED(SrcblademeshinputdataData%RNodes)) THEN
   i1_l = LBOUND(SrcblademeshinputdataData%RNodes,1)
   i1_u = UBOUND(SrcblademeshinputdataData%RNodes,1)
   IF (.NOT.ALLOCATED(DstblademeshinputdataData%RNodes)) THEN 
      ALLOCATE(DstblademeshinputdataData%RNodes(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyblademeshinputdata: Error allocating DstblademeshinputdataData%RNodes.'
         RETURN
      END IF
   END IF
   DstblademeshinputdataData%RNodes = SrcblademeshinputdataData%RNodes
ENDIF
IF (ALLOCATED(SrcblademeshinputdataData%AeroTwst)) THEN
   i1_l = LBOUND(SrcblademeshinputdataData%AeroTwst,1)
   i1_u = UBOUND(SrcblademeshinputdataData%AeroTwst,1)
   IF (.NOT.ALLOCATED(DstblademeshinputdataData%AeroTwst)) THEN 
      ALLOCATE(DstblademeshinputdataData%AeroTwst(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyblademeshinputdata: Error allocating DstblademeshinputdataData%AeroTwst.'
         RETURN
      END IF
   END IF
   DstblademeshinputdataData%AeroTwst = SrcblademeshinputdataData%AeroTwst
ENDIF
IF (ALLOCATED(SrcblademeshinputdataData%Chord)) THEN
   i1_l = LBOUND(SrcblademeshinputdataData%Chord,1)
   i1_u = UBOUND(SrcblademeshinputdataData%Chord,1)
   IF (.NOT.ALLOCATED(DstblademeshinputdataData%Chord)) THEN 
      ALLOCATE(DstblademeshinputdataData%Chord(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyblademeshinputdata: Error allocating DstblademeshinputdataData%Chord.'
         RETURN
      END IF
   END IF
   DstblademeshinputdataData%Chord = SrcblademeshinputdataData%Chord
ENDIF
 END SUBROUTINE ED_Copyblademeshinputdata

 SUBROUTINE ED_Destroyblademeshinputdata( blademeshinputdataData, ErrStat, ErrMsg )
  TYPE(ed_blademeshinputdata), INTENT(INOUT) :: blademeshinputdataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(blademeshinputdataData%RNodes) ) DEALLOCATE(blademeshinputdataData%RNodes)
  IF ( ALLOCATED(blademeshinputdataData%AeroTwst) ) DEALLOCATE(blademeshinputdataData%AeroTwst)
  IF ( ALLOCATED(blademeshinputdataData%Chord) ) DEALLOCATE(blademeshinputdataData%Chord)
 END SUBROUTINE ED_Destroyblademeshinputdata

 SUBROUTINE ED_Packblademeshinputdata( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ed_blademeshinputdata),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! BldNodes
  Re_BufSz    = Re_BufSz    + SIZE( InData%RNodes )  ! RNodes 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AeroTwst )  ! AeroTwst 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Chord )  ! Chord 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%BldNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%RNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodes))-1 ) =  PACK(InData%RNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodes)
  ENDIF
  IF ( ALLOCATED(InData%AeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroTwst))-1 ) =  PACK(InData%AeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%Chord) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Chord))-1 ) =  PACK(InData%Chord ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Chord)
  ENDIF
 END SUBROUTINE ED_Packblademeshinputdata

 SUBROUTINE ED_UnPackblademeshinputdata( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ed_blademeshinputdata), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%BldNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%RNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodes,1))); mask1 = .TRUE.
    OutData%RNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodes))-1 ),mask1,OutData%RNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodes)
  ENDIF
  IF ( ALLOCATED(OutData%AeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AeroTwst,1))); mask1 = .TRUE.
    OutData%AeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroTwst))-1 ),mask1,OutData%AeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%Chord) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Chord,1))); mask1 = .TRUE.
    OutData%Chord = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Chord))-1 ),mask1,OutData%Chord)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Chord)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackblademeshinputdata

 SUBROUTINE ED_Copyinputfile( SrcinputfileData, DstinputfileData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ed_inputfile), INTENT(INOUT) :: SrcinputfileData
   TYPE(ed_inputfile), INTENT(INOUT) :: DstinputfileData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstinputfileData%DT = SrcinputfileData%DT
   DstinputfileData%Gravity = SrcinputfileData%Gravity
   DstinputfileData%FlapDOF1 = SrcinputfileData%FlapDOF1
   DstinputfileData%FlapDOF2 = SrcinputfileData%FlapDOF2
   DstinputfileData%EdgeDOF = SrcinputfileData%EdgeDOF
   DstinputfileData%TeetDOF = SrcinputfileData%TeetDOF
   DstinputfileData%DrTrDOF = SrcinputfileData%DrTrDOF
   DstinputfileData%GenDOF = SrcinputfileData%GenDOF
   DstinputfileData%YawDOF = SrcinputfileData%YawDOF
   DstinputfileData%TwFADOF1 = SrcinputfileData%TwFADOF1
   DstinputfileData%TwFADOF2 = SrcinputfileData%TwFADOF2
   DstinputfileData%TwSSDOF1 = SrcinputfileData%TwSSDOF1
   DstinputfileData%TwSSDOF2 = SrcinputfileData%TwSSDOF2
   DstinputfileData%PtfmSgDOF = SrcinputfileData%PtfmSgDOF
   DstinputfileData%PtfmSwDOF = SrcinputfileData%PtfmSwDOF
   DstinputfileData%PtfmHvDOF = SrcinputfileData%PtfmHvDOF
   DstinputfileData%PtfmRDOF = SrcinputfileData%PtfmRDOF
   DstinputfileData%PtfmPDOF = SrcinputfileData%PtfmPDOF
   DstinputfileData%PtfmYDOF = SrcinputfileData%PtfmYDOF
   DstinputfileData%OoPDefl = SrcinputfileData%OoPDefl
   DstinputfileData%IPDefl = SrcinputfileData%IPDefl
IF (ALLOCATED(SrcinputfileData%BlPitch)) THEN
   i1_l = LBOUND(SrcinputfileData%BlPitch,1)
   i1_u = UBOUND(SrcinputfileData%BlPitch,1)
   IF (.NOT.ALLOCATED(DstinputfileData%BlPitch)) THEN 
      ALLOCATE(DstinputfileData%BlPitch(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%BlPitch.'
         RETURN
      END IF
   END IF
   DstinputfileData%BlPitch = SrcinputfileData%BlPitch
ENDIF
   DstinputfileData%TeetDefl = SrcinputfileData%TeetDefl
   DstinputfileData%Azimuth = SrcinputfileData%Azimuth
   DstinputfileData%RotSpeed = SrcinputfileData%RotSpeed
   DstinputfileData%NacYaw = SrcinputfileData%NacYaw
   DstinputfileData%TTDspFA = SrcinputfileData%TTDspFA
   DstinputfileData%TTDspSS = SrcinputfileData%TTDspSS
   DstinputfileData%PtfmSurge = SrcinputfileData%PtfmSurge
   DstinputfileData%PtfmSway = SrcinputfileData%PtfmSway
   DstinputfileData%PtfmHeave = SrcinputfileData%PtfmHeave
   DstinputfileData%PtfmRoll = SrcinputfileData%PtfmRoll
   DstinputfileData%PtfmPitch = SrcinputfileData%PtfmPitch
   DstinputfileData%PtfmYaw = SrcinputfileData%PtfmYaw
   DstinputfileData%NumBl = SrcinputfileData%NumBl
   DstinputfileData%TipRad = SrcinputfileData%TipRad
   DstinputfileData%HubRad = SrcinputfileData%HubRad
IF (ALLOCATED(SrcinputfileData%PreCone)) THEN
   i1_l = LBOUND(SrcinputfileData%PreCone,1)
   i1_u = UBOUND(SrcinputfileData%PreCone,1)
   IF (.NOT.ALLOCATED(DstinputfileData%PreCone)) THEN 
      ALLOCATE(DstinputfileData%PreCone(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%PreCone.'
         RETURN
      END IF
   END IF
   DstinputfileData%PreCone = SrcinputfileData%PreCone
ENDIF
   DstinputfileData%HubCM = SrcinputfileData%HubCM
   DstinputfileData%UndSling = SrcinputfileData%UndSling
   DstinputfileData%Delta3 = SrcinputfileData%Delta3
   DstinputfileData%AzimB1Up = SrcinputfileData%AzimB1Up
   DstinputfileData%OverHang = SrcinputfileData%OverHang
   DstinputfileData%ShftGagL = SrcinputfileData%ShftGagL
   DstinputfileData%ShftTilt = SrcinputfileData%ShftTilt
   DstinputfileData%NacCMxn = SrcinputfileData%NacCMxn
   DstinputfileData%NacCMyn = SrcinputfileData%NacCMyn
   DstinputfileData%NacCMzn = SrcinputfileData%NacCMzn
   DstinputfileData%NcIMUxn = SrcinputfileData%NcIMUxn
   DstinputfileData%NcIMUyn = SrcinputfileData%NcIMUyn
   DstinputfileData%NcIMUzn = SrcinputfileData%NcIMUzn
   DstinputfileData%Twr2Shft = SrcinputfileData%Twr2Shft
   DstinputfileData%TowerHt = SrcinputfileData%TowerHt
   DstinputfileData%TowerBsHt = SrcinputfileData%TowerBsHt
   DstinputfileData%PtfmCMxt = SrcinputfileData%PtfmCMxt
   DstinputfileData%PtfmCMyt = SrcinputfileData%PtfmCMyt
   DstinputfileData%PtfmCMzt = SrcinputfileData%PtfmCMzt
   DstinputfileData%PtfmRefzt = SrcinputfileData%PtfmRefzt
IF (ALLOCATED(SrcinputfileData%TipMass)) THEN
   i1_l = LBOUND(SrcinputfileData%TipMass,1)
   i1_u = UBOUND(SrcinputfileData%TipMass,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TipMass)) THEN 
      ALLOCATE(DstinputfileData%TipMass(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TipMass.'
         RETURN
      END IF
   END IF
   DstinputfileData%TipMass = SrcinputfileData%TipMass
ENDIF
   DstinputfileData%HubMass = SrcinputfileData%HubMass
   DstinputfileData%HubIner = SrcinputfileData%HubIner
   DstinputfileData%GenIner = SrcinputfileData%GenIner
   DstinputfileData%NacMass = SrcinputfileData%NacMass
   DstinputfileData%NacYIner = SrcinputfileData%NacYIner
   DstinputfileData%YawBrMass = SrcinputfileData%YawBrMass
   DstinputfileData%PtfmMass = SrcinputfileData%PtfmMass
   DstinputfileData%PtfmRIner = SrcinputfileData%PtfmRIner
   DstinputfileData%PtfmPIner = SrcinputfileData%PtfmPIner
   DstinputfileData%PtfmYIner = SrcinputfileData%PtfmYIner
IF (ALLOCATED(SrcinputfileData%InpBlMesh)) THEN
   i1_l = LBOUND(SrcinputfileData%InpBlMesh,1)
   i1_u = UBOUND(SrcinputfileData%InpBlMesh,1)
   IF (.NOT.ALLOCATED(DstinputfileData%InpBlMesh)) THEN 
      ALLOCATE(DstinputfileData%InpBlMesh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%InpBlMesh.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcinputfileData%InpBlMesh,1), UBOUND(SrcinputfileData%InpBlMesh,1)
      CALL ED_Copyblademeshinputdata( SrcinputfileData%InpBlMesh(i1), DstinputfileData%InpBlMesh(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
IF (ALLOCATED(SrcinputfileData%InpBl)) THEN
   i1_l = LBOUND(SrcinputfileData%InpBl,1)
   i1_u = UBOUND(SrcinputfileData%InpBl,1)
   IF (.NOT.ALLOCATED(DstinputfileData%InpBl)) THEN 
      ALLOCATE(DstinputfileData%InpBl(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%InpBl.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcinputfileData%InpBl,1), UBOUND(SrcinputfileData%InpBl,1)
      CALL ED_Copybladeinputdata( SrcinputfileData%InpBl(i1), DstinputfileData%InpBl(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
   DstinputfileData%TeetMod = SrcinputfileData%TeetMod
   DstinputfileData%TeetDmpP = SrcinputfileData%TeetDmpP
   DstinputfileData%TeetDmp = SrcinputfileData%TeetDmp
   DstinputfileData%TeetCDmp = SrcinputfileData%TeetCDmp
   DstinputfileData%TeetSStP = SrcinputfileData%TeetSStP
   DstinputfileData%TeetHStP = SrcinputfileData%TeetHStP
   DstinputfileData%TeetSSSp = SrcinputfileData%TeetSSSp
   DstinputfileData%TeetHSSp = SrcinputfileData%TeetHSSp
   DstinputfileData%GBoxEff = SrcinputfileData%GBoxEff
   DstinputfileData%GBRatio = SrcinputfileData%GBRatio
   DstinputfileData%DTTorSpr = SrcinputfileData%DTTorSpr
   DstinputfileData%DTTorDmp = SrcinputfileData%DTTorDmp
   DstinputfileData%Furling = SrcinputfileData%Furling
   DstinputfileData%TwrNodes = SrcinputfileData%TwrNodes
   DstinputfileData%SumPrint = SrcinputfileData%SumPrint
   DstinputfileData%OutFile = SrcinputfileData%OutFile
   DstinputfileData%TabDelim = SrcinputfileData%TabDelim
   DstinputfileData%OutFmt = SrcinputfileData%OutFmt
   DstinputfileData%Tstart = SrcinputfileData%Tstart
   DstinputfileData%DecFact = SrcinputfileData%DecFact
   DstinputfileData%NTwGages = SrcinputfileData%NTwGages
   DstinputfileData%TwrGagNd = SrcinputfileData%TwrGagNd
   DstinputfileData%NBlGages = SrcinputfileData%NBlGages
   DstinputfileData%BldGagNd = SrcinputfileData%BldGagNd
   DstinputfileData%NumOuts = SrcinputfileData%NumOuts
IF (ALLOCATED(SrcinputfileData%OutList)) THEN
   i1_l = LBOUND(SrcinputfileData%OutList,1)
   i1_u = UBOUND(SrcinputfileData%OutList,1)
   IF (.NOT.ALLOCATED(DstinputfileData%OutList)) THEN 
      ALLOCATE(DstinputfileData%OutList(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%OutList.'
         RETURN
      END IF
   END IF
   DstinputfileData%OutList = SrcinputfileData%OutList
ENDIF
   DstinputfileData%NTwInpSt = SrcinputfileData%NTwInpSt
   DstinputfileData%TwrFADmp = SrcinputfileData%TwrFADmp
   DstinputfileData%TwrSSDmp = SrcinputfileData%TwrSSDmp
   DstinputfileData%FAStTunr = SrcinputfileData%FAStTunr
   DstinputfileData%SSStTunr = SrcinputfileData%SSStTunr
IF (ALLOCATED(SrcinputfileData%HtFract)) THEN
   i1_l = LBOUND(SrcinputfileData%HtFract,1)
   i1_u = UBOUND(SrcinputfileData%HtFract,1)
   IF (.NOT.ALLOCATED(DstinputfileData%HtFract)) THEN 
      ALLOCATE(DstinputfileData%HtFract(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%HtFract.'
         RETURN
      END IF
   END IF
   DstinputfileData%HtFract = SrcinputfileData%HtFract
ENDIF
IF (ALLOCATED(SrcinputfileData%TMassDen)) THEN
   i1_l = LBOUND(SrcinputfileData%TMassDen,1)
   i1_u = UBOUND(SrcinputfileData%TMassDen,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TMassDen)) THEN 
      ALLOCATE(DstinputfileData%TMassDen(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TMassDen.'
         RETURN
      END IF
   END IF
   DstinputfileData%TMassDen = SrcinputfileData%TMassDen
ENDIF
IF (ALLOCATED(SrcinputfileData%TwFAStif)) THEN
   i1_l = LBOUND(SrcinputfileData%TwFAStif,1)
   i1_u = UBOUND(SrcinputfileData%TwFAStif,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwFAStif)) THEN 
      ALLOCATE(DstinputfileData%TwFAStif(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwFAStif.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwFAStif = SrcinputfileData%TwFAStif
ENDIF
IF (ALLOCATED(SrcinputfileData%TwSSStif)) THEN
   i1_l = LBOUND(SrcinputfileData%TwSSStif,1)
   i1_u = UBOUND(SrcinputfileData%TwSSStif,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwSSStif)) THEN 
      ALLOCATE(DstinputfileData%TwSSStif(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwSSStif.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwSSStif = SrcinputfileData%TwSSStif
ENDIF
IF (ALLOCATED(SrcinputfileData%TwFAM1Sh)) THEN
   i1_l = LBOUND(SrcinputfileData%TwFAM1Sh,1)
   i1_u = UBOUND(SrcinputfileData%TwFAM1Sh,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwFAM1Sh)) THEN 
      ALLOCATE(DstinputfileData%TwFAM1Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwFAM1Sh.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwFAM1Sh = SrcinputfileData%TwFAM1Sh
ENDIF
IF (ALLOCATED(SrcinputfileData%TwFAM2Sh)) THEN
   i1_l = LBOUND(SrcinputfileData%TwFAM2Sh,1)
   i1_u = UBOUND(SrcinputfileData%TwFAM2Sh,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwFAM2Sh)) THEN 
      ALLOCATE(DstinputfileData%TwFAM2Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwFAM2Sh.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwFAM2Sh = SrcinputfileData%TwFAM2Sh
ENDIF
IF (ALLOCATED(SrcinputfileData%TwSSM1Sh)) THEN
   i1_l = LBOUND(SrcinputfileData%TwSSM1Sh,1)
   i1_u = UBOUND(SrcinputfileData%TwSSM1Sh,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwSSM1Sh)) THEN 
      ALLOCATE(DstinputfileData%TwSSM1Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwSSM1Sh.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwSSM1Sh = SrcinputfileData%TwSSM1Sh
ENDIF
IF (ALLOCATED(SrcinputfileData%TwSSM2Sh)) THEN
   i1_l = LBOUND(SrcinputfileData%TwSSM2Sh,1)
   i1_u = UBOUND(SrcinputfileData%TwSSM2Sh,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwSSM2Sh)) THEN 
      ALLOCATE(DstinputfileData%TwSSM2Sh(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwSSM2Sh.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwSSM2Sh = SrcinputfileData%TwSSM2Sh
ENDIF
IF (ALLOCATED(SrcinputfileData%TwGJStif)) THEN
   i1_l = LBOUND(SrcinputfileData%TwGJStif,1)
   i1_u = UBOUND(SrcinputfileData%TwGJStif,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwGJStif)) THEN 
      ALLOCATE(DstinputfileData%TwGJStif(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwGJStif.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwGJStif = SrcinputfileData%TwGJStif
ENDIF
IF (ALLOCATED(SrcinputfileData%TwEAStif)) THEN
   i1_l = LBOUND(SrcinputfileData%TwEAStif,1)
   i1_u = UBOUND(SrcinputfileData%TwEAStif,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwEAStif)) THEN 
      ALLOCATE(DstinputfileData%TwEAStif(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwEAStif.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwEAStif = SrcinputfileData%TwEAStif
ENDIF
IF (ALLOCATED(SrcinputfileData%TwFAIner)) THEN
   i1_l = LBOUND(SrcinputfileData%TwFAIner,1)
   i1_u = UBOUND(SrcinputfileData%TwFAIner,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwFAIner)) THEN 
      ALLOCATE(DstinputfileData%TwFAIner(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwFAIner.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwFAIner = SrcinputfileData%TwFAIner
ENDIF
IF (ALLOCATED(SrcinputfileData%TwSSIner)) THEN
   i1_l = LBOUND(SrcinputfileData%TwSSIner,1)
   i1_u = UBOUND(SrcinputfileData%TwSSIner,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwSSIner)) THEN 
      ALLOCATE(DstinputfileData%TwSSIner(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwSSIner.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwSSIner = SrcinputfileData%TwSSIner
ENDIF
IF (ALLOCATED(SrcinputfileData%TwFAcgOf)) THEN
   i1_l = LBOUND(SrcinputfileData%TwFAcgOf,1)
   i1_u = UBOUND(SrcinputfileData%TwFAcgOf,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwFAcgOf)) THEN 
      ALLOCATE(DstinputfileData%TwFAcgOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwFAcgOf.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwFAcgOf = SrcinputfileData%TwFAcgOf
ENDIF
IF (ALLOCATED(SrcinputfileData%TwSScgOf)) THEN
   i1_l = LBOUND(SrcinputfileData%TwSScgOf,1)
   i1_u = UBOUND(SrcinputfileData%TwSScgOf,1)
   IF (.NOT.ALLOCATED(DstinputfileData%TwSScgOf)) THEN 
      ALLOCATE(DstinputfileData%TwSScgOf(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyinputfile: Error allocating DstinputfileData%TwSScgOf.'
         RETURN
      END IF
   END IF
   DstinputfileData%TwSScgOf = SrcinputfileData%TwSScgOf
ENDIF
   DstinputfileData%RFrlDOF = SrcinputfileData%RFrlDOF
   DstinputfileData%TFrlDOF = SrcinputfileData%TFrlDOF
   DstinputfileData%RotFurl = SrcinputfileData%RotFurl
   DstinputfileData%TailFurl = SrcinputfileData%TailFurl
   DstinputfileData%Yaw2Shft = SrcinputfileData%Yaw2Shft
   DstinputfileData%ShftSkew = SrcinputfileData%ShftSkew
   DstinputfileData%RFrlCMxn = SrcinputfileData%RFrlCMxn
   DstinputfileData%RFrlCMyn = SrcinputfileData%RFrlCMyn
   DstinputfileData%RFrlCMzn = SrcinputfileData%RFrlCMzn
   DstinputfileData%BoomCMxn = SrcinputfileData%BoomCMxn
   DstinputfileData%BoomCMyn = SrcinputfileData%BoomCMyn
   DstinputfileData%BoomCMzn = SrcinputfileData%BoomCMzn
   DstinputfileData%TFinCMxn = SrcinputfileData%TFinCMxn
   DstinputfileData%TFinCMyn = SrcinputfileData%TFinCMyn
   DstinputfileData%TFinCMzn = SrcinputfileData%TFinCMzn
   DstinputfileData%TFinCPxn = SrcinputfileData%TFinCPxn
   DstinputfileData%TFinCPyn = SrcinputfileData%TFinCPyn
   DstinputfileData%TFinCPzn = SrcinputfileData%TFinCPzn
   DstinputfileData%TFinSkew = SrcinputfileData%TFinSkew
   DstinputfileData%TFinTilt = SrcinputfileData%TFinTilt
   DstinputfileData%TFinBank = SrcinputfileData%TFinBank
   DstinputfileData%RFrlPntxn = SrcinputfileData%RFrlPntxn
   DstinputfileData%RFrlPntyn = SrcinputfileData%RFrlPntyn
   DstinputfileData%RFrlPntzn = SrcinputfileData%RFrlPntzn
   DstinputfileData%RFrlSkew = SrcinputfileData%RFrlSkew
   DstinputfileData%RFrlTilt = SrcinputfileData%RFrlTilt
   DstinputfileData%TFrlPntxn = SrcinputfileData%TFrlPntxn
   DstinputfileData%TFrlPntyn = SrcinputfileData%TFrlPntyn
   DstinputfileData%TFrlPntzn = SrcinputfileData%TFrlPntzn
   DstinputfileData%TFrlSkew = SrcinputfileData%TFrlSkew
   DstinputfileData%TFrlTilt = SrcinputfileData%TFrlTilt
   DstinputfileData%RFrlMass = SrcinputfileData%RFrlMass
   DstinputfileData%BoomMass = SrcinputfileData%BoomMass
   DstinputfileData%TFinMass = SrcinputfileData%TFinMass
   DstinputfileData%RFrlIner = SrcinputfileData%RFrlIner
   DstinputfileData%TFrlIner = SrcinputfileData%TFrlIner
   DstinputfileData%RFrlMod = SrcinputfileData%RFrlMod
   DstinputfileData%RFrlSpr = SrcinputfileData%RFrlSpr
   DstinputfileData%RFrlDmp = SrcinputfileData%RFrlDmp
   DstinputfileData%RFrlCDmp = SrcinputfileData%RFrlCDmp
   DstinputfileData%RFrlUSSP = SrcinputfileData%RFrlUSSP
   DstinputfileData%RFrlDSSP = SrcinputfileData%RFrlDSSP
   DstinputfileData%RFrlUSSpr = SrcinputfileData%RFrlUSSpr
   DstinputfileData%RFrlDSSpr = SrcinputfileData%RFrlDSSpr
   DstinputfileData%RFrlUSDP = SrcinputfileData%RFrlUSDP
   DstinputfileData%RFrlDSDP = SrcinputfileData%RFrlDSDP
   DstinputfileData%RFrlUSDmp = SrcinputfileData%RFrlUSDmp
   DstinputfileData%RFrlDSDmp = SrcinputfileData%RFrlDSDmp
   DstinputfileData%TFrlMod = SrcinputfileData%TFrlMod
   DstinputfileData%TFrlSpr = SrcinputfileData%TFrlSpr
   DstinputfileData%TFrlDmp = SrcinputfileData%TFrlDmp
   DstinputfileData%TFrlCDmp = SrcinputfileData%TFrlCDmp
   DstinputfileData%TFrlUSSP = SrcinputfileData%TFrlUSSP
   DstinputfileData%TFrlDSSP = SrcinputfileData%TFrlDSSP
   DstinputfileData%TFrlUSSpr = SrcinputfileData%TFrlUSSpr
   DstinputfileData%TFrlDSSpr = SrcinputfileData%TFrlDSSpr
   DstinputfileData%TFrlUSDP = SrcinputfileData%TFrlUSDP
   DstinputfileData%TFrlDSDP = SrcinputfileData%TFrlDSDP
   DstinputfileData%TFrlUSDmp = SrcinputfileData%TFrlUSDmp
   DstinputfileData%TFrlDSDmp = SrcinputfileData%TFrlDSDmp
   DstinputfileData%method = SrcinputfileData%method
 END SUBROUTINE ED_Copyinputfile

 SUBROUTINE ED_Destroyinputfile( inputfileData, ErrStat, ErrMsg )
  TYPE(ed_inputfile), INTENT(INOUT) :: inputfileData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(inputfileData%BlPitch) ) DEALLOCATE(inputfileData%BlPitch)
  IF ( ALLOCATED(inputfileData%PreCone) ) DEALLOCATE(inputfileData%PreCone)
  IF ( ALLOCATED(inputfileData%TipMass) ) DEALLOCATE(inputfileData%TipMass)
IF (ALLOCATED(inputfileData%InpBlMesh)) THEN
DO i1 = LBOUND(inputfileData%InpBlMesh,1), UBOUND(inputfileData%InpBlMesh,1)
  CALL ED_Destroyblademeshinputdata( inputfileData%InpBlMesh(i1), ErrStat, ErrMsg )
ENDDO
ENDIF
IF (ALLOCATED(inputfileData%InpBl)) THEN
DO i1 = LBOUND(inputfileData%InpBl,1), UBOUND(inputfileData%InpBl,1)
  CALL ED_Destroybladeinputdata( inputfileData%InpBl(i1), ErrStat, ErrMsg )
ENDDO
ENDIF
  IF ( ALLOCATED(inputfileData%OutList) ) DEALLOCATE(inputfileData%OutList)
  IF ( ALLOCATED(inputfileData%HtFract) ) DEALLOCATE(inputfileData%HtFract)
  IF ( ALLOCATED(inputfileData%TMassDen) ) DEALLOCATE(inputfileData%TMassDen)
  IF ( ALLOCATED(inputfileData%TwFAStif) ) DEALLOCATE(inputfileData%TwFAStif)
  IF ( ALLOCATED(inputfileData%TwSSStif) ) DEALLOCATE(inputfileData%TwSSStif)
  IF ( ALLOCATED(inputfileData%TwFAM1Sh) ) DEALLOCATE(inputfileData%TwFAM1Sh)
  IF ( ALLOCATED(inputfileData%TwFAM2Sh) ) DEALLOCATE(inputfileData%TwFAM2Sh)
  IF ( ALLOCATED(inputfileData%TwSSM1Sh) ) DEALLOCATE(inputfileData%TwSSM1Sh)
  IF ( ALLOCATED(inputfileData%TwSSM2Sh) ) DEALLOCATE(inputfileData%TwSSM2Sh)
  IF ( ALLOCATED(inputfileData%TwGJStif) ) DEALLOCATE(inputfileData%TwGJStif)
  IF ( ALLOCATED(inputfileData%TwEAStif) ) DEALLOCATE(inputfileData%TwEAStif)
  IF ( ALLOCATED(inputfileData%TwFAIner) ) DEALLOCATE(inputfileData%TwFAIner)
  IF ( ALLOCATED(inputfileData%TwSSIner) ) DEALLOCATE(inputfileData%TwSSIner)
  IF ( ALLOCATED(inputfileData%TwFAcgOf) ) DEALLOCATE(inputfileData%TwFAcgOf)
  IF ( ALLOCATED(inputfileData%TwSScgOf) ) DEALLOCATE(inputfileData%TwSScgOf)
 END SUBROUTINE ED_Destroyinputfile

 SUBROUTINE ED_Packinputfile( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ed_inputfile),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_InpBlMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InpBlMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InpBlMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InpBl_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InpBl_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InpBl_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  Re_BufSz   = Re_BufSz   + 1  ! OoPDefl
  Re_BufSz   = Re_BufSz   + 1  ! IPDefl
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz   = Re_BufSz   + 1  ! TeetDefl
  Re_BufSz   = Re_BufSz   + 1  ! Azimuth
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
  Re_BufSz   = Re_BufSz   + 1  ! NacYaw
  Re_BufSz   = Re_BufSz   + 1  ! TTDspFA
  Re_BufSz   = Re_BufSz   + 1  ! TTDspSS
  Re_BufSz   = Re_BufSz   + 1  ! PtfmSurge
  Re_BufSz   = Re_BufSz   + 1  ! PtfmSway
  Re_BufSz   = Re_BufSz   + 1  ! PtfmHeave
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRoll
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPitch
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYaw
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! TipRad
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Re_BufSz    = Re_BufSz    + SIZE( InData%PreCone )  ! PreCone 
  Re_BufSz   = Re_BufSz   + 1  ! HubCM
  Re_BufSz   = Re_BufSz   + 1  ! UndSling
  Re_BufSz   = Re_BufSz   + 1  ! Delta3
  Re_BufSz   = Re_BufSz   + 1  ! AzimB1Up
  Re_BufSz   = Re_BufSz   + 1  ! OverHang
  Re_BufSz   = Re_BufSz   + 1  ! ShftGagL
  Re_BufSz   = Re_BufSz   + 1  ! ShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! NacCMxn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMyn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMzn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUxn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUyn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUzn
  Re_BufSz   = Re_BufSz   + 1  ! Twr2Shft
  Re_BufSz   = Re_BufSz   + 1  ! TowerHt
  Re_BufSz   = Re_BufSz   + 1  ! TowerBsHt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMxt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMyt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMzt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRefzt
  Re_BufSz    = Re_BufSz    + SIZE( InData%TipMass )  ! TipMass 
  Re_BufSz   = Re_BufSz   + 1  ! HubMass
  Re_BufSz   = Re_BufSz   + 1  ! HubIner
  Re_BufSz   = Re_BufSz   + 1  ! GenIner
  Re_BufSz   = Re_BufSz   + 1  ! NacMass
  Re_BufSz   = Re_BufSz   + 1  ! NacYIner
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYIner
DO i1 = LBOUND(InData%InpBlMesh,1), UBOUND(InData%InpBlMesh,1)
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, InData%InpBlMesh(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InpBlMesh_Buf  ) ! InpBlMesh
  IF(ALLOCATED(Db_InpBlMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InpBlMesh_Buf  ) ! InpBlMesh
  IF(ALLOCATED(Int_InpBlMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InpBlMesh_Buf ) ! InpBlMesh
  IF(ALLOCATED(Re_InpBlMesh_Buf))  DEALLOCATE(Re_InpBlMesh_Buf)
  IF(ALLOCATED(Db_InpBlMesh_Buf))  DEALLOCATE(Db_InpBlMesh_Buf)
  IF(ALLOCATED(Int_InpBlMesh_Buf)) DEALLOCATE(Int_InpBlMesh_Buf)
ENDDO
DO i1 = LBOUND(InData%InpBl,1), UBOUND(InData%InpBl,1)
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, InData%InpBl(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InpBl_Buf  ) ! InpBl
  IF(ALLOCATED(Db_InpBl_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InpBl_Buf  ) ! InpBl
  IF(ALLOCATED(Int_InpBl_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InpBl_Buf ) ! InpBl
  IF(ALLOCATED(Re_InpBl_Buf))  DEALLOCATE(Re_InpBl_Buf)
  IF(ALLOCATED(Db_InpBl_Buf))  DEALLOCATE(Db_InpBl_Buf)
  IF(ALLOCATED(Int_InpBl_Buf)) DEALLOCATE(Int_InpBl_Buf)
ENDDO
  Int_BufSz  = Int_BufSz  + 1  ! TeetMod
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmpP
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetSStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetHStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetSSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetHSSp
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEff
  Re_BufSz   = Re_BufSz   + 1  ! GBRatio
  Re_BufSz   = Re_BufSz   + 1  ! DTTorSpr
  Re_BufSz   = Re_BufSz   + 1  ! DTTorDmp
  Int_BufSz  = Int_BufSz  + 1  ! TwrNodes
  Int_BufSz  = Int_BufSz  + 1  ! OutFile
  Db_BufSz   = Db_BufSz   + 1  ! Tstart
  Int_BufSz  = Int_BufSz  + 1  ! DecFact
  Int_BufSz  = Int_BufSz  + 1  ! NTwGages
  Int_BufSz   = Int_BufSz   + SIZE( InData%TwrGagNd )  ! TwrGagNd 
  Int_BufSz  = Int_BufSz  + 1  ! NBlGages
  Int_BufSz   = Int_BufSz   + SIZE( InData%BldGagNd )  ! BldGagNd 
  Int_BufSz  = Int_BufSz  + 1  ! NumOuts
  Int_BufSz  = Int_BufSz  + 1  ! NTwInpSt
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrFADmp )  ! TwrFADmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrSSDmp )  ! TwrSSDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FAStTunr )  ! FAStTunr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SSStTunr )  ! SSStTunr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%HtFract )  ! HtFract 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TMassDen )  ! TMassDen 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAStif )  ! TwFAStif 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSStif )  ! TwSSStif 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAM1Sh )  ! TwFAM1Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAM2Sh )  ! TwFAM2Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSM1Sh )  ! TwSSM1Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSM2Sh )  ! TwSSM2Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwGJStif )  ! TwGJStif 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwEAStif )  ! TwEAStif 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAIner )  ! TwFAIner 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSIner )  ! TwSSIner 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAcgOf )  ! TwFAcgOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwSScgOf )  ! TwSScgOf 
  Re_BufSz   = Re_BufSz   + 1  ! RotFurl
  Re_BufSz   = Re_BufSz   + 1  ! TailFurl
  Re_BufSz   = Re_BufSz   + 1  ! Yaw2Shft
  Re_BufSz   = Re_BufSz   + 1  ! ShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMzn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMxn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMyn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMxn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMyn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPxn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPyn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! TFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! TFinBank
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! RFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! TFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMass
  Re_BufSz   = Re_BufSz   + 1  ! BoomMass
  Re_BufSz   = Re_BufSz   + 1  ! TFinMass
  Re_BufSz   = Re_BufSz   + 1  ! RFrlIner
  Re_BufSz   = Re_BufSz   + 1  ! TFrlIner
  Int_BufSz  = Int_BufSz  + 1  ! RFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDmp
  Int_BufSz  = Int_BufSz  + 1  ! TFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDmp
  Int_BufSz  = Int_BufSz  + 1  ! method
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OoPDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%IPDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Azimuth )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TTDspFA )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TTDspSS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmSurge )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmSway )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmHeave )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRoll )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPitch )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%PreCone) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PreCone))-1 ) =  PACK(InData%PreCone ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PreCone)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubCM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UndSling )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Delta3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AzimB1Up )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OverHang )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftGagL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Twr2Shft )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerBsHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMxt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMyt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRefzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TipMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TipMass))-1 ) =  PACK(InData%TipMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TipMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacYIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYIner )
  Re_Xferred   = Re_Xferred   + 1
DO i1 = LBOUND(InData%InpBlMesh,1), UBOUND(InData%InpBlMesh,1)
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, InData%InpBlMesh(i1), ErrStat, ErrMsg, OnlySize ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBlMesh_Buf)-1 ) = Re_InpBlMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBlMesh_Buf)-1 ) = Db_InpBlMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBlMesh_Buf)-1 ) = Int_InpBlMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InpBlMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_InpBlMesh_Buf) )  DEALLOCATE(Re_InpBlMesh_Buf)
  IF( ALLOCATED(Db_InpBlMesh_Buf) )  DEALLOCATE(Db_InpBlMesh_Buf)
  IF( ALLOCATED(Int_InpBlMesh_Buf) ) DEALLOCATE(Int_InpBlMesh_Buf)
ENDDO
DO i1 = LBOUND(InData%InpBl,1), UBOUND(InData%InpBl,1)
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, InData%InpBl(i1), ErrStat, ErrMsg, OnlySize ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBl_Buf)-1 ) = Re_InpBl_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBl_Buf)-1 ) = Db_InpBl_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBl_Buf)-1 ) = Int_InpBl_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InpBl_Buf)
  ENDIF
  IF( ALLOCATED(Re_InpBl_Buf) )  DEALLOCATE(Re_InpBl_Buf)
  IF( ALLOCATED(Db_InpBl_Buf) )  DEALLOCATE(Db_InpBl_Buf)
  IF( ALLOCATED(Int_InpBl_Buf) ) DEALLOCATE(Int_InpBl_Buf)
ENDDO
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TeetMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmpP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEff )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBRatio )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%OutFile )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Tstart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DecFact )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%TwrGagNd))-1 ) = PACK(InData%TwrGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%TwrGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BldGagNd))-1 ) = PACK(InData%BldGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%BldGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumOuts )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrFADmp))-1 ) =  PACK(InData%TwrFADmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TwrFADmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrSSDmp))-1 ) =  PACK(InData%TwrSSDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TwrSSDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FAStTunr))-1 ) =  PACK(InData%FAStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FAStTunr)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SSStTunr))-1 ) =  PACK(InData%SSStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%SSStTunr)
  IF ( ALLOCATED(InData%HtFract) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HtFract))-1 ) =  PACK(InData%HtFract ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HtFract)
  ENDIF
  IF ( ALLOCATED(InData%TMassDen) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TMassDen))-1 ) =  PACK(InData%TMassDen ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TMassDen)
  ENDIF
  IF ( ALLOCATED(InData%TwFAStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAStif))-1 ) =  PACK(InData%TwFAStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAStif)
  ENDIF
  IF ( ALLOCATED(InData%TwSSStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSStif))-1 ) =  PACK(InData%TwSSStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSStif)
  ENDIF
  IF ( ALLOCATED(InData%TwFAM1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAM1Sh))-1 ) =  PACK(InData%TwFAM1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAM1Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwFAM2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAM2Sh))-1 ) =  PACK(InData%TwFAM2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAM2Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwSSM1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSM1Sh))-1 ) =  PACK(InData%TwSSM1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSM1Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwSSM2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSM2Sh))-1 ) =  PACK(InData%TwSSM2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSM2Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwGJStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwGJStif))-1 ) =  PACK(InData%TwGJStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwGJStif)
  ENDIF
  IF ( ALLOCATED(InData%TwEAStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwEAStif))-1 ) =  PACK(InData%TwEAStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwEAStif)
  ENDIF
  IF ( ALLOCATED(InData%TwFAIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAIner))-1 ) =  PACK(InData%TwFAIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAIner)
  ENDIF
  IF ( ALLOCATED(InData%TwSSIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSIner))-1 ) =  PACK(InData%TwSSIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSIner)
  ENDIF
  IF ( ALLOCATED(InData%TwFAcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAcgOf))-1 ) =  PACK(InData%TwFAcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAcgOf)
  ENDIF
  IF ( ALLOCATED(InData%TwSScgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSScgOf))-1 ) =  PACK(InData%TwSScgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSScgOf)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotFurl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TailFurl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Yaw2Shft )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%method )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE ED_Packinputfile

 SUBROUTINE ED_UnPackinputfile( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ed_inputfile), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_InpBlMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InpBlMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InpBlMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InpBl_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InpBl_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InpBl_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OoPDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%IPDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1))); mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  OutData%TeetDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Azimuth = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TTDspFA = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TTDspSS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmSurge = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmSway = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmHeave = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRoll = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPitch = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TipRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%PreCone) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PreCone,1))); mask1 = .TRUE.
    OutData%PreCone = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PreCone))-1 ),mask1,OutData%PreCone)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PreCone)
  ENDIF
  OutData%HubCM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UndSling = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Delta3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%AzimB1Up = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OverHang = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftGagL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Twr2Shft = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerBsHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMxt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMyt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRefzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TipMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TipMass,1))); mask1 = .TRUE.
    OutData%TipMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TipMass))-1 ),mask1,OutData%TipMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TipMass)
  ENDIF
  OutData%HubMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GenIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
DO i1 = LBOUND(OutData%InpBlMesh,1), UBOUND(OutData%InpBlMesh,1)
 ! first call ED_Packblademeshinputdata to get correctly sized buffers for unpacking
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, OutData%InpBlMesh(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) THEN
    Re_InpBlMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBlMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBlMesh_Buf)) THEN
    Db_InpBlMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBlMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBlMesh_Buf)) THEN
    Int_InpBlMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBlMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InpBlMesh_Buf)
  ENDIF
  CALL ED_UnPackblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, OutData%InpBlMesh(i1), ErrStat, ErrMsg ) ! InpBlMesh 
ENDDO
DO i1 = LBOUND(OutData%InpBl,1), UBOUND(OutData%InpBl,1)
 ! first call ED_Packbladeinputdata to get correctly sized buffers for unpacking
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, OutData%InpBl(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) THEN
    Re_InpBl_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBl_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBl_Buf)) THEN
    Db_InpBl_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBl_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBl_Buf)) THEN
    Int_InpBl_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBl_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InpBl_Buf)
  ENDIF
  CALL ED_UnPackbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, OutData%InpBl(i1), ErrStat, ErrMsg ) ! InpBl 
ENDDO
  OutData%TeetMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TeetDmpP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEff = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBRatio = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%OutFile = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%Tstart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DecFact = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%TwrGagNd,1))); mask1 = .TRUE.
  OutData%TwrGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%TwrGagNd))-1 ),mask1,OutData%TwrGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%TwrGagNd)
  OutData%NBlGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%BldGagNd,1))); mask1 = .TRUE.
  OutData%BldGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%BldGagNd))-1 ),mask1,OutData%BldGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%BldGagNd)
  OutData%NumOuts = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%TwrFADmp,1))); mask1 = .TRUE.
  OutData%TwrFADmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrFADmp))-1 ),mask1,OutData%TwrFADmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrFADmp)
  ALLOCATE(mask1(SIZE(OutData%TwrSSDmp,1))); mask1 = .TRUE.
  OutData%TwrSSDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrSSDmp))-1 ),mask1,OutData%TwrSSDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrSSDmp)
  ALLOCATE(mask1(SIZE(OutData%FAStTunr,1))); mask1 = .TRUE.
  OutData%FAStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FAStTunr))-1 ),mask1,OutData%FAStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FAStTunr)
  ALLOCATE(mask1(SIZE(OutData%SSStTunr,1))); mask1 = .TRUE.
  OutData%SSStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SSStTunr))-1 ),mask1,OutData%SSStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%SSStTunr)
  IF ( ALLOCATED(OutData%HtFract) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HtFract,1))); mask1 = .TRUE.
    OutData%HtFract = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HtFract))-1 ),mask1,OutData%HtFract)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HtFract)
  ENDIF
  IF ( ALLOCATED(OutData%TMassDen) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TMassDen,1))); mask1 = .TRUE.
    OutData%TMassDen = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TMassDen))-1 ),mask1,OutData%TMassDen)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TMassDen)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAStif,1))); mask1 = .TRUE.
    OutData%TwFAStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAStif))-1 ),mask1,OutData%TwFAStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSStif,1))); mask1 = .TRUE.
    OutData%TwSSStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSStif))-1 ),mask1,OutData%TwSSStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAM1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAM1Sh,1))); mask1 = .TRUE.
    OutData%TwFAM1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAM1Sh))-1 ),mask1,OutData%TwFAM1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAM1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAM2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAM2Sh,1))); mask1 = .TRUE.
    OutData%TwFAM2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAM2Sh))-1 ),mask1,OutData%TwFAM2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAM2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSM1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSM1Sh,1))); mask1 = .TRUE.
    OutData%TwSSM1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSM1Sh))-1 ),mask1,OutData%TwSSM1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSM1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSM2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSM2Sh,1))); mask1 = .TRUE.
    OutData%TwSSM2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSM2Sh))-1 ),mask1,OutData%TwSSM2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSM2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwGJStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwGJStif,1))); mask1 = .TRUE.
    OutData%TwGJStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwGJStif))-1 ),mask1,OutData%TwGJStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwGJStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwEAStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwEAStif,1))); mask1 = .TRUE.
    OutData%TwEAStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwEAStif))-1 ),mask1,OutData%TwEAStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwEAStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAIner,1))); mask1 = .TRUE.
    OutData%TwFAIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAIner))-1 ),mask1,OutData%TwFAIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAIner)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSIner,1))); mask1 = .TRUE.
    OutData%TwSSIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSIner))-1 ),mask1,OutData%TwSSIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSIner)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAcgOf,1))); mask1 = .TRUE.
    OutData%TwFAcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAcgOf))-1 ),mask1,OutData%TwFAcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%TwSScgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSScgOf,1))); mask1 = .TRUE.
    OutData%TwSScgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSScgOf))-1 ),mask1,OutData%TwSScgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSScgOf)
  ENDIF
  OutData%RotFurl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TailFurl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Yaw2Shft = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%RFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%method = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackinputfile

 SUBROUTINE ED_Copycoordsys( SrccoordsysData, DstcoordsysData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ed_coordsys), INTENT(INOUT) :: SrccoordsysData
   TYPE(ed_coordsys), INTENT(INOUT) :: DstcoordsysData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstcoordsysData%a1 = SrccoordsysData%a1
   DstcoordsysData%a2 = SrccoordsysData%a2
   DstcoordsysData%a3 = SrccoordsysData%a3
   DstcoordsysData%b1 = SrccoordsysData%b1
   DstcoordsysData%b2 = SrccoordsysData%b2
   DstcoordsysData%b3 = SrccoordsysData%b3
   DstcoordsysData%c1 = SrccoordsysData%c1
   DstcoordsysData%c2 = SrccoordsysData%c2
   DstcoordsysData%c3 = SrccoordsysData%c3
   DstcoordsysData%d1 = SrccoordsysData%d1
   DstcoordsysData%d2 = SrccoordsysData%d2
   DstcoordsysData%d3 = SrccoordsysData%d3
   DstcoordsysData%e1 = SrccoordsysData%e1
   DstcoordsysData%e2 = SrccoordsysData%e2
   DstcoordsysData%e3 = SrccoordsysData%e3
   DstcoordsysData%f1 = SrccoordsysData%f1
   DstcoordsysData%f2 = SrccoordsysData%f2
   DstcoordsysData%f3 = SrccoordsysData%f3
   DstcoordsysData%g1 = SrccoordsysData%g1
   DstcoordsysData%g2 = SrccoordsysData%g2
   DstcoordsysData%g3 = SrccoordsysData%g3
IF (ALLOCATED(SrccoordsysData%i1)) THEN
   i1_l = LBOUND(SrccoordsysData%i1,1)
   i1_u = UBOUND(SrccoordsysData%i1,1)
   i2_l = LBOUND(SrccoordsysData%i1,2)
   i2_u = UBOUND(SrccoordsysData%i1,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%i1)) THEN 
      ALLOCATE(DstcoordsysData%i1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%i1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%i1 = SrccoordsysData%i1
ENDIF
IF (ALLOCATED(SrccoordsysData%i2)) THEN
   i1_l = LBOUND(SrccoordsysData%i2,1)
   i1_u = UBOUND(SrccoordsysData%i2,1)
   i2_l = LBOUND(SrccoordsysData%i2,2)
   i2_u = UBOUND(SrccoordsysData%i2,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%i2)) THEN 
      ALLOCATE(DstcoordsysData%i2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%i2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%i2 = SrccoordsysData%i2
ENDIF
IF (ALLOCATED(SrccoordsysData%i3)) THEN
   i1_l = LBOUND(SrccoordsysData%i3,1)
   i1_u = UBOUND(SrccoordsysData%i3,1)
   i2_l = LBOUND(SrccoordsysData%i3,2)
   i2_u = UBOUND(SrccoordsysData%i3,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%i3)) THEN 
      ALLOCATE(DstcoordsysData%i3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%i3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%i3 = SrccoordsysData%i3
ENDIF
IF (ALLOCATED(SrccoordsysData%j1)) THEN
   i1_l = LBOUND(SrccoordsysData%j1,1)
   i1_u = UBOUND(SrccoordsysData%j1,1)
   i2_l = LBOUND(SrccoordsysData%j1,2)
   i2_u = UBOUND(SrccoordsysData%j1,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%j1)) THEN 
      ALLOCATE(DstcoordsysData%j1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%j1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%j1 = SrccoordsysData%j1
ENDIF
IF (ALLOCATED(SrccoordsysData%j2)) THEN
   i1_l = LBOUND(SrccoordsysData%j2,1)
   i1_u = UBOUND(SrccoordsysData%j2,1)
   i2_l = LBOUND(SrccoordsysData%j2,2)
   i2_u = UBOUND(SrccoordsysData%j2,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%j2)) THEN 
      ALLOCATE(DstcoordsysData%j2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%j2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%j2 = SrccoordsysData%j2
ENDIF
IF (ALLOCATED(SrccoordsysData%j3)) THEN
   i1_l = LBOUND(SrccoordsysData%j3,1)
   i1_u = UBOUND(SrccoordsysData%j3,1)
   i2_l = LBOUND(SrccoordsysData%j3,2)
   i2_u = UBOUND(SrccoordsysData%j3,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%j3)) THEN 
      ALLOCATE(DstcoordsysData%j3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%j3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%j3 = SrccoordsysData%j3
ENDIF
IF (ALLOCATED(SrccoordsysData%m1)) THEN
   i1_l = LBOUND(SrccoordsysData%m1,1)
   i1_u = UBOUND(SrccoordsysData%m1,1)
   i2_l = LBOUND(SrccoordsysData%m1,2)
   i2_u = UBOUND(SrccoordsysData%m1,2)
   i3_l = LBOUND(SrccoordsysData%m1,3)
   i3_u = UBOUND(SrccoordsysData%m1,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%m1)) THEN 
      ALLOCATE(DstcoordsysData%m1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%m1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%m1 = SrccoordsysData%m1
ENDIF
IF (ALLOCATED(SrccoordsysData%m2)) THEN
   i1_l = LBOUND(SrccoordsysData%m2,1)
   i1_u = UBOUND(SrccoordsysData%m2,1)
   i2_l = LBOUND(SrccoordsysData%m2,2)
   i2_u = UBOUND(SrccoordsysData%m2,2)
   i3_l = LBOUND(SrccoordsysData%m2,3)
   i3_u = UBOUND(SrccoordsysData%m2,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%m2)) THEN 
      ALLOCATE(DstcoordsysData%m2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%m2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%m2 = SrccoordsysData%m2
ENDIF
IF (ALLOCATED(SrccoordsysData%m3)) THEN
   i1_l = LBOUND(SrccoordsysData%m3,1)
   i1_u = UBOUND(SrccoordsysData%m3,1)
   i2_l = LBOUND(SrccoordsysData%m3,2)
   i2_u = UBOUND(SrccoordsysData%m3,2)
   i3_l = LBOUND(SrccoordsysData%m3,3)
   i3_u = UBOUND(SrccoordsysData%m3,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%m3)) THEN 
      ALLOCATE(DstcoordsysData%m3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%m3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%m3 = SrccoordsysData%m3
ENDIF
IF (ALLOCATED(SrccoordsysData%n1)) THEN
   i1_l = LBOUND(SrccoordsysData%n1,1)
   i1_u = UBOUND(SrccoordsysData%n1,1)
   i2_l = LBOUND(SrccoordsysData%n1,2)
   i2_u = UBOUND(SrccoordsysData%n1,2)
   i3_l = LBOUND(SrccoordsysData%n1,3)
   i3_u = UBOUND(SrccoordsysData%n1,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%n1)) THEN 
      ALLOCATE(DstcoordsysData%n1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%n1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%n1 = SrccoordsysData%n1
ENDIF
IF (ALLOCATED(SrccoordsysData%n2)) THEN
   i1_l = LBOUND(SrccoordsysData%n2,1)
   i1_u = UBOUND(SrccoordsysData%n2,1)
   i2_l = LBOUND(SrccoordsysData%n2,2)
   i2_u = UBOUND(SrccoordsysData%n2,2)
   i3_l = LBOUND(SrccoordsysData%n2,3)
   i3_u = UBOUND(SrccoordsysData%n2,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%n2)) THEN 
      ALLOCATE(DstcoordsysData%n2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%n2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%n2 = SrccoordsysData%n2
ENDIF
IF (ALLOCATED(SrccoordsysData%n3)) THEN
   i1_l = LBOUND(SrccoordsysData%n3,1)
   i1_u = UBOUND(SrccoordsysData%n3,1)
   i2_l = LBOUND(SrccoordsysData%n3,2)
   i2_u = UBOUND(SrccoordsysData%n3,2)
   i3_l = LBOUND(SrccoordsysData%n3,3)
   i3_u = UBOUND(SrccoordsysData%n3,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%n3)) THEN 
      ALLOCATE(DstcoordsysData%n3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%n3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%n3 = SrccoordsysData%n3
ENDIF
   DstcoordsysData%p1 = SrccoordsysData%p1
   DstcoordsysData%p2 = SrccoordsysData%p2
   DstcoordsysData%p3 = SrccoordsysData%p3
   DstcoordsysData%rf1 = SrccoordsysData%rf1
   DstcoordsysData%rf2 = SrccoordsysData%rf2
   DstcoordsysData%rf3 = SrccoordsysData%rf3
   DstcoordsysData%rfa = SrccoordsysData%rfa
IF (ALLOCATED(SrccoordsysData%t1)) THEN
   i1_l = LBOUND(SrccoordsysData%t1,1)
   i1_u = UBOUND(SrccoordsysData%t1,1)
   i2_l = LBOUND(SrccoordsysData%t1,2)
   i2_u = UBOUND(SrccoordsysData%t1,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%t1)) THEN 
      ALLOCATE(DstcoordsysData%t1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%t1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%t1 = SrccoordsysData%t1
ENDIF
IF (ALLOCATED(SrccoordsysData%t2)) THEN
   i1_l = LBOUND(SrccoordsysData%t2,1)
   i1_u = UBOUND(SrccoordsysData%t2,1)
   i2_l = LBOUND(SrccoordsysData%t2,2)
   i2_u = UBOUND(SrccoordsysData%t2,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%t2)) THEN 
      ALLOCATE(DstcoordsysData%t2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%t2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%t2 = SrccoordsysData%t2
ENDIF
IF (ALLOCATED(SrccoordsysData%t3)) THEN
   i1_l = LBOUND(SrccoordsysData%t3,1)
   i1_u = UBOUND(SrccoordsysData%t3,1)
   i2_l = LBOUND(SrccoordsysData%t3,2)
   i2_u = UBOUND(SrccoordsysData%t3,2)
   IF (.NOT.ALLOCATED(DstcoordsysData%t3)) THEN 
      ALLOCATE(DstcoordsysData%t3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%t3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%t3 = SrccoordsysData%t3
ENDIF
IF (ALLOCATED(SrccoordsysData%te1)) THEN
   i1_l = LBOUND(SrccoordsysData%te1,1)
   i1_u = UBOUND(SrccoordsysData%te1,1)
   i2_l = LBOUND(SrccoordsysData%te1,2)
   i2_u = UBOUND(SrccoordsysData%te1,2)
   i3_l = LBOUND(SrccoordsysData%te1,3)
   i3_u = UBOUND(SrccoordsysData%te1,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%te1)) THEN 
      ALLOCATE(DstcoordsysData%te1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%te1.'
         RETURN
      END IF
   END IF
   DstcoordsysData%te1 = SrccoordsysData%te1
ENDIF
IF (ALLOCATED(SrccoordsysData%te2)) THEN
   i1_l = LBOUND(SrccoordsysData%te2,1)
   i1_u = UBOUND(SrccoordsysData%te2,1)
   i2_l = LBOUND(SrccoordsysData%te2,2)
   i2_u = UBOUND(SrccoordsysData%te2,2)
   i3_l = LBOUND(SrccoordsysData%te2,3)
   i3_u = UBOUND(SrccoordsysData%te2,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%te2)) THEN 
      ALLOCATE(DstcoordsysData%te2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%te2.'
         RETURN
      END IF
   END IF
   DstcoordsysData%te2 = SrccoordsysData%te2
ENDIF
IF (ALLOCATED(SrccoordsysData%te3)) THEN
   i1_l = LBOUND(SrccoordsysData%te3,1)
   i1_u = UBOUND(SrccoordsysData%te3,1)
   i2_l = LBOUND(SrccoordsysData%te3,2)
   i2_u = UBOUND(SrccoordsysData%te3,2)
   i3_l = LBOUND(SrccoordsysData%te3,3)
   i3_u = UBOUND(SrccoordsysData%te3,3)
   IF (.NOT.ALLOCATED(DstcoordsysData%te3)) THEN 
      ALLOCATE(DstcoordsysData%te3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copycoordsys: Error allocating DstcoordsysData%te3.'
         RETURN
      END IF
   END IF
   DstcoordsysData%te3 = SrccoordsysData%te3
ENDIF
   DstcoordsysData%tf1 = SrccoordsysData%tf1
   DstcoordsysData%tf2 = SrccoordsysData%tf2
   DstcoordsysData%tf3 = SrccoordsysData%tf3
   DstcoordsysData%tfa = SrccoordsysData%tfa
   DstcoordsysData%z1 = SrccoordsysData%z1
   DstcoordsysData%z2 = SrccoordsysData%z2
   DstcoordsysData%z3 = SrccoordsysData%z3
 END SUBROUTINE ED_Copycoordsys

 SUBROUTINE ED_Destroycoordsys( coordsysData, ErrStat, ErrMsg )
  TYPE(ed_coordsys), INTENT(INOUT) :: coordsysData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(coordsysData%i1) ) DEALLOCATE(coordsysData%i1)
  IF ( ALLOCATED(coordsysData%i2) ) DEALLOCATE(coordsysData%i2)
  IF ( ALLOCATED(coordsysData%i3) ) DEALLOCATE(coordsysData%i3)
  IF ( ALLOCATED(coordsysData%j1) ) DEALLOCATE(coordsysData%j1)
  IF ( ALLOCATED(coordsysData%j2) ) DEALLOCATE(coordsysData%j2)
  IF ( ALLOCATED(coordsysData%j3) ) DEALLOCATE(coordsysData%j3)
  IF ( ALLOCATED(coordsysData%m1) ) DEALLOCATE(coordsysData%m1)
  IF ( ALLOCATED(coordsysData%m2) ) DEALLOCATE(coordsysData%m2)
  IF ( ALLOCATED(coordsysData%m3) ) DEALLOCATE(coordsysData%m3)
  IF ( ALLOCATED(coordsysData%n1) ) DEALLOCATE(coordsysData%n1)
  IF ( ALLOCATED(coordsysData%n2) ) DEALLOCATE(coordsysData%n2)
  IF ( ALLOCATED(coordsysData%n3) ) DEALLOCATE(coordsysData%n3)
  IF ( ALLOCATED(coordsysData%t1) ) DEALLOCATE(coordsysData%t1)
  IF ( ALLOCATED(coordsysData%t2) ) DEALLOCATE(coordsysData%t2)
  IF ( ALLOCATED(coordsysData%t3) ) DEALLOCATE(coordsysData%t3)
  IF ( ALLOCATED(coordsysData%te1) ) DEALLOCATE(coordsysData%te1)
  IF ( ALLOCATED(coordsysData%te2) ) DEALLOCATE(coordsysData%te2)
  IF ( ALLOCATED(coordsysData%te3) ) DEALLOCATE(coordsysData%te3)
 END SUBROUTINE ED_Destroycoordsys

 SUBROUTINE ED_Packcoordsys( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ed_coordsys),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%a1 )  ! a1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%a2 )  ! a2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%a3 )  ! a3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b1 )  ! b1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b2 )  ! b2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b3 )  ! b3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c1 )  ! c1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c2 )  ! c2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c3 )  ! c3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d1 )  ! d1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d2 )  ! d2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d3 )  ! d3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e1 )  ! e1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e2 )  ! e2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e3 )  ! e3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f1 )  ! f1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f2 )  ! f2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f3 )  ! f3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g1 )  ! g1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g2 )  ! g2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g3 )  ! g3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%i1 )  ! i1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%i2 )  ! i2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%i3 )  ! i3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%j1 )  ! j1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%j2 )  ! j2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%j3 )  ! j3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%m1 )  ! m1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%m2 )  ! m2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%m3 )  ! m3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%n1 )  ! n1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%n2 )  ! n2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%n3 )  ! n3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p1 )  ! p1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p2 )  ! p2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p3 )  ! p3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf1 )  ! rf1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf2 )  ! rf2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf3 )  ! rf3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rfa )  ! rfa 
  Re_BufSz    = Re_BufSz    + SIZE( InData%t1 )  ! t1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%t2 )  ! t2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%t3 )  ! t3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%te1 )  ! te1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%te2 )  ! te2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%te3 )  ! te3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf1 )  ! tf1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf2 )  ! tf2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf3 )  ! tf3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tfa )  ! tfa 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z1 )  ! z1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z2 )  ! z2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z3 )  ! z3 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a1))-1 ) =  PACK(InData%a1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a2))-1 ) =  PACK(InData%a2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a3))-1 ) =  PACK(InData%a3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b1))-1 ) =  PACK(InData%b1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b2))-1 ) =  PACK(InData%b2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b3))-1 ) =  PACK(InData%b3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c1))-1 ) =  PACK(InData%c1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c2))-1 ) =  PACK(InData%c2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c3))-1 ) =  PACK(InData%c3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d1))-1 ) =  PACK(InData%d1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d2))-1 ) =  PACK(InData%d2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d3))-1 ) =  PACK(InData%d3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e1))-1 ) =  PACK(InData%e1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e2))-1 ) =  PACK(InData%e2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e3))-1 ) =  PACK(InData%e3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f1))-1 ) =  PACK(InData%f1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f2))-1 ) =  PACK(InData%f2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f3))-1 ) =  PACK(InData%f3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g1))-1 ) =  PACK(InData%g1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g2))-1 ) =  PACK(InData%g2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g3))-1 ) =  PACK(InData%g3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g3)
  IF ( ALLOCATED(InData%i1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i1))-1 ) =  PACK(InData%i1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i1)
  ENDIF
  IF ( ALLOCATED(InData%i2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i2))-1 ) =  PACK(InData%i2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i2)
  ENDIF
  IF ( ALLOCATED(InData%i3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i3))-1 ) =  PACK(InData%i3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i3)
  ENDIF
  IF ( ALLOCATED(InData%j1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j1))-1 ) =  PACK(InData%j1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j1)
  ENDIF
  IF ( ALLOCATED(InData%j2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j2))-1 ) =  PACK(InData%j2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j2)
  ENDIF
  IF ( ALLOCATED(InData%j3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j3))-1 ) =  PACK(InData%j3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j3)
  ENDIF
  IF ( ALLOCATED(InData%m1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m1))-1 ) =  PACK(InData%m1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m1)
  ENDIF
  IF ( ALLOCATED(InData%m2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m2))-1 ) =  PACK(InData%m2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m2)
  ENDIF
  IF ( ALLOCATED(InData%m3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m3))-1 ) =  PACK(InData%m3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m3)
  ENDIF
  IF ( ALLOCATED(InData%n1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n1))-1 ) =  PACK(InData%n1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n1)
  ENDIF
  IF ( ALLOCATED(InData%n2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n2))-1 ) =  PACK(InData%n2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n2)
  ENDIF
  IF ( ALLOCATED(InData%n3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n3))-1 ) =  PACK(InData%n3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n3)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p1))-1 ) =  PACK(InData%p1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p2))-1 ) =  PACK(InData%p2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p3))-1 ) =  PACK(InData%p3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf1))-1 ) =  PACK(InData%rf1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf2))-1 ) =  PACK(InData%rf2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf3))-1 ) =  PACK(InData%rf3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rfa))-1 ) =  PACK(InData%rfa ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rfa)
  IF ( ALLOCATED(InData%t1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t1))-1 ) =  PACK(InData%t1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t1)
  ENDIF
  IF ( ALLOCATED(InData%t2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t2))-1 ) =  PACK(InData%t2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t2)
  ENDIF
  IF ( ALLOCATED(InData%t3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t3))-1 ) =  PACK(InData%t3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t3)
  ENDIF
  IF ( ALLOCATED(InData%te1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te1))-1 ) =  PACK(InData%te1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te1)
  ENDIF
  IF ( ALLOCATED(InData%te2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te2))-1 ) =  PACK(InData%te2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te2)
  ENDIF
  IF ( ALLOCATED(InData%te3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te3))-1 ) =  PACK(InData%te3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te3)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf1))-1 ) =  PACK(InData%tf1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf2))-1 ) =  PACK(InData%tf2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf3))-1 ) =  PACK(InData%tf3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tfa))-1 ) =  PACK(InData%tfa ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tfa)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z1))-1 ) =  PACK(InData%z1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z2))-1 ) =  PACK(InData%z2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z3))-1 ) =  PACK(InData%z3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z3)
 END SUBROUTINE ED_Packcoordsys

 SUBROUTINE ED_UnPackcoordsys( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ed_coordsys), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%a1,1))); mask1 = .TRUE.
  OutData%a1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a1))-1 ),mask1,OutData%a1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a1)
  ALLOCATE(mask1(SIZE(OutData%a2,1))); mask1 = .TRUE.
  OutData%a2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a2))-1 ),mask1,OutData%a2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a2)
  ALLOCATE(mask1(SIZE(OutData%a3,1))); mask1 = .TRUE.
  OutData%a3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a3))-1 ),mask1,OutData%a3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a3)
  ALLOCATE(mask1(SIZE(OutData%b1,1))); mask1 = .TRUE.
  OutData%b1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b1))-1 ),mask1,OutData%b1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b1)
  ALLOCATE(mask1(SIZE(OutData%b2,1))); mask1 = .TRUE.
  OutData%b2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b2))-1 ),mask1,OutData%b2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b2)
  ALLOCATE(mask1(SIZE(OutData%b3,1))); mask1 = .TRUE.
  OutData%b3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b3))-1 ),mask1,OutData%b3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b3)
  ALLOCATE(mask1(SIZE(OutData%c1,1))); mask1 = .TRUE.
  OutData%c1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c1))-1 ),mask1,OutData%c1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c1)
  ALLOCATE(mask1(SIZE(OutData%c2,1))); mask1 = .TRUE.
  OutData%c2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c2))-1 ),mask1,OutData%c2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c2)
  ALLOCATE(mask1(SIZE(OutData%c3,1))); mask1 = .TRUE.
  OutData%c3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c3))-1 ),mask1,OutData%c3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c3)
  ALLOCATE(mask1(SIZE(OutData%d1,1))); mask1 = .TRUE.
  OutData%d1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d1))-1 ),mask1,OutData%d1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d1)
  ALLOCATE(mask1(SIZE(OutData%d2,1))); mask1 = .TRUE.
  OutData%d2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d2))-1 ),mask1,OutData%d2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d2)
  ALLOCATE(mask1(SIZE(OutData%d3,1))); mask1 = .TRUE.
  OutData%d3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d3))-1 ),mask1,OutData%d3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d3)
  ALLOCATE(mask1(SIZE(OutData%e1,1))); mask1 = .TRUE.
  OutData%e1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e1))-1 ),mask1,OutData%e1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e1)
  ALLOCATE(mask1(SIZE(OutData%e2,1))); mask1 = .TRUE.
  OutData%e2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e2))-1 ),mask1,OutData%e2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e2)
  ALLOCATE(mask1(SIZE(OutData%e3,1))); mask1 = .TRUE.
  OutData%e3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e3))-1 ),mask1,OutData%e3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e3)
  ALLOCATE(mask1(SIZE(OutData%f1,1))); mask1 = .TRUE.
  OutData%f1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f1))-1 ),mask1,OutData%f1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f1)
  ALLOCATE(mask1(SIZE(OutData%f2,1))); mask1 = .TRUE.
  OutData%f2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f2))-1 ),mask1,OutData%f2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f2)
  ALLOCATE(mask1(SIZE(OutData%f3,1))); mask1 = .TRUE.
  OutData%f3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f3))-1 ),mask1,OutData%f3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f3)
  ALLOCATE(mask1(SIZE(OutData%g1,1))); mask1 = .TRUE.
  OutData%g1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g1))-1 ),mask1,OutData%g1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g1)
  ALLOCATE(mask1(SIZE(OutData%g2,1))); mask1 = .TRUE.
  OutData%g2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g2))-1 ),mask1,OutData%g2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g2)
  ALLOCATE(mask1(SIZE(OutData%g3,1))); mask1 = .TRUE.
  OutData%g3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g3))-1 ),mask1,OutData%g3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g3)
  IF ( ALLOCATED(OutData%i1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i1,1),SIZE(OutData%i1,2))); mask2 = .TRUE.
    OutData%i1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i1))-1 ),mask2,OutData%i1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i1)
  ENDIF
  IF ( ALLOCATED(OutData%i2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i2,1),SIZE(OutData%i2,2))); mask2 = .TRUE.
    OutData%i2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i2))-1 ),mask2,OutData%i2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i2)
  ENDIF
  IF ( ALLOCATED(OutData%i3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i3,1),SIZE(OutData%i3,2))); mask2 = .TRUE.
    OutData%i3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i3))-1 ),mask2,OutData%i3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i3)
  ENDIF
  IF ( ALLOCATED(OutData%j1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j1,1),SIZE(OutData%j1,2))); mask2 = .TRUE.
    OutData%j1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j1))-1 ),mask2,OutData%j1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j1)
  ENDIF
  IF ( ALLOCATED(OutData%j2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j2,1),SIZE(OutData%j2,2))); mask2 = .TRUE.
    OutData%j2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j2))-1 ),mask2,OutData%j2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j2)
  ENDIF
  IF ( ALLOCATED(OutData%j3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j3,1),SIZE(OutData%j3,2))); mask2 = .TRUE.
    OutData%j3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j3))-1 ),mask2,OutData%j3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j3)
  ENDIF
  IF ( ALLOCATED(OutData%m1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m1,1),SIZE(OutData%m1,2),SIZE(OutData%m1,3))); mask3 = .TRUE.
    OutData%m1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m1))-1 ),mask3,OutData%m1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m1)
  ENDIF
  IF ( ALLOCATED(OutData%m2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m2,1),SIZE(OutData%m2,2),SIZE(OutData%m2,3))); mask3 = .TRUE.
    OutData%m2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m2))-1 ),mask3,OutData%m2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m2)
  ENDIF
  IF ( ALLOCATED(OutData%m3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m3,1),SIZE(OutData%m3,2),SIZE(OutData%m3,3))); mask3 = .TRUE.
    OutData%m3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m3))-1 ),mask3,OutData%m3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m3)
  ENDIF
  IF ( ALLOCATED(OutData%n1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n1,1),SIZE(OutData%n1,2),SIZE(OutData%n1,3))); mask3 = .TRUE.
    OutData%n1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n1))-1 ),mask3,OutData%n1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n1)
  ENDIF
  IF ( ALLOCATED(OutData%n2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n2,1),SIZE(OutData%n2,2),SIZE(OutData%n2,3))); mask3 = .TRUE.
    OutData%n2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n2))-1 ),mask3,OutData%n2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n2)
  ENDIF
  IF ( ALLOCATED(OutData%n3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n3,1),SIZE(OutData%n3,2),SIZE(OutData%n3,3))); mask3 = .TRUE.
    OutData%n3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n3))-1 ),mask3,OutData%n3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n3)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%p1,1))); mask1 = .TRUE.
  OutData%p1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p1))-1 ),mask1,OutData%p1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p1)
  ALLOCATE(mask1(SIZE(OutData%p2,1))); mask1 = .TRUE.
  OutData%p2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p2))-1 ),mask1,OutData%p2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p2)
  ALLOCATE(mask1(SIZE(OutData%p3,1))); mask1 = .TRUE.
  OutData%p3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p3))-1 ),mask1,OutData%p3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p3)
  ALLOCATE(mask1(SIZE(OutData%rf1,1))); mask1 = .TRUE.
  OutData%rf1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf1))-1 ),mask1,OutData%rf1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf1)
  ALLOCATE(mask1(SIZE(OutData%rf2,1))); mask1 = .TRUE.
  OutData%rf2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf2))-1 ),mask1,OutData%rf2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf2)
  ALLOCATE(mask1(SIZE(OutData%rf3,1))); mask1 = .TRUE.
  OutData%rf3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf3))-1 ),mask1,OutData%rf3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf3)
  ALLOCATE(mask1(SIZE(OutData%rfa,1))); mask1 = .TRUE.
  OutData%rfa = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rfa))-1 ),mask1,OutData%rfa)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rfa)
  IF ( ALLOCATED(OutData%t1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t1,1),SIZE(OutData%t1,2))); mask2 = .TRUE.
    OutData%t1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t1))-1 ),mask2,OutData%t1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t1)
  ENDIF
  IF ( ALLOCATED(OutData%t2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t2,1),SIZE(OutData%t2,2))); mask2 = .TRUE.
    OutData%t2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t2))-1 ),mask2,OutData%t2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t2)
  ENDIF
  IF ( ALLOCATED(OutData%t3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t3,1),SIZE(OutData%t3,2))); mask2 = .TRUE.
    OutData%t3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t3))-1 ),mask2,OutData%t3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t3)
  ENDIF
  IF ( ALLOCATED(OutData%te1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te1,1),SIZE(OutData%te1,2),SIZE(OutData%te1,3))); mask3 = .TRUE.
    OutData%te1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te1))-1 ),mask3,OutData%te1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te1)
  ENDIF
  IF ( ALLOCATED(OutData%te2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te2,1),SIZE(OutData%te2,2),SIZE(OutData%te2,3))); mask3 = .TRUE.
    OutData%te2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te2))-1 ),mask3,OutData%te2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te2)
  ENDIF
  IF ( ALLOCATED(OutData%te3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te3,1),SIZE(OutData%te3,2),SIZE(OutData%te3,3))); mask3 = .TRUE.
    OutData%te3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te3))-1 ),mask3,OutData%te3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te3)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%tf1,1))); mask1 = .TRUE.
  OutData%tf1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf1))-1 ),mask1,OutData%tf1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf1)
  ALLOCATE(mask1(SIZE(OutData%tf2,1))); mask1 = .TRUE.
  OutData%tf2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf2))-1 ),mask1,OutData%tf2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf2)
  ALLOCATE(mask1(SIZE(OutData%tf3,1))); mask1 = .TRUE.
  OutData%tf3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf3))-1 ),mask1,OutData%tf3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf3)
  ALLOCATE(mask1(SIZE(OutData%tfa,1))); mask1 = .TRUE.
  OutData%tfa = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tfa))-1 ),mask1,OutData%tfa)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tfa)
  ALLOCATE(mask1(SIZE(OutData%z1,1))); mask1 = .TRUE.
  OutData%z1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z1))-1 ),mask1,OutData%z1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z1)
  ALLOCATE(mask1(SIZE(OutData%z2,1))); mask1 = .TRUE.
  OutData%z2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z2))-1 ),mask1,OutData%z2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z2)
  ALLOCATE(mask1(SIZE(OutData%z3,1))); mask1 = .TRUE.
  OutData%z3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z3))-1 ),mask1,OutData%z3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z3)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackcoordsys

 SUBROUTINE ED_Copyactivedofs( SrcactivedofsData, DstactivedofsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ed_activedofs), INTENT(INOUT) :: SrcactivedofsData
   TYPE(ed_activedofs), INTENT(INOUT) :: DstactivedofsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstactivedofsData%NActvDOF = SrcactivedofsData%NActvDOF
   DstactivedofsData%NPCE = SrcactivedofsData%NPCE
   DstactivedofsData%NPDE = SrcactivedofsData%NPDE
   DstactivedofsData%NPIE = SrcactivedofsData%NPIE
   DstactivedofsData%NPTE = SrcactivedofsData%NPTE
   DstactivedofsData%NPTTE = SrcactivedofsData%NPTTE
IF (ALLOCATED(SrcactivedofsData%NPSBE)) THEN
   i1_l = LBOUND(SrcactivedofsData%NPSBE,1)
   i1_u = UBOUND(SrcactivedofsData%NPSBE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%NPSBE)) THEN 
      ALLOCATE(DstactivedofsData%NPSBE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%NPSBE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%NPSBE = SrcactivedofsData%NPSBE
ENDIF
IF (ALLOCATED(SrcactivedofsData%NPSE)) THEN
   i1_l = LBOUND(SrcactivedofsData%NPSE,1)
   i1_u = UBOUND(SrcactivedofsData%NPSE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%NPSE)) THEN 
      ALLOCATE(DstactivedofsData%NPSE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%NPSE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%NPSE = SrcactivedofsData%NPSE
ENDIF
   DstactivedofsData%NPUE = SrcactivedofsData%NPUE
   DstactivedofsData%NPYE = SrcactivedofsData%NPYE
IF (ALLOCATED(SrcactivedofsData%PCE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PCE,1)
   i1_u = UBOUND(SrcactivedofsData%PCE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PCE)) THEN 
      ALLOCATE(DstactivedofsData%PCE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PCE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PCE = SrcactivedofsData%PCE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PDE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PDE,1)
   i1_u = UBOUND(SrcactivedofsData%PDE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PDE)) THEN 
      ALLOCATE(DstactivedofsData%PDE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PDE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PDE = SrcactivedofsData%PDE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PIE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PIE,1)
   i1_u = UBOUND(SrcactivedofsData%PIE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PIE)) THEN 
      ALLOCATE(DstactivedofsData%PIE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PIE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PIE = SrcactivedofsData%PIE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PTE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PTE,1)
   i1_u = UBOUND(SrcactivedofsData%PTE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PTE)) THEN 
      ALLOCATE(DstactivedofsData%PTE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PTE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PTE = SrcactivedofsData%PTE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PTTE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PTTE,1)
   i1_u = UBOUND(SrcactivedofsData%PTTE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PTTE)) THEN 
      ALLOCATE(DstactivedofsData%PTTE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PTTE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PTTE = SrcactivedofsData%PTTE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PS)) THEN
   i1_l = LBOUND(SrcactivedofsData%PS,1)
   i1_u = UBOUND(SrcactivedofsData%PS,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PS)) THEN 
      ALLOCATE(DstactivedofsData%PS(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PS.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PS = SrcactivedofsData%PS
ENDIF
IF (ALLOCATED(SrcactivedofsData%PSBE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PSBE,1)
   i1_u = UBOUND(SrcactivedofsData%PSBE,1)
   i2_l = LBOUND(SrcactivedofsData%PSBE,2)
   i2_u = UBOUND(SrcactivedofsData%PSBE,2)
   IF (.NOT.ALLOCATED(DstactivedofsData%PSBE)) THEN 
      ALLOCATE(DstactivedofsData%PSBE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PSBE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PSBE = SrcactivedofsData%PSBE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PSE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PSE,1)
   i1_u = UBOUND(SrcactivedofsData%PSE,1)
   i2_l = LBOUND(SrcactivedofsData%PSE,2)
   i2_u = UBOUND(SrcactivedofsData%PSE,2)
   IF (.NOT.ALLOCATED(DstactivedofsData%PSE)) THEN 
      ALLOCATE(DstactivedofsData%PSE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PSE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PSE = SrcactivedofsData%PSE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PUE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PUE,1)
   i1_u = UBOUND(SrcactivedofsData%PUE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PUE)) THEN 
      ALLOCATE(DstactivedofsData%PUE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PUE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PUE = SrcactivedofsData%PUE
ENDIF
IF (ALLOCATED(SrcactivedofsData%PYE)) THEN
   i1_l = LBOUND(SrcactivedofsData%PYE,1)
   i1_u = UBOUND(SrcactivedofsData%PYE,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%PYE)) THEN 
      ALLOCATE(DstactivedofsData%PYE(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%PYE.'
         RETURN
      END IF
   END IF
   DstactivedofsData%PYE = SrcactivedofsData%PYE
ENDIF
IF (ALLOCATED(SrcactivedofsData%SrtPS)) THEN
   i1_l = LBOUND(SrcactivedofsData%SrtPS,1)
   i1_u = UBOUND(SrcactivedofsData%SrtPS,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%SrtPS)) THEN 
      ALLOCATE(DstactivedofsData%SrtPS(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%SrtPS.'
         RETURN
      END IF
   END IF
   DstactivedofsData%SrtPS = SrcactivedofsData%SrtPS
ENDIF
IF (ALLOCATED(SrcactivedofsData%SrtPSNAUG)) THEN
   i1_l = LBOUND(SrcactivedofsData%SrtPSNAUG,1)
   i1_u = UBOUND(SrcactivedofsData%SrtPSNAUG,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%SrtPSNAUG)) THEN 
      ALLOCATE(DstactivedofsData%SrtPSNAUG(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%SrtPSNAUG.'
         RETURN
      END IF
   END IF
   DstactivedofsData%SrtPSNAUG = SrcactivedofsData%SrtPSNAUG
ENDIF
IF (ALLOCATED(SrcactivedofsData%Diag)) THEN
   i1_l = LBOUND(SrcactivedofsData%Diag,1)
   i1_u = UBOUND(SrcactivedofsData%Diag,1)
   IF (.NOT.ALLOCATED(DstactivedofsData%Diag)) THEN 
      ALLOCATE(DstactivedofsData%Diag(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyactivedofs: Error allocating DstactivedofsData%Diag.'
         RETURN
      END IF
   END IF
   DstactivedofsData%Diag = SrcactivedofsData%Diag
ENDIF
 END SUBROUTINE ED_Copyactivedofs

 SUBROUTINE ED_Destroyactivedofs( activedofsData, ErrStat, ErrMsg )
  TYPE(ed_activedofs), INTENT(INOUT) :: activedofsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(activedofsData%NPSBE) ) DEALLOCATE(activedofsData%NPSBE)
  IF ( ALLOCATED(activedofsData%NPSE) ) DEALLOCATE(activedofsData%NPSE)
  IF ( ALLOCATED(activedofsData%PCE) ) DEALLOCATE(activedofsData%PCE)
  IF ( ALLOCATED(activedofsData%PDE) ) DEALLOCATE(activedofsData%PDE)
  IF ( ALLOCATED(activedofsData%PIE) ) DEALLOCATE(activedofsData%PIE)
  IF ( ALLOCATED(activedofsData%PTE) ) DEALLOCATE(activedofsData%PTE)
  IF ( ALLOCATED(activedofsData%PTTE) ) DEALLOCATE(activedofsData%PTTE)
  IF ( ALLOCATED(activedofsData%PS) ) DEALLOCATE(activedofsData%PS)
  IF ( ALLOCATED(activedofsData%PSBE) ) DEALLOCATE(activedofsData%PSBE)
  IF ( ALLOCATED(activedofsData%PSE) ) DEALLOCATE(activedofsData%PSE)
  IF ( ALLOCATED(activedofsData%PUE) ) DEALLOCATE(activedofsData%PUE)
  IF ( ALLOCATED(activedofsData%PYE) ) DEALLOCATE(activedofsData%PYE)
  IF ( ALLOCATED(activedofsData%SrtPS) ) DEALLOCATE(activedofsData%SrtPS)
  IF ( ALLOCATED(activedofsData%SrtPSNAUG) ) DEALLOCATE(activedofsData%SrtPSNAUG)
  IF ( ALLOCATED(activedofsData%Diag) ) DEALLOCATE(activedofsData%Diag)
 END SUBROUTINE ED_Destroyactivedofs

 SUBROUTINE ED_Packactivedofs( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ed_activedofs),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NActvDOF
  Int_BufSz  = Int_BufSz  + 1  ! NPCE
  Int_BufSz  = Int_BufSz  + 1  ! NPDE
  Int_BufSz  = Int_BufSz  + 1  ! NPIE
  Int_BufSz  = Int_BufSz  + 1  ! NPTE
  Int_BufSz  = Int_BufSz  + 1  ! NPTTE
  Int_BufSz   = Int_BufSz   + SIZE( InData%NPSBE )  ! NPSBE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%NPSE )  ! NPSE 
  Int_BufSz  = Int_BufSz  + 1  ! NPUE
  Int_BufSz  = Int_BufSz  + 1  ! NPYE
  Int_BufSz   = Int_BufSz   + SIZE( InData%PCE )  ! PCE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PDE )  ! PDE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PIE )  ! PIE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PTE )  ! PTE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PTTE )  ! PTTE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PS )  ! PS 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PSBE )  ! PSBE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PSE )  ! PSE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PUE )  ! PUE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%PYE )  ! PYE 
  Int_BufSz   = Int_BufSz   + SIZE( InData%SrtPS )  ! SrtPS 
  Int_BufSz   = Int_BufSz   + SIZE( InData%SrtPSNAUG )  ! SrtPSNAUG 
  Int_BufSz   = Int_BufSz   + SIZE( InData%Diag )  ! Diag 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NActvDOF )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPCE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPDE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPIE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPTE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPTTE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NPSBE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NPSBE))-1 ) = PACK(InData%NPSBE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NPSBE)
  ENDIF
  IF ( ALLOCATED(InData%NPSE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NPSE))-1 ) = PACK(InData%NPSE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NPSE)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPUE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPYE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PCE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PCE))-1 ) = PACK(InData%PCE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PCE)
  ENDIF
  IF ( ALLOCATED(InData%PDE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PDE))-1 ) = PACK(InData%PDE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PDE)
  ENDIF
  IF ( ALLOCATED(InData%PIE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PIE))-1 ) = PACK(InData%PIE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PIE)
  ENDIF
  IF ( ALLOCATED(InData%PTE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PTE))-1 ) = PACK(InData%PTE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PTE)
  ENDIF
  IF ( ALLOCATED(InData%PTTE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PTTE))-1 ) = PACK(InData%PTTE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PTTE)
  ENDIF
  IF ( ALLOCATED(InData%PS) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PS))-1 ) = PACK(InData%PS ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PS)
  ENDIF
  IF ( ALLOCATED(InData%PSBE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PSBE))-1 ) = PACK(InData%PSBE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PSBE)
  ENDIF
  IF ( ALLOCATED(InData%PSE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PSE))-1 ) = PACK(InData%PSE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PSE)
  ENDIF
  IF ( ALLOCATED(InData%PUE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PUE))-1 ) = PACK(InData%PUE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PUE)
  ENDIF
  IF ( ALLOCATED(InData%PYE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PYE))-1 ) = PACK(InData%PYE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PYE)
  ENDIF
  IF ( ALLOCATED(InData%SrtPS) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SrtPS))-1 ) = PACK(InData%SrtPS ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%SrtPS)
  ENDIF
  IF ( ALLOCATED(InData%SrtPSNAUG) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SrtPSNAUG))-1 ) = PACK(InData%SrtPSNAUG ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%SrtPSNAUG)
  ENDIF
  IF ( ALLOCATED(InData%Diag) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%Diag))-1 ) = PACK(InData%Diag ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%Diag)
  ENDIF
 END SUBROUTINE ED_Packactivedofs

 SUBROUTINE ED_UnPackactivedofs( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ed_activedofs), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NActvDOF = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPCE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPDE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPIE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPTE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPTTE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NPSBE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NPSBE,1))); mask1 = .TRUE.
    OutData%NPSBE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NPSBE))-1 ),mask1,OutData%NPSBE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NPSBE)
  ENDIF
  IF ( ALLOCATED(OutData%NPSE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NPSE,1))); mask1 = .TRUE.
    OutData%NPSE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NPSE))-1 ),mask1,OutData%NPSE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NPSE)
  ENDIF
  OutData%NPUE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPYE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PCE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PCE,1))); mask1 = .TRUE.
    OutData%PCE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PCE))-1 ),mask1,OutData%PCE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PCE)
  ENDIF
  IF ( ALLOCATED(OutData%PDE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PDE,1))); mask1 = .TRUE.
    OutData%PDE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PDE))-1 ),mask1,OutData%PDE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PDE)
  ENDIF
  IF ( ALLOCATED(OutData%PIE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PIE,1))); mask1 = .TRUE.
    OutData%PIE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PIE))-1 ),mask1,OutData%PIE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PIE)
  ENDIF
  IF ( ALLOCATED(OutData%PTE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PTE,1))); mask1 = .TRUE.
    OutData%PTE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PTE))-1 ),mask1,OutData%PTE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PTE)
  ENDIF
  IF ( ALLOCATED(OutData%PTTE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PTTE,1))); mask1 = .TRUE.
    OutData%PTTE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PTTE))-1 ),mask1,OutData%PTTE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PTTE)
  ENDIF
  IF ( ALLOCATED(OutData%PS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PS,1))); mask1 = .TRUE.
    OutData%PS = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PS))-1 ),mask1,OutData%PS)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PS)
  ENDIF
  IF ( ALLOCATED(OutData%PSBE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PSBE,1),SIZE(OutData%PSBE,2))); mask2 = .TRUE.
    OutData%PSBE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PSBE))-1 ),mask2,OutData%PSBE)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PSBE)
  ENDIF
  IF ( ALLOCATED(OutData%PSE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PSE,1),SIZE(OutData%PSE,2))); mask2 = .TRUE.
    OutData%PSE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PSE))-1 ),mask2,OutData%PSE)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PSE)
  ENDIF
  IF ( ALLOCATED(OutData%PUE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PUE,1))); mask1 = .TRUE.
    OutData%PUE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PUE))-1 ),mask1,OutData%PUE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PUE)
  ENDIF
  IF ( ALLOCATED(OutData%PYE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PYE,1))); mask1 = .TRUE.
    OutData%PYE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PYE))-1 ),mask1,OutData%PYE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PYE)
  ENDIF
  IF ( ALLOCATED(OutData%SrtPS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SrtPS,1))); mask1 = .TRUE.
    OutData%SrtPS = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SrtPS))-1 ),mask1,OutData%SrtPS)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%SrtPS)
  ENDIF
  IF ( ALLOCATED(OutData%SrtPSNAUG) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SrtPSNAUG,1))); mask1 = .TRUE.
    OutData%SrtPSNAUG = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SrtPSNAUG))-1 ),mask1,OutData%SrtPSNAUG)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%SrtPSNAUG)
  ENDIF
  IF ( ALLOCATED(OutData%Diag) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Diag,1))); mask1 = .TRUE.
    OutData%Diag = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%Diag))-1 ),mask1,OutData%Diag)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%Diag)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackactivedofs

 SUBROUTINE ED_Copyrthndside( SrcrthndsideData, DstrthndsideData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ed_rthndside), INTENT(INOUT) :: SrcrthndsideData
   TYPE(ed_rthndside), INTENT(INOUT) :: DstrthndsideData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstrthndsideData%rO = SrcrthndsideData%rO
IF (ALLOCATED(SrcrthndsideData%rQS)) THEN
   i1_l = LBOUND(SrcrthndsideData%rQS,1)
   i1_u = UBOUND(SrcrthndsideData%rQS,1)
   i2_l = LBOUND(SrcrthndsideData%rQS,2)
   i2_u = UBOUND(SrcrthndsideData%rQS,2)
   i3_l = LBOUND(SrcrthndsideData%rQS,3)
   i3_u = UBOUND(SrcrthndsideData%rQS,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%rQS)) THEN 
      ALLOCATE(DstrthndsideData%rQS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rQS.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rQS = SrcrthndsideData%rQS
ENDIF
IF (ALLOCATED(SrcrthndsideData%rS)) THEN
   i1_l = LBOUND(SrcrthndsideData%rS,1)
   i1_u = UBOUND(SrcrthndsideData%rS,1)
   i2_l = LBOUND(SrcrthndsideData%rS,2)
   i2_u = UBOUND(SrcrthndsideData%rS,2)
   i3_l = LBOUND(SrcrthndsideData%rS,3)
   i3_u = UBOUND(SrcrthndsideData%rS,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%rS)) THEN 
      ALLOCATE(DstrthndsideData%rS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rS.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rS = SrcrthndsideData%rS
ENDIF
IF (ALLOCATED(SrcrthndsideData%rS0S)) THEN
   i1_l = LBOUND(SrcrthndsideData%rS0S,1)
   i1_u = UBOUND(SrcrthndsideData%rS0S,1)
   i2_l = LBOUND(SrcrthndsideData%rS0S,2)
   i2_u = UBOUND(SrcrthndsideData%rS0S,2)
   i3_l = LBOUND(SrcrthndsideData%rS0S,3)
   i3_u = UBOUND(SrcrthndsideData%rS0S,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%rS0S)) THEN 
      ALLOCATE(DstrthndsideData%rS0S(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rS0S.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rS0S = SrcrthndsideData%rS0S
ENDIF
IF (ALLOCATED(SrcrthndsideData%rT)) THEN
   i1_l = LBOUND(SrcrthndsideData%rT,1)
   i1_u = UBOUND(SrcrthndsideData%rT,1)
   i2_l = LBOUND(SrcrthndsideData%rT,2)
   i2_u = UBOUND(SrcrthndsideData%rT,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%rT)) THEN 
      ALLOCATE(DstrthndsideData%rT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rT.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rT = SrcrthndsideData%rT
ENDIF
   DstrthndsideData%rT0O = SrcrthndsideData%rT0O
IF (ALLOCATED(SrcrthndsideData%rT0T)) THEN
   i1_l = LBOUND(SrcrthndsideData%rT0T,1)
   i1_u = UBOUND(SrcrthndsideData%rT0T,1)
   i2_l = LBOUND(SrcrthndsideData%rT0T,2)
   i2_u = UBOUND(SrcrthndsideData%rT0T,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%rT0T)) THEN 
      ALLOCATE(DstrthndsideData%rT0T(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rT0T.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rT0T = SrcrthndsideData%rT0T
ENDIF
   DstrthndsideData%rZ = SrcrthndsideData%rZ
   DstrthndsideData%rZO = SrcrthndsideData%rZO
IF (ALLOCATED(SrcrthndsideData%rZT)) THEN
   i1_l = LBOUND(SrcrthndsideData%rZT,1)
   i1_u = UBOUND(SrcrthndsideData%rZT,1)
   i2_l = LBOUND(SrcrthndsideData%rZT,2)
   i2_u = UBOUND(SrcrthndsideData%rZT,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%rZT)) THEN 
      ALLOCATE(DstrthndsideData%rZT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rZT.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rZT = SrcrthndsideData%rZT
ENDIF
   DstrthndsideData%rPQ = SrcrthndsideData%rPQ
   DstrthndsideData%rP = SrcrthndsideData%rP
   DstrthndsideData%rV = SrcrthndsideData%rV
   DstrthndsideData%rZY = SrcrthndsideData%rZY
   DstrthndsideData%rOU = SrcrthndsideData%rOU
   DstrthndsideData%rOV = SrcrthndsideData%rOV
   DstrthndsideData%rVD = SrcrthndsideData%rVD
   DstrthndsideData%rOW = SrcrthndsideData%rOW
   DstrthndsideData%rPC = SrcrthndsideData%rPC
IF (ALLOCATED(SrcrthndsideData%rPS0)) THEN
   i1_l = LBOUND(SrcrthndsideData%rPS0,1)
   i1_u = UBOUND(SrcrthndsideData%rPS0,1)
   i2_l = LBOUND(SrcrthndsideData%rPS0,2)
   i2_u = UBOUND(SrcrthndsideData%rPS0,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%rPS0)) THEN 
      ALLOCATE(DstrthndsideData%rPS0(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%rPS0.'
         RETURN
      END IF
   END IF
   DstrthndsideData%rPS0 = SrcrthndsideData%rPS0
ENDIF
   DstrthndsideData%rQC = SrcrthndsideData%rQC
   DstrthndsideData%rVIMU = SrcrthndsideData%rVIMU
   DstrthndsideData%rVP = SrcrthndsideData%rVP
   DstrthndsideData%rWI = SrcrthndsideData%rWI
   DstrthndsideData%rWJ = SrcrthndsideData%rWJ
   DstrthndsideData%rWK = SrcrthndsideData%rWK
   DstrthndsideData%rZT0 = SrcrthndsideData%rZT0
IF (ALLOCATED(SrcrthndsideData%AngPosEF)) THEN
   i1_l = LBOUND(SrcrthndsideData%AngPosEF,1)
   i1_u = UBOUND(SrcrthndsideData%AngPosEF,1)
   i2_l = LBOUND(SrcrthndsideData%AngPosEF,2)
   i2_u = UBOUND(SrcrthndsideData%AngPosEF,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%AngPosEF)) THEN 
      ALLOCATE(DstrthndsideData%AngPosEF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%AngPosEF.'
         RETURN
      END IF
   END IF
   DstrthndsideData%AngPosEF = SrcrthndsideData%AngPosEF
ENDIF
IF (ALLOCATED(SrcrthndsideData%AngPosXF)) THEN
   i1_l = LBOUND(SrcrthndsideData%AngPosXF,1)
   i1_u = UBOUND(SrcrthndsideData%AngPosXF,1)
   i2_l = LBOUND(SrcrthndsideData%AngPosXF,2)
   i2_u = UBOUND(SrcrthndsideData%AngPosXF,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%AngPosXF)) THEN 
      ALLOCATE(DstrthndsideData%AngPosXF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%AngPosXF.'
         RETURN
      END IF
   END IF
   DstrthndsideData%AngPosXF = SrcrthndsideData%AngPosXF
ENDIF
IF (ALLOCATED(SrcrthndsideData%AngPosHM)) THEN
   i1_l = LBOUND(SrcrthndsideData%AngPosHM,1)
   i1_u = UBOUND(SrcrthndsideData%AngPosHM,1)
   i2_l = LBOUND(SrcrthndsideData%AngPosHM,2)
   i2_u = UBOUND(SrcrthndsideData%AngPosHM,2)
   i3_l = LBOUND(SrcrthndsideData%AngPosHM,3)
   i3_u = UBOUND(SrcrthndsideData%AngPosHM,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%AngPosHM)) THEN 
      ALLOCATE(DstrthndsideData%AngPosHM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%AngPosHM.'
         RETURN
      END IF
   END IF
   DstrthndsideData%AngPosHM = SrcrthndsideData%AngPosHM
ENDIF
   DstrthndsideData%AngPosXB = SrcrthndsideData%AngPosXB
   DstrthndsideData%AngPosEX = SrcrthndsideData%AngPosEX
IF (ALLOCATED(SrcrthndsideData%PAngVelEA)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEA,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEA,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEA,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEA,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEA,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEA,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEA)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEA.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEA = SrcrthndsideData%PAngVelEA
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEF)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEF,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEF,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEF,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEF,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEF,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEF,3)
   i4_l = LBOUND(SrcrthndsideData%PAngVelEF,4)
   i4_u = UBOUND(SrcrthndsideData%PAngVelEF,4)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEF)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEF.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEF = SrcrthndsideData%PAngVelEF
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEG)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEG,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEG,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEG,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEG,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEG,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEG,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEG)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEG(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEG.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEG = SrcrthndsideData%PAngVelEG
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEH)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEH,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEH,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEH,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEH,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEH,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEH,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEH)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEH(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEH.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEH = SrcrthndsideData%PAngVelEH
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEL)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEL,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEL,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEL,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEL,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEL,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEL,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEL)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEL.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEL = SrcrthndsideData%PAngVelEL
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEM)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEM,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEM,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEM,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEM,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEM,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEM,3)
   i4_l = LBOUND(SrcrthndsideData%PAngVelEM,4)
   i4_u = UBOUND(SrcrthndsideData%PAngVelEM,4)
   i5_l = LBOUND(SrcrthndsideData%PAngVelEM,5)
   i5_u = UBOUND(SrcrthndsideData%PAngVelEM,5)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEM)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEM.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEM = SrcrthndsideData%PAngVelEM
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEN)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEN,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEN,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEN,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEN,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEN,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEN,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEN)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEN.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEN = SrcrthndsideData%PAngVelEN
ENDIF
   DstrthndsideData%AngVelEA = SrcrthndsideData%AngVelEA
IF (ALLOCATED(SrcrthndsideData%PAngVelEB)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEB,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEB,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEB,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEB,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEB,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEB,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEB)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEB.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEB = SrcrthndsideData%PAngVelEB
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelER)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelER,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelER,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelER,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelER,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelER,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelER,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelER)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelER(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelER.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelER = SrcrthndsideData%PAngVelER
ENDIF
IF (ALLOCATED(SrcrthndsideData%PAngVelEX)) THEN
   i1_l = LBOUND(SrcrthndsideData%PAngVelEX,1)
   i1_u = UBOUND(SrcrthndsideData%PAngVelEX,1)
   i2_l = LBOUND(SrcrthndsideData%PAngVelEX,2)
   i2_u = UBOUND(SrcrthndsideData%PAngVelEX,2)
   i3_l = LBOUND(SrcrthndsideData%PAngVelEX,3)
   i3_u = UBOUND(SrcrthndsideData%PAngVelEX,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PAngVelEX)) THEN 
      ALLOCATE(DstrthndsideData%PAngVelEX(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PAngVelEX.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PAngVelEX = SrcrthndsideData%PAngVelEX
ENDIF
   DstrthndsideData%AngVelEG = SrcrthndsideData%AngVelEG
   DstrthndsideData%AngVelEH = SrcrthndsideData%AngVelEH
   DstrthndsideData%AngVelEL = SrcrthndsideData%AngVelEL
   DstrthndsideData%AngVelEN = SrcrthndsideData%AngVelEN
   DstrthndsideData%AngVelEB = SrcrthndsideData%AngVelEB
   DstrthndsideData%AngVelER = SrcrthndsideData%AngVelER
   DstrthndsideData%AngVelEX = SrcrthndsideData%AngVelEX
   DstrthndsideData%TeetAngVel = SrcrthndsideData%TeetAngVel
   DstrthndsideData%AngAccEBt = SrcrthndsideData%AngAccEBt
   DstrthndsideData%AngAccERt = SrcrthndsideData%AngAccERt
   DstrthndsideData%AngAccEXt = SrcrthndsideData%AngAccEXt
IF (ALLOCATED(SrcrthndsideData%AngAccEFt)) THEN
   i1_l = LBOUND(SrcrthndsideData%AngAccEFt,1)
   i1_u = UBOUND(SrcrthndsideData%AngAccEFt,1)
   i2_l = LBOUND(SrcrthndsideData%AngAccEFt,2)
   i2_u = UBOUND(SrcrthndsideData%AngAccEFt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%AngAccEFt)) THEN 
      ALLOCATE(DstrthndsideData%AngAccEFt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%AngAccEFt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%AngAccEFt = SrcrthndsideData%AngAccEFt
ENDIF
IF (ALLOCATED(SrcrthndsideData%AngVelEF)) THEN
   i1_l = LBOUND(SrcrthndsideData%AngVelEF,1)
   i1_u = UBOUND(SrcrthndsideData%AngVelEF,1)
   i2_l = LBOUND(SrcrthndsideData%AngVelEF,2)
   i2_u = UBOUND(SrcrthndsideData%AngVelEF,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%AngVelEF)) THEN 
      ALLOCATE(DstrthndsideData%AngVelEF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%AngVelEF.'
         RETURN
      END IF
   END IF
   DstrthndsideData%AngVelEF = SrcrthndsideData%AngVelEF
ENDIF
   DstrthndsideData%AngAccEAt = SrcrthndsideData%AngAccEAt
   DstrthndsideData%AngAccEGt = SrcrthndsideData%AngAccEGt
   DstrthndsideData%AngAccEHt = SrcrthndsideData%AngAccEHt
   DstrthndsideData%AngAccENt = SrcrthndsideData%AngAccENt
   DstrthndsideData%LinAccECt = SrcrthndsideData%LinAccECt
   DstrthndsideData%LinAccEDt = SrcrthndsideData%LinAccEDt
   DstrthndsideData%LinAccEIt = SrcrthndsideData%LinAccEIt
   DstrthndsideData%LinAccEJt = SrcrthndsideData%LinAccEJt
   DstrthndsideData%LinAccEUt = SrcrthndsideData%LinAccEUt
   DstrthndsideData%LinAccEYt = SrcrthndsideData%LinAccEYt
IF (ALLOCATED(SrcrthndsideData%LinVelES)) THEN
   i1_l = LBOUND(SrcrthndsideData%LinVelES,1)
   i1_u = UBOUND(SrcrthndsideData%LinVelES,1)
   i2_l = LBOUND(SrcrthndsideData%LinVelES,2)
   i2_u = UBOUND(SrcrthndsideData%LinVelES,2)
   i3_l = LBOUND(SrcrthndsideData%LinVelES,3)
   i3_u = UBOUND(SrcrthndsideData%LinVelES,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%LinVelES)) THEN 
      ALLOCATE(DstrthndsideData%LinVelES(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%LinVelES.'
         RETURN
      END IF
   END IF
   DstrthndsideData%LinVelES = SrcrthndsideData%LinVelES
ENDIF
IF (ALLOCATED(SrcrthndsideData%LinVelET)) THEN
   i1_l = LBOUND(SrcrthndsideData%LinVelET,1)
   i1_u = UBOUND(SrcrthndsideData%LinVelET,1)
   i2_l = LBOUND(SrcrthndsideData%LinVelET,2)
   i2_u = UBOUND(SrcrthndsideData%LinVelET,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%LinVelET)) THEN 
      ALLOCATE(DstrthndsideData%LinVelET(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%LinVelET.'
         RETURN
      END IF
   END IF
   DstrthndsideData%LinVelET = SrcrthndsideData%LinVelET
ENDIF
IF (ALLOCATED(SrcrthndsideData%LinVelESm2)) THEN
   i1_l = LBOUND(SrcrthndsideData%LinVelESm2,1)
   i1_u = UBOUND(SrcrthndsideData%LinVelESm2,1)
   IF (.NOT.ALLOCATED(DstrthndsideData%LinVelESm2)) THEN 
      ALLOCATE(DstrthndsideData%LinVelESm2(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%LinVelESm2.'
         RETURN
      END IF
   END IF
   DstrthndsideData%LinVelESm2 = SrcrthndsideData%LinVelESm2
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEIMU)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEIMU,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEIMU,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEIMU,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEIMU,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEIMU,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEIMU,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEIMU)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEIMU(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEIMU.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEIMU = SrcrthndsideData%PLinVelEIMU
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEO)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEO,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEO,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEO,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEO,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEO,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEO,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEO)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEO(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEO.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEO = SrcrthndsideData%PLinVelEO
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelES)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelES,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelES,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelES,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelES,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelES,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelES,3)
   i4_l = LBOUND(SrcrthndsideData%PLinVelES,4)
   i4_u = UBOUND(SrcrthndsideData%PLinVelES,4)
   i5_l = LBOUND(SrcrthndsideData%PLinVelES,5)
   i5_u = UBOUND(SrcrthndsideData%PLinVelES,5)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelES)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelES(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelES.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelES = SrcrthndsideData%PLinVelES
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelET)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelET,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelET,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelET,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelET,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelET,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelET,3)
   i4_l = LBOUND(SrcrthndsideData%PLinVelET,4)
   i4_u = UBOUND(SrcrthndsideData%PLinVelET,4)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelET)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelET(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelET.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelET = SrcrthndsideData%PLinVelET
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEZ)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEZ,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEZ,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEZ,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEZ,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEZ,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEZ,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEZ)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEZ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEZ.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEZ = SrcrthndsideData%PLinVelEZ
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEC)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEC,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEC,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEC,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEC,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEC,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEC,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEC)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEC.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEC = SrcrthndsideData%PLinVelEC
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelED)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelED,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelED,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelED,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelED,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelED,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelED,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelED)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelED.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelED = SrcrthndsideData%PLinVelED
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEI)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEI,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEI,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEI,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEI,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEI,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEI,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEI)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEI(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEI.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEI = SrcrthndsideData%PLinVelEI
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEJ)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEJ,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEJ,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEJ,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEJ,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEJ,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEJ,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEJ)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEJ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEJ.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEJ = SrcrthndsideData%PLinVelEJ
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEK)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEK,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEK,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEK,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEK,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEK,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEK,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEK)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEK(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEK.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEK = SrcrthndsideData%PLinVelEK
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEP)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEP,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEP,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEP,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEP,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEP,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEP,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEP)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEP(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEP.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEP = SrcrthndsideData%PLinVelEP
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEQ)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEQ,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEQ,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEQ,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEQ,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEQ,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEQ,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEQ)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEQ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEQ.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEQ = SrcrthndsideData%PLinVelEQ
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEU)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEU,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEU,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEU,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEU,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEU,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEU,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEU)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEU(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEU.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEU = SrcrthndsideData%PLinVelEU
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEV)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEV,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEV,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEV,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEV,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEV,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEV,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEV)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEV(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEV.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEV = SrcrthndsideData%PLinVelEV
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEW)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEW,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEW,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEW,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEW,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEW,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEW,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEW)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEW(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEW.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEW = SrcrthndsideData%PLinVelEW
ENDIF
IF (ALLOCATED(SrcrthndsideData%PLinVelEY)) THEN
   i1_l = LBOUND(SrcrthndsideData%PLinVelEY,1)
   i1_u = UBOUND(SrcrthndsideData%PLinVelEY,1)
   i2_l = LBOUND(SrcrthndsideData%PLinVelEY,2)
   i2_u = UBOUND(SrcrthndsideData%PLinVelEY,2)
   i3_l = LBOUND(SrcrthndsideData%PLinVelEY,3)
   i3_u = UBOUND(SrcrthndsideData%PLinVelEY,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PLinVelEY)) THEN 
      ALLOCATE(DstrthndsideData%PLinVelEY(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PLinVelEY.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PLinVelEY = SrcrthndsideData%PLinVelEY
ENDIF
   DstrthndsideData%LinAccEIMUt = SrcrthndsideData%LinAccEIMUt
   DstrthndsideData%LinAccEOt = SrcrthndsideData%LinAccEOt
IF (ALLOCATED(SrcrthndsideData%LinAccESt)) THEN
   i1_l = LBOUND(SrcrthndsideData%LinAccESt,1)
   i1_u = UBOUND(SrcrthndsideData%LinAccESt,1)
   i2_l = LBOUND(SrcrthndsideData%LinAccESt,2)
   i2_u = UBOUND(SrcrthndsideData%LinAccESt,2)
   i3_l = LBOUND(SrcrthndsideData%LinAccESt,3)
   i3_u = UBOUND(SrcrthndsideData%LinAccESt,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%LinAccESt)) THEN 
      ALLOCATE(DstrthndsideData%LinAccESt(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%LinAccESt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%LinAccESt = SrcrthndsideData%LinAccESt
ENDIF
IF (ALLOCATED(SrcrthndsideData%LinAccETt)) THEN
   i1_l = LBOUND(SrcrthndsideData%LinAccETt,1)
   i1_u = UBOUND(SrcrthndsideData%LinAccETt,1)
   i2_l = LBOUND(SrcrthndsideData%LinAccETt,2)
   i2_u = UBOUND(SrcrthndsideData%LinAccETt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%LinAccETt)) THEN 
      ALLOCATE(DstrthndsideData%LinAccETt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%LinAccETt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%LinAccETt = SrcrthndsideData%LinAccETt
ENDIF
   DstrthndsideData%LinAccEZt = SrcrthndsideData%LinAccEZt
   DstrthndsideData%LinVelEIMU = SrcrthndsideData%LinVelEIMU
   DstrthndsideData%LinVelEZ = SrcrthndsideData%LinVelEZ
   DstrthndsideData%FrcONcRtt = SrcrthndsideData%FrcONcRtt
   DstrthndsideData%FrcPRott = SrcrthndsideData%FrcPRott
IF (ALLOCATED(SrcrthndsideData%FrcS0Bt)) THEN
   i1_l = LBOUND(SrcrthndsideData%FrcS0Bt,1)
   i1_u = UBOUND(SrcrthndsideData%FrcS0Bt,1)
   i2_l = LBOUND(SrcrthndsideData%FrcS0Bt,2)
   i2_u = UBOUND(SrcrthndsideData%FrcS0Bt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%FrcS0Bt)) THEN 
      ALLOCATE(DstrthndsideData%FrcS0Bt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%FrcS0Bt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%FrcS0Bt = SrcrthndsideData%FrcS0Bt
ENDIF
   DstrthndsideData%FrcT0Trbt = SrcrthndsideData%FrcT0Trbt
IF (ALLOCATED(SrcrthndsideData%FSAero)) THEN
   i1_l = LBOUND(SrcrthndsideData%FSAero,1)
   i1_u = UBOUND(SrcrthndsideData%FSAero,1)
   i2_l = LBOUND(SrcrthndsideData%FSAero,2)
   i2_u = UBOUND(SrcrthndsideData%FSAero,2)
   i3_l = LBOUND(SrcrthndsideData%FSAero,3)
   i3_u = UBOUND(SrcrthndsideData%FSAero,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%FSAero)) THEN 
      ALLOCATE(DstrthndsideData%FSAero(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%FSAero.'
         RETURN
      END IF
   END IF
   DstrthndsideData%FSAero = SrcrthndsideData%FSAero
ENDIF
IF (ALLOCATED(SrcrthndsideData%FSTipDrag)) THEN
   i1_l = LBOUND(SrcrthndsideData%FSTipDrag,1)
   i1_u = UBOUND(SrcrthndsideData%FSTipDrag,1)
   i2_l = LBOUND(SrcrthndsideData%FSTipDrag,2)
   i2_u = UBOUND(SrcrthndsideData%FSTipDrag,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%FSTipDrag)) THEN 
      ALLOCATE(DstrthndsideData%FSTipDrag(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%FSTipDrag.'
         RETURN
      END IF
   END IF
   DstrthndsideData%FSTipDrag = SrcrthndsideData%FSTipDrag
ENDIF
IF (ALLOCATED(SrcrthndsideData%FTHydrot)) THEN
   i1_l = LBOUND(SrcrthndsideData%FTHydrot,1)
   i1_u = UBOUND(SrcrthndsideData%FTHydrot,1)
   i2_l = LBOUND(SrcrthndsideData%FTHydrot,2)
   i2_u = UBOUND(SrcrthndsideData%FTHydrot,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%FTHydrot)) THEN 
      ALLOCATE(DstrthndsideData%FTHydrot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%FTHydrot.'
         RETURN
      END IF
   END IF
   DstrthndsideData%FTHydrot = SrcrthndsideData%FTHydrot
ENDIF
   DstrthndsideData%FZHydrot = SrcrthndsideData%FZHydrot
IF (ALLOCATED(SrcrthndsideData%MFHydrot)) THEN
   i1_l = LBOUND(SrcrthndsideData%MFHydrot,1)
   i1_u = UBOUND(SrcrthndsideData%MFHydrot,1)
   i2_l = LBOUND(SrcrthndsideData%MFHydrot,2)
   i2_u = UBOUND(SrcrthndsideData%MFHydrot,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%MFHydrot)) THEN 
      ALLOCATE(DstrthndsideData%MFHydrot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%MFHydrot.'
         RETURN
      END IF
   END IF
   DstrthndsideData%MFHydrot = SrcrthndsideData%MFHydrot
ENDIF
   DstrthndsideData%MomBNcRtt = SrcrthndsideData%MomBNcRtt
IF (ALLOCATED(SrcrthndsideData%MomH0Bt)) THEN
   i1_l = LBOUND(SrcrthndsideData%MomH0Bt,1)
   i1_u = UBOUND(SrcrthndsideData%MomH0Bt,1)
   i2_l = LBOUND(SrcrthndsideData%MomH0Bt,2)
   i2_u = UBOUND(SrcrthndsideData%MomH0Bt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%MomH0Bt)) THEN 
      ALLOCATE(DstrthndsideData%MomH0Bt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%MomH0Bt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%MomH0Bt = SrcrthndsideData%MomH0Bt
ENDIF
   DstrthndsideData%MomLPRott = SrcrthndsideData%MomLPRott
   DstrthndsideData%MomNGnRtt = SrcrthndsideData%MomNGnRtt
   DstrthndsideData%MomNTailt = SrcrthndsideData%MomNTailt
   DstrthndsideData%MomX0Trbt = SrcrthndsideData%MomX0Trbt
IF (ALLOCATED(SrcrthndsideData%MMAero)) THEN
   i1_l = LBOUND(SrcrthndsideData%MMAero,1)
   i1_u = UBOUND(SrcrthndsideData%MMAero,1)
   i2_l = LBOUND(SrcrthndsideData%MMAero,2)
   i2_u = UBOUND(SrcrthndsideData%MMAero,2)
   i3_l = LBOUND(SrcrthndsideData%MMAero,3)
   i3_u = UBOUND(SrcrthndsideData%MMAero,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%MMAero)) THEN 
      ALLOCATE(DstrthndsideData%MMAero(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%MMAero.'
         RETURN
      END IF
   END IF
   DstrthndsideData%MMAero = SrcrthndsideData%MMAero
ENDIF
   DstrthndsideData%MXHydrot = SrcrthndsideData%MXHydrot
IF (ALLOCATED(SrcrthndsideData%PFrcONcRt)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcONcRt,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcONcRt,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcONcRt,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcONcRt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcONcRt)) THEN 
      ALLOCATE(DstrthndsideData%PFrcONcRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcONcRt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcONcRt = SrcrthndsideData%PFrcONcRt
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFrcPRot)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcPRot,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcPRot,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcPRot,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcPRot,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcPRot)) THEN 
      ALLOCATE(DstrthndsideData%PFrcPRot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcPRot.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcPRot = SrcrthndsideData%PFrcPRot
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFrcS0B)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcS0B,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcS0B,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcS0B,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcS0B,2)
   i3_l = LBOUND(SrcrthndsideData%PFrcS0B,3)
   i3_u = UBOUND(SrcrthndsideData%PFrcS0B,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcS0B)) THEN 
      ALLOCATE(DstrthndsideData%PFrcS0B(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcS0B.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcS0B = SrcrthndsideData%PFrcS0B
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFrcT0Trb)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcT0Trb,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcT0Trb,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcT0Trb,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcT0Trb,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcT0Trb)) THEN 
      ALLOCATE(DstrthndsideData%PFrcT0Trb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcT0Trb.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcT0Trb = SrcrthndsideData%PFrcT0Trb
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFTHydro)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFTHydro,1)
   i1_u = UBOUND(SrcrthndsideData%PFTHydro,1)
   i2_l = LBOUND(SrcrthndsideData%PFTHydro,2)
   i2_u = UBOUND(SrcrthndsideData%PFTHydro,2)
   i3_l = LBOUND(SrcrthndsideData%PFTHydro,3)
   i3_u = UBOUND(SrcrthndsideData%PFTHydro,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFTHydro)) THEN 
      ALLOCATE(DstrthndsideData%PFTHydro(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFTHydro.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFTHydro = SrcrthndsideData%PFTHydro
ENDIF
   DstrthndsideData%PFZHydro = SrcrthndsideData%PFZHydro
IF (ALLOCATED(SrcrthndsideData%PMFHydro)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMFHydro,1)
   i1_u = UBOUND(SrcrthndsideData%PMFHydro,1)
   i2_l = LBOUND(SrcrthndsideData%PMFHydro,2)
   i2_u = UBOUND(SrcrthndsideData%PMFHydro,2)
   i3_l = LBOUND(SrcrthndsideData%PMFHydro,3)
   i3_u = UBOUND(SrcrthndsideData%PMFHydro,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMFHydro)) THEN 
      ALLOCATE(DstrthndsideData%PMFHydro(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMFHydro.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMFHydro = SrcrthndsideData%PMFHydro
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomBNcRt)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomBNcRt,1)
   i1_u = UBOUND(SrcrthndsideData%PMomBNcRt,1)
   i2_l = LBOUND(SrcrthndsideData%PMomBNcRt,2)
   i2_u = UBOUND(SrcrthndsideData%PMomBNcRt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomBNcRt)) THEN 
      ALLOCATE(DstrthndsideData%PMomBNcRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomBNcRt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomBNcRt = SrcrthndsideData%PMomBNcRt
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomH0B)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomH0B,1)
   i1_u = UBOUND(SrcrthndsideData%PMomH0B,1)
   i2_l = LBOUND(SrcrthndsideData%PMomH0B,2)
   i2_u = UBOUND(SrcrthndsideData%PMomH0B,2)
   i3_l = LBOUND(SrcrthndsideData%PMomH0B,3)
   i3_u = UBOUND(SrcrthndsideData%PMomH0B,3)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomH0B)) THEN 
      ALLOCATE(DstrthndsideData%PMomH0B(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomH0B.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomH0B = SrcrthndsideData%PMomH0B
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomLPRot)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomLPRot,1)
   i1_u = UBOUND(SrcrthndsideData%PMomLPRot,1)
   i2_l = LBOUND(SrcrthndsideData%PMomLPRot,2)
   i2_u = UBOUND(SrcrthndsideData%PMomLPRot,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomLPRot)) THEN 
      ALLOCATE(DstrthndsideData%PMomLPRot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomLPRot.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomLPRot = SrcrthndsideData%PMomLPRot
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomNGnRt)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomNGnRt,1)
   i1_u = UBOUND(SrcrthndsideData%PMomNGnRt,1)
   i2_l = LBOUND(SrcrthndsideData%PMomNGnRt,2)
   i2_u = UBOUND(SrcrthndsideData%PMomNGnRt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomNGnRt)) THEN 
      ALLOCATE(DstrthndsideData%PMomNGnRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomNGnRt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomNGnRt = SrcrthndsideData%PMomNGnRt
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomNTail)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomNTail,1)
   i1_u = UBOUND(SrcrthndsideData%PMomNTail,1)
   i2_l = LBOUND(SrcrthndsideData%PMomNTail,2)
   i2_u = UBOUND(SrcrthndsideData%PMomNTail,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomNTail)) THEN 
      ALLOCATE(DstrthndsideData%PMomNTail(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomNTail.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomNTail = SrcrthndsideData%PMomNTail
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomX0Trb)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomX0Trb,1)
   i1_u = UBOUND(SrcrthndsideData%PMomX0Trb,1)
   i2_l = LBOUND(SrcrthndsideData%PMomX0Trb,2)
   i2_u = UBOUND(SrcrthndsideData%PMomX0Trb,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomX0Trb)) THEN 
      ALLOCATE(DstrthndsideData%PMomX0Trb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomX0Trb.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomX0Trb = SrcrthndsideData%PMomX0Trb
ENDIF
   DstrthndsideData%PMXHydro = SrcrthndsideData%PMXHydro
   DstrthndsideData%TeetAng = SrcrthndsideData%TeetAng
   DstrthndsideData%FrcVGnRtt = SrcrthndsideData%FrcVGnRtt
   DstrthndsideData%FrcWTailt = SrcrthndsideData%FrcWTailt
   DstrthndsideData%FrcZAllt = SrcrthndsideData%FrcZAllt
   DstrthndsideData%MomXAllt = SrcrthndsideData%MomXAllt
IF (ALLOCATED(SrcrthndsideData%PFrcVGnRt)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcVGnRt,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcVGnRt,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcVGnRt,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcVGnRt,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcVGnRt)) THEN 
      ALLOCATE(DstrthndsideData%PFrcVGnRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcVGnRt.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcVGnRt = SrcrthndsideData%PFrcVGnRt
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFrcWTail)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcWTail,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcWTail,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcWTail,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcWTail,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcWTail)) THEN 
      ALLOCATE(DstrthndsideData%PFrcWTail(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcWTail.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcWTail = SrcrthndsideData%PFrcWTail
ENDIF
IF (ALLOCATED(SrcrthndsideData%PFrcZAll)) THEN
   i1_l = LBOUND(SrcrthndsideData%PFrcZAll,1)
   i1_u = UBOUND(SrcrthndsideData%PFrcZAll,1)
   i2_l = LBOUND(SrcrthndsideData%PFrcZAll,2)
   i2_u = UBOUND(SrcrthndsideData%PFrcZAll,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PFrcZAll)) THEN 
      ALLOCATE(DstrthndsideData%PFrcZAll(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PFrcZAll.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PFrcZAll = SrcrthndsideData%PFrcZAll
ENDIF
IF (ALLOCATED(SrcrthndsideData%PMomXAll)) THEN
   i1_l = LBOUND(SrcrthndsideData%PMomXAll,1)
   i1_u = UBOUND(SrcrthndsideData%PMomXAll,1)
   i2_l = LBOUND(SrcrthndsideData%PMomXAll,2)
   i2_u = UBOUND(SrcrthndsideData%PMomXAll,2)
   IF (.NOT.ALLOCATED(DstrthndsideData%PMomXAll)) THEN 
      ALLOCATE(DstrthndsideData%PMomXAll(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_Copyrthndside: Error allocating DstrthndsideData%PMomXAll.'
         RETURN
      END IF
   END IF
   DstrthndsideData%PMomXAll = SrcrthndsideData%PMomXAll
ENDIF
   DstrthndsideData%TeetMom = SrcrthndsideData%TeetMom
   DstrthndsideData%TFrlMom = SrcrthndsideData%TFrlMom
   DstrthndsideData%RFrlMom = SrcrthndsideData%RFrlMom
   DstrthndsideData%GBoxEffFac = SrcrthndsideData%GBoxEffFac
 END SUBROUTINE ED_Copyrthndside

 SUBROUTINE ED_Destroyrthndside( rthndsideData, ErrStat, ErrMsg )
  TYPE(ed_rthndside), INTENT(INOUT) :: rthndsideData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(rthndsideData%rQS) ) DEALLOCATE(rthndsideData%rQS)
  IF ( ALLOCATED(rthndsideData%rS) ) DEALLOCATE(rthndsideData%rS)
  IF ( ALLOCATED(rthndsideData%rS0S) ) DEALLOCATE(rthndsideData%rS0S)
  IF ( ALLOCATED(rthndsideData%rT) ) DEALLOCATE(rthndsideData%rT)
  IF ( ALLOCATED(rthndsideData%rT0T) ) DEALLOCATE(rthndsideData%rT0T)
  IF ( ALLOCATED(rthndsideData%rZT) ) DEALLOCATE(rthndsideData%rZT)
  IF ( ALLOCATED(rthndsideData%rPS0) ) DEALLOCATE(rthndsideData%rPS0)
  IF ( ALLOCATED(rthndsideData%AngPosEF) ) DEALLOCATE(rthndsideData%AngPosEF)
  IF ( ALLOCATED(rthndsideData%AngPosXF) ) DEALLOCATE(rthndsideData%AngPosXF)
  IF ( ALLOCATED(rthndsideData%AngPosHM) ) DEALLOCATE(rthndsideData%AngPosHM)
  IF ( ALLOCATED(rthndsideData%PAngVelEA) ) DEALLOCATE(rthndsideData%PAngVelEA)
  IF ( ALLOCATED(rthndsideData%PAngVelEF) ) DEALLOCATE(rthndsideData%PAngVelEF)
  IF ( ALLOCATED(rthndsideData%PAngVelEG) ) DEALLOCATE(rthndsideData%PAngVelEG)
  IF ( ALLOCATED(rthndsideData%PAngVelEH) ) DEALLOCATE(rthndsideData%PAngVelEH)
  IF ( ALLOCATED(rthndsideData%PAngVelEL) ) DEALLOCATE(rthndsideData%PAngVelEL)
  IF ( ALLOCATED(rthndsideData%PAngVelEM) ) DEALLOCATE(rthndsideData%PAngVelEM)
  IF ( ALLOCATED(rthndsideData%PAngVelEN) ) DEALLOCATE(rthndsideData%PAngVelEN)
  IF ( ALLOCATED(rthndsideData%PAngVelEB) ) DEALLOCATE(rthndsideData%PAngVelEB)
  IF ( ALLOCATED(rthndsideData%PAngVelER) ) DEALLOCATE(rthndsideData%PAngVelER)
  IF ( ALLOCATED(rthndsideData%PAngVelEX) ) DEALLOCATE(rthndsideData%PAngVelEX)
  IF ( ALLOCATED(rthndsideData%AngAccEFt) ) DEALLOCATE(rthndsideData%AngAccEFt)
  IF ( ALLOCATED(rthndsideData%AngVelEF) ) DEALLOCATE(rthndsideData%AngVelEF)
  IF ( ALLOCATED(rthndsideData%LinVelES) ) DEALLOCATE(rthndsideData%LinVelES)
  IF ( ALLOCATED(rthndsideData%LinVelET) ) DEALLOCATE(rthndsideData%LinVelET)
  IF ( ALLOCATED(rthndsideData%LinVelESm2) ) DEALLOCATE(rthndsideData%LinVelESm2)
  IF ( ALLOCATED(rthndsideData%PLinVelEIMU) ) DEALLOCATE(rthndsideData%PLinVelEIMU)
  IF ( ALLOCATED(rthndsideData%PLinVelEO) ) DEALLOCATE(rthndsideData%PLinVelEO)
  IF ( ALLOCATED(rthndsideData%PLinVelES) ) DEALLOCATE(rthndsideData%PLinVelES)
  IF ( ALLOCATED(rthndsideData%PLinVelET) ) DEALLOCATE(rthndsideData%PLinVelET)
  IF ( ALLOCATED(rthndsideData%PLinVelEZ) ) DEALLOCATE(rthndsideData%PLinVelEZ)
  IF ( ALLOCATED(rthndsideData%PLinVelEC) ) DEALLOCATE(rthndsideData%PLinVelEC)
  IF ( ALLOCATED(rthndsideData%PLinVelED) ) DEALLOCATE(rthndsideData%PLinVelED)
  IF ( ALLOCATED(rthndsideData%PLinVelEI) ) DEALLOCATE(rthndsideData%PLinVelEI)
  IF ( ALLOCATED(rthndsideData%PLinVelEJ) ) DEALLOCATE(rthndsideData%PLinVelEJ)
  IF ( ALLOCATED(rthndsideData%PLinVelEK) ) DEALLOCATE(rthndsideData%PLinVelEK)
  IF ( ALLOCATED(rthndsideData%PLinVelEP) ) DEALLOCATE(rthndsideData%PLinVelEP)
  IF ( ALLOCATED(rthndsideData%PLinVelEQ) ) DEALLOCATE(rthndsideData%PLinVelEQ)
  IF ( ALLOCATED(rthndsideData%PLinVelEU) ) DEALLOCATE(rthndsideData%PLinVelEU)
  IF ( ALLOCATED(rthndsideData%PLinVelEV) ) DEALLOCATE(rthndsideData%PLinVelEV)
  IF ( ALLOCATED(rthndsideData%PLinVelEW) ) DEALLOCATE(rthndsideData%PLinVelEW)
  IF ( ALLOCATED(rthndsideData%PLinVelEY) ) DEALLOCATE(rthndsideData%PLinVelEY)
  IF ( ALLOCATED(rthndsideData%LinAccESt) ) DEALLOCATE(rthndsideData%LinAccESt)
  IF ( ALLOCATED(rthndsideData%LinAccETt) ) DEALLOCATE(rthndsideData%LinAccETt)
  IF ( ALLOCATED(rthndsideData%FrcS0Bt) ) DEALLOCATE(rthndsideData%FrcS0Bt)
  IF ( ALLOCATED(rthndsideData%FSAero) ) DEALLOCATE(rthndsideData%FSAero)
  IF ( ALLOCATED(rthndsideData%FSTipDrag) ) DEALLOCATE(rthndsideData%FSTipDrag)
  IF ( ALLOCATED(rthndsideData%FTHydrot) ) DEALLOCATE(rthndsideData%FTHydrot)
  IF ( ALLOCATED(rthndsideData%MFHydrot) ) DEALLOCATE(rthndsideData%MFHydrot)
  IF ( ALLOCATED(rthndsideData%MomH0Bt) ) DEALLOCATE(rthndsideData%MomH0Bt)
  IF ( ALLOCATED(rthndsideData%MMAero) ) DEALLOCATE(rthndsideData%MMAero)
  IF ( ALLOCATED(rthndsideData%PFrcONcRt) ) DEALLOCATE(rthndsideData%PFrcONcRt)
  IF ( ALLOCATED(rthndsideData%PFrcPRot) ) DEALLOCATE(rthndsideData%PFrcPRot)
  IF ( ALLOCATED(rthndsideData%PFrcS0B) ) DEALLOCATE(rthndsideData%PFrcS0B)
  IF ( ALLOCATED(rthndsideData%PFrcT0Trb) ) DEALLOCATE(rthndsideData%PFrcT0Trb)
  IF ( ALLOCATED(rthndsideData%PFTHydro) ) DEALLOCATE(rthndsideData%PFTHydro)
  IF ( ALLOCATED(rthndsideData%PMFHydro) ) DEALLOCATE(rthndsideData%PMFHydro)
  IF ( ALLOCATED(rthndsideData%PMomBNcRt) ) DEALLOCATE(rthndsideData%PMomBNcRt)
  IF ( ALLOCATED(rthndsideData%PMomH0B) ) DEALLOCATE(rthndsideData%PMomH0B)
  IF ( ALLOCATED(rthndsideData%PMomLPRot) ) DEALLOCATE(rthndsideData%PMomLPRot)
  IF ( ALLOCATED(rthndsideData%PMomNGnRt) ) DEALLOCATE(rthndsideData%PMomNGnRt)
  IF ( ALLOCATED(rthndsideData%PMomNTail) ) DEALLOCATE(rthndsideData%PMomNTail)
  IF ( ALLOCATED(rthndsideData%PMomX0Trb) ) DEALLOCATE(rthndsideData%PMomX0Trb)
  IF ( ALLOCATED(rthndsideData%PFrcVGnRt) ) DEALLOCATE(rthndsideData%PFrcVGnRt)
  IF ( ALLOCATED(rthndsideData%PFrcWTail) ) DEALLOCATE(rthndsideData%PFrcWTail)
  IF ( ALLOCATED(rthndsideData%PFrcZAll) ) DEALLOCATE(rthndsideData%PFrcZAll)
  IF ( ALLOCATED(rthndsideData%PMomXAll) ) DEALLOCATE(rthndsideData%PMomXAll)
 END SUBROUTINE ED_Destroyrthndside

 SUBROUTINE ED_Packrthndside( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ed_rthndside),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%rO )  ! rO 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rQS )  ! rQS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rS )  ! rS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rS0S )  ! rS0S 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rT )  ! rT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rT0O )  ! rT0O 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rT0T )  ! rT0T 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZ )  ! rZ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZO )  ! rZO 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZT )  ! rZT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rPQ )  ! rPQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rP )  ! rP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rV )  ! rV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZY )  ! rZY 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOU )  ! rOU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOV )  ! rOV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVD )  ! rVD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOW )  ! rOW 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rPC )  ! rPC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rPS0 )  ! rPS0 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rQC )  ! rQC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVIMU )  ! rVIMU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVP )  ! rVP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWI )  ! rWI 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWJ )  ! rWJ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWK )  ! rWK 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZT0 )  ! rZT0 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosEF )  ! AngPosEF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosXF )  ! AngPosXF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosHM )  ! AngPosHM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosXB )  ! AngPosXB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosEX )  ! AngPosEX 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEA )  ! PAngVelEA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEF )  ! PAngVelEF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEG )  ! PAngVelEG 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEH )  ! PAngVelEH 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEL )  ! PAngVelEL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEM )  ! PAngVelEM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEN )  ! PAngVelEN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEA )  ! AngVelEA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEB )  ! PAngVelEB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelER )  ! PAngVelER 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEX )  ! PAngVelEX 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEG )  ! AngVelEG 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEH )  ! AngVelEH 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEL )  ! AngVelEL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEN )  ! AngVelEN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEB )  ! AngVelEB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelER )  ! AngVelER 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEX )  ! AngVelEX 
  Re_BufSz   = Re_BufSz   + 1  ! TeetAngVel
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEBt )  ! AngAccEBt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccERt )  ! AngAccERt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEXt )  ! AngAccEXt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEFt )  ! AngAccEFt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEF )  ! AngVelEF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEAt )  ! AngAccEAt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEGt )  ! AngAccEGt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEHt )  ! AngAccEHt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccENt )  ! AngAccENt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccECt )  ! LinAccECt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEDt )  ! LinAccEDt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEIt )  ! LinAccEIt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEJt )  ! LinAccEJt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEUt )  ! LinAccEUt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEYt )  ! LinAccEYt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelES )  ! LinVelES 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelET )  ! LinVelET 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelESm2 )  ! LinVelESm2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEIMU )  ! PLinVelEIMU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEO )  ! PLinVelEO 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelES )  ! PLinVelES 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelET )  ! PLinVelET 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEZ )  ! PLinVelEZ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEC )  ! PLinVelEC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelED )  ! PLinVelED 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEI )  ! PLinVelEI 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEJ )  ! PLinVelEJ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEK )  ! PLinVelEK 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEP )  ! PLinVelEP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEQ )  ! PLinVelEQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEU )  ! PLinVelEU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEV )  ! PLinVelEV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEW )  ! PLinVelEW 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEY )  ! PLinVelEY 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEIMUt )  ! LinAccEIMUt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEOt )  ! LinAccEOt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccESt )  ! LinAccESt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccETt )  ! LinAccETt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEZt )  ! LinAccEZt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelEIMU )  ! LinVelEIMU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelEZ )  ! LinVelEZ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcONcRtt )  ! FrcONcRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcPRott )  ! FrcPRott 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcS0Bt )  ! FrcS0Bt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcT0Trbt )  ! FrcT0Trbt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSAero )  ! FSAero 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSTipDrag )  ! FSTipDrag 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FTHydrot )  ! FTHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FZHydrot )  ! FZHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MFHydrot )  ! MFHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomBNcRtt )  ! MomBNcRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomH0Bt )  ! MomH0Bt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomLPRott )  ! MomLPRott 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomNGnRtt )  ! MomNGnRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomNTailt )  ! MomNTailt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomX0Trbt )  ! MomX0Trbt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MMAero )  ! MMAero 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MXHydrot )  ! MXHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcONcRt )  ! PFrcONcRt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcPRot )  ! PFrcPRot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcS0B )  ! PFrcS0B 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcT0Trb )  ! PFrcT0Trb 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFTHydro )  ! PFTHydro 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFZHydro )  ! PFZHydro 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMFHydro )  ! PMFHydro 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomBNcRt )  ! PMomBNcRt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomH0B )  ! PMomH0B 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomLPRot )  ! PMomLPRot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomNGnRt )  ! PMomNGnRt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomNTail )  ! PMomNTail 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomX0Trb )  ! PMomX0Trb 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMXHydro )  ! PMXHydro 
  Re_BufSz   = Re_BufSz   + 1  ! TeetAng
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcVGnRtt )  ! FrcVGnRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcWTailt )  ! FrcWTailt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcZAllt )  ! FrcZAllt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomXAllt )  ! MomXAllt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcVGnRt )  ! PFrcVGnRt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcWTail )  ! PFrcWTail 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcZAll )  ! PFrcZAll 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMomXAll )  ! PMomXAll 
  Re_BufSz   = Re_BufSz   + 1  ! TeetMom
  Re_BufSz   = Re_BufSz   + 1  ! TFrlMom
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMom
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEffFac
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rO))-1 ) =  PACK(InData%rO ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rO)
  IF ( ALLOCATED(InData%rQS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rQS))-1 ) =  PACK(InData%rQS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rQS)
  ENDIF
  IF ( ALLOCATED(InData%rS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rS))-1 ) =  PACK(InData%rS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rS)
  ENDIF
  IF ( ALLOCATED(InData%rS0S) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rS0S))-1 ) =  PACK(InData%rS0S ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rS0S)
  ENDIF
  IF ( ALLOCATED(InData%rT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT))-1 ) =  PACK(InData%rT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rT)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT0O))-1 ) =  PACK(InData%rT0O ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rT0O)
  IF ( ALLOCATED(InData%rT0T) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT0T))-1 ) =  PACK(InData%rT0T ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rT0T)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZ))-1 ) =  PACK(InData%rZ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZO))-1 ) =  PACK(InData%rZO ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZO)
  IF ( ALLOCATED(InData%rZT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZT))-1 ) =  PACK(InData%rZT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rZT)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPQ))-1 ) =  PACK(InData%rPQ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rPQ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rP))-1 ) =  PACK(InData%rP ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rP)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rV))-1 ) =  PACK(InData%rV ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rV)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZY))-1 ) =  PACK(InData%rZY ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZY)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOU))-1 ) =  PACK(InData%rOU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOV))-1 ) =  PACK(InData%rOV ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOV)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVD))-1 ) =  PACK(InData%rVD ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVD)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOW))-1 ) =  PACK(InData%rOW ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOW)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPC))-1 ) =  PACK(InData%rPC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rPC)
  IF ( ALLOCATED(InData%rPS0) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPS0))-1 ) =  PACK(InData%rPS0 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rPS0)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rQC))-1 ) =  PACK(InData%rQC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rQC)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVIMU))-1 ) =  PACK(InData%rVIMU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVIMU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVP))-1 ) =  PACK(InData%rVP ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVP)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWI))-1 ) =  PACK(InData%rWI ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWI)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWJ))-1 ) =  PACK(InData%rWJ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWJ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWK))-1 ) =  PACK(InData%rWK ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWK)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZT0))-1 ) =  PACK(InData%rZT0 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZT0)
  IF ( ALLOCATED(InData%AngPosEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosEF))-1 ) =  PACK(InData%AngPosEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosEF)
  ENDIF
  IF ( ALLOCATED(InData%AngPosXF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosXF))-1 ) =  PACK(InData%AngPosXF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosXF)
  ENDIF
  IF ( ALLOCATED(InData%AngPosHM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosHM))-1 ) =  PACK(InData%AngPosHM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosHM)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosXB))-1 ) =  PACK(InData%AngPosXB ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosXB)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosEX))-1 ) =  PACK(InData%AngPosEX ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosEX)
  IF ( ALLOCATED(InData%PAngVelEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEA))-1 ) =  PACK(InData%PAngVelEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEA)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEF))-1 ) =  PACK(InData%PAngVelEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEF)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEG) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEG))-1 ) =  PACK(InData%PAngVelEG ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEG)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEH) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEH))-1 ) =  PACK(InData%PAngVelEH ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEH)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEL))-1 ) =  PACK(InData%PAngVelEL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEL)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEM))-1 ) =  PACK(InData%PAngVelEM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEM)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEN))-1 ) =  PACK(InData%PAngVelEN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEN)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEA))-1 ) =  PACK(InData%AngVelEA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEA)
  IF ( ALLOCATED(InData%PAngVelEB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEB))-1 ) =  PACK(InData%PAngVelEB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEB)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelER) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelER))-1 ) =  PACK(InData%PAngVelER ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelER)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEX))-1 ) =  PACK(InData%PAngVelEX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEX)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEG))-1 ) =  PACK(InData%AngVelEG ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEG)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEH))-1 ) =  PACK(InData%AngVelEH ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEH)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEL))-1 ) =  PACK(InData%AngVelEL ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEL)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEN))-1 ) =  PACK(InData%AngVelEN ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEN)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEB))-1 ) =  PACK(InData%AngVelEB ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEB)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelER))-1 ) =  PACK(InData%AngVelER ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelER)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEX))-1 ) =  PACK(InData%AngVelEX ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEX)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetAngVel )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEBt))-1 ) =  PACK(InData%AngAccEBt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEBt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccERt))-1 ) =  PACK(InData%AngAccERt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccERt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEXt))-1 ) =  PACK(InData%AngAccEXt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEXt)
  IF ( ALLOCATED(InData%AngAccEFt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEFt))-1 ) =  PACK(InData%AngAccEFt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEFt)
  ENDIF
  IF ( ALLOCATED(InData%AngVelEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEF))-1 ) =  PACK(InData%AngVelEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEAt))-1 ) =  PACK(InData%AngAccEAt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEAt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEGt))-1 ) =  PACK(InData%AngAccEGt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEGt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEHt))-1 ) =  PACK(InData%AngAccEHt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEHt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccENt))-1 ) =  PACK(InData%AngAccENt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccENt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccECt))-1 ) =  PACK(InData%LinAccECt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccECt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEDt))-1 ) =  PACK(InData%LinAccEDt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEDt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEIt))-1 ) =  PACK(InData%LinAccEIt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEIt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEJt))-1 ) =  PACK(InData%LinAccEJt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEJt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEUt))-1 ) =  PACK(InData%LinAccEUt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEUt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEYt))-1 ) =  PACK(InData%LinAccEYt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEYt)
  IF ( ALLOCATED(InData%LinVelES) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelES))-1 ) =  PACK(InData%LinVelES ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelES)
  ENDIF
  IF ( ALLOCATED(InData%LinVelET) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelET))-1 ) =  PACK(InData%LinVelET ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelET)
  ENDIF
  IF ( ALLOCATED(InData%LinVelESm2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelESm2))-1 ) =  PACK(InData%LinVelESm2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelESm2)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEIMU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEIMU))-1 ) =  PACK(InData%PLinVelEIMU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEIMU)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEO) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEO))-1 ) =  PACK(InData%PLinVelEO ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEO)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelES) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelES))-1 ) =  PACK(InData%PLinVelES ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelES)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelET) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelET))-1 ) =  PACK(InData%PLinVelET ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelET)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEZ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEZ))-1 ) =  PACK(InData%PLinVelEZ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEZ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEC))-1 ) =  PACK(InData%PLinVelEC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEC)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelED) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelED))-1 ) =  PACK(InData%PLinVelED ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelED)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEI) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEI))-1 ) =  PACK(InData%PLinVelEI ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEI)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEJ))-1 ) =  PACK(InData%PLinVelEJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEJ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEK) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEK))-1 ) =  PACK(InData%PLinVelEK ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEK)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEP))-1 ) =  PACK(InData%PLinVelEP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEP)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEQ))-1 ) =  PACK(InData%PLinVelEQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEQ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEU))-1 ) =  PACK(InData%PLinVelEU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEU)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEV))-1 ) =  PACK(InData%PLinVelEV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEV)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEW) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEW))-1 ) =  PACK(InData%PLinVelEW ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEW)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEY) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEY))-1 ) =  PACK(InData%PLinVelEY ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEY)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEIMUt))-1 ) =  PACK(InData%LinAccEIMUt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEIMUt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEOt))-1 ) =  PACK(InData%LinAccEOt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEOt)
  IF ( ALLOCATED(InData%LinAccESt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccESt))-1 ) =  PACK(InData%LinAccESt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccESt)
  ENDIF
  IF ( ALLOCATED(InData%LinAccETt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccETt))-1 ) =  PACK(InData%LinAccETt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccETt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEZt))-1 ) =  PACK(InData%LinAccEZt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEZt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelEIMU))-1 ) =  PACK(InData%LinVelEIMU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelEIMU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelEZ))-1 ) =  PACK(InData%LinVelEZ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelEZ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcONcRtt))-1 ) =  PACK(InData%FrcONcRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcONcRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcPRott))-1 ) =  PACK(InData%FrcPRott ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcPRott)
  IF ( ALLOCATED(InData%FrcS0Bt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcS0Bt))-1 ) =  PACK(InData%FrcS0Bt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FrcS0Bt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcT0Trbt))-1 ) =  PACK(InData%FrcT0Trbt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcT0Trbt)
  IF ( ALLOCATED(InData%FSAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSAero))-1 ) =  PACK(InData%FSAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSAero)
  ENDIF
  IF ( ALLOCATED(InData%FSTipDrag) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSTipDrag))-1 ) =  PACK(InData%FSTipDrag ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSTipDrag)
  ENDIF
  IF ( ALLOCATED(InData%FTHydrot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTHydrot))-1 ) =  PACK(InData%FTHydrot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTHydrot)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FZHydrot))-1 ) =  PACK(InData%FZHydrot ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FZHydrot)
  IF ( ALLOCATED(InData%MFHydrot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MFHydrot))-1 ) =  PACK(InData%MFHydrot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MFHydrot)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomBNcRtt))-1 ) =  PACK(InData%MomBNcRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomBNcRtt)
  IF ( ALLOCATED(InData%MomH0Bt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomH0Bt))-1 ) =  PACK(InData%MomH0Bt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MomH0Bt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomLPRott))-1 ) =  PACK(InData%MomLPRott ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomLPRott)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomNGnRtt))-1 ) =  PACK(InData%MomNGnRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomNGnRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomNTailt))-1 ) =  PACK(InData%MomNTailt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomNTailt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomX0Trbt))-1 ) =  PACK(InData%MomX0Trbt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomX0Trbt)
  IF ( ALLOCATED(InData%MMAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MMAero))-1 ) =  PACK(InData%MMAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MMAero)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MXHydrot))-1 ) =  PACK(InData%MXHydrot ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MXHydrot)
  IF ( ALLOCATED(InData%PFrcONcRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcONcRt))-1 ) =  PACK(InData%PFrcONcRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcONcRt)
  ENDIF
  IF ( ALLOCATED(InData%PFrcPRot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcPRot))-1 ) =  PACK(InData%PFrcPRot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcPRot)
  ENDIF
  IF ( ALLOCATED(InData%PFrcS0B) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcS0B))-1 ) =  PACK(InData%PFrcS0B ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcS0B)
  ENDIF
  IF ( ALLOCATED(InData%PFrcT0Trb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcT0Trb))-1 ) =  PACK(InData%PFrcT0Trb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcT0Trb)
  ENDIF
  IF ( ALLOCATED(InData%PFTHydro) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFTHydro))-1 ) =  PACK(InData%PFTHydro ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFTHydro)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFZHydro))-1 ) =  PACK(InData%PFZHydro ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PFZHydro)
  IF ( ALLOCATED(InData%PMFHydro) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMFHydro))-1 ) =  PACK(InData%PMFHydro ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMFHydro)
  ENDIF
  IF ( ALLOCATED(InData%PMomBNcRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomBNcRt))-1 ) =  PACK(InData%PMomBNcRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomBNcRt)
  ENDIF
  IF ( ALLOCATED(InData%PMomH0B) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomH0B))-1 ) =  PACK(InData%PMomH0B ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomH0B)
  ENDIF
  IF ( ALLOCATED(InData%PMomLPRot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomLPRot))-1 ) =  PACK(InData%PMomLPRot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomLPRot)
  ENDIF
  IF ( ALLOCATED(InData%PMomNGnRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomNGnRt))-1 ) =  PACK(InData%PMomNGnRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomNGnRt)
  ENDIF
  IF ( ALLOCATED(InData%PMomNTail) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomNTail))-1 ) =  PACK(InData%PMomNTail ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomNTail)
  ENDIF
  IF ( ALLOCATED(InData%PMomX0Trb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomX0Trb))-1 ) =  PACK(InData%PMomX0Trb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomX0Trb)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMXHydro))-1 ) =  PACK(InData%PMXHydro ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PMXHydro)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetAng )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcVGnRtt))-1 ) =  PACK(InData%FrcVGnRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcVGnRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcWTailt))-1 ) =  PACK(InData%FrcWTailt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcWTailt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcZAllt))-1 ) =  PACK(InData%FrcZAllt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcZAllt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomXAllt))-1 ) =  PACK(InData%MomXAllt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomXAllt)
  IF ( ALLOCATED(InData%PFrcVGnRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcVGnRt))-1 ) =  PACK(InData%PFrcVGnRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcVGnRt)
  ENDIF
  IF ( ALLOCATED(InData%PFrcWTail) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcWTail))-1 ) =  PACK(InData%PFrcWTail ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcWTail)
  ENDIF
  IF ( ALLOCATED(InData%PFrcZAll) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcZAll))-1 ) =  PACK(InData%PFrcZAll ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcZAll)
  ENDIF
  IF ( ALLOCATED(InData%PMomXAll) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomXAll))-1 ) =  PACK(InData%PMomXAll ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomXAll)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEffFac )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_Packrthndside

 SUBROUTINE ED_UnPackrthndside( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ed_rthndside), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%rO,1))); mask1 = .TRUE.
  OutData%rO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rO))-1 ),mask1,OutData%rO)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rO)
  IF ( ALLOCATED(OutData%rQS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rQS,1),SIZE(OutData%rQS,2),SIZE(OutData%rQS,3))); mask3 = .TRUE.
    OutData%rQS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rQS))-1 ),mask3,OutData%rQS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rQS)
  ENDIF
  IF ( ALLOCATED(OutData%rS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rS,1),SIZE(OutData%rS,2),SIZE(OutData%rS,3))); mask3 = .TRUE.
    OutData%rS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rS))-1 ),mask3,OutData%rS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rS)
  ENDIF
  IF ( ALLOCATED(OutData%rS0S) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rS0S,1),SIZE(OutData%rS0S,2),SIZE(OutData%rS0S,3))); mask3 = .TRUE.
    OutData%rS0S = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rS0S))-1 ),mask3,OutData%rS0S)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rS0S)
  ENDIF
  IF ( ALLOCATED(OutData%rT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rT,1),SIZE(OutData%rT,2))); mask2 = .TRUE.
    OutData%rT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT))-1 ),mask2,OutData%rT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rT)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rT0O,1))); mask1 = .TRUE.
  OutData%rT0O = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT0O))-1 ),mask1,OutData%rT0O)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rT0O)
  IF ( ALLOCATED(OutData%rT0T) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rT0T,1),SIZE(OutData%rT0T,2))); mask2 = .TRUE.
    OutData%rT0T = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT0T))-1 ),mask2,OutData%rT0T)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rT0T)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rZ,1))); mask1 = .TRUE.
  OutData%rZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZ))-1 ),mask1,OutData%rZ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZ)
  ALLOCATE(mask1(SIZE(OutData%rZO,1))); mask1 = .TRUE.
  OutData%rZO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZO))-1 ),mask1,OutData%rZO)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZO)
  IF ( ALLOCATED(OutData%rZT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rZT,1),SIZE(OutData%rZT,2))); mask2 = .TRUE.
    OutData%rZT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZT))-1 ),mask2,OutData%rZT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rZT)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rPQ,1))); mask1 = .TRUE.
  OutData%rPQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPQ))-1 ),mask1,OutData%rPQ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rPQ)
  ALLOCATE(mask1(SIZE(OutData%rP,1))); mask1 = .TRUE.
  OutData%rP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rP))-1 ),mask1,OutData%rP)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rP)
  ALLOCATE(mask1(SIZE(OutData%rV,1))); mask1 = .TRUE.
  OutData%rV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rV))-1 ),mask1,OutData%rV)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rV)
  ALLOCATE(mask1(SIZE(OutData%rZY,1))); mask1 = .TRUE.
  OutData%rZY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZY))-1 ),mask1,OutData%rZY)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZY)
  ALLOCATE(mask1(SIZE(OutData%rOU,1))); mask1 = .TRUE.
  OutData%rOU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOU))-1 ),mask1,OutData%rOU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOU)
  ALLOCATE(mask1(SIZE(OutData%rOV,1))); mask1 = .TRUE.
  OutData%rOV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOV))-1 ),mask1,OutData%rOV)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOV)
  ALLOCATE(mask1(SIZE(OutData%rVD,1))); mask1 = .TRUE.
  OutData%rVD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVD))-1 ),mask1,OutData%rVD)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVD)
  ALLOCATE(mask1(SIZE(OutData%rOW,1))); mask1 = .TRUE.
  OutData%rOW = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOW))-1 ),mask1,OutData%rOW)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOW)
  ALLOCATE(mask1(SIZE(OutData%rPC,1))); mask1 = .TRUE.
  OutData%rPC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPC))-1 ),mask1,OutData%rPC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rPC)
  IF ( ALLOCATED(OutData%rPS0) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rPS0,1),SIZE(OutData%rPS0,2))); mask2 = .TRUE.
    OutData%rPS0 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPS0))-1 ),mask2,OutData%rPS0)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rPS0)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rQC,1))); mask1 = .TRUE.
  OutData%rQC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rQC))-1 ),mask1,OutData%rQC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rQC)
  ALLOCATE(mask1(SIZE(OutData%rVIMU,1))); mask1 = .TRUE.
  OutData%rVIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVIMU))-1 ),mask1,OutData%rVIMU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVIMU)
  ALLOCATE(mask1(SIZE(OutData%rVP,1))); mask1 = .TRUE.
  OutData%rVP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVP))-1 ),mask1,OutData%rVP)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVP)
  ALLOCATE(mask1(SIZE(OutData%rWI,1))); mask1 = .TRUE.
  OutData%rWI = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWI))-1 ),mask1,OutData%rWI)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWI)
  ALLOCATE(mask1(SIZE(OutData%rWJ,1))); mask1 = .TRUE.
  OutData%rWJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWJ))-1 ),mask1,OutData%rWJ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWJ)
  ALLOCATE(mask1(SIZE(OutData%rWK,1))); mask1 = .TRUE.
  OutData%rWK = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWK))-1 ),mask1,OutData%rWK)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWK)
  ALLOCATE(mask1(SIZE(OutData%rZT0,1))); mask1 = .TRUE.
  OutData%rZT0 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZT0))-1 ),mask1,OutData%rZT0)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZT0)
  IF ( ALLOCATED(OutData%AngPosEF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngPosEF,1),SIZE(OutData%AngPosEF,2))); mask2 = .TRUE.
    OutData%AngPosEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosEF))-1 ),mask2,OutData%AngPosEF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosEF)
  ENDIF
  IF ( ALLOCATED(OutData%AngPosXF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngPosXF,1),SIZE(OutData%AngPosXF,2))); mask2 = .TRUE.
    OutData%AngPosXF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosXF))-1 ),mask2,OutData%AngPosXF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosXF)
  ENDIF
  IF ( ALLOCATED(OutData%AngPosHM) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AngPosHM,1),SIZE(OutData%AngPosHM,2),SIZE(OutData%AngPosHM,3))); mask3 = .TRUE.
    OutData%AngPosHM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosHM))-1 ),mask3,OutData%AngPosHM)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosHM)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngPosXB,1))); mask1 = .TRUE.
  OutData%AngPosXB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosXB))-1 ),mask1,OutData%AngPosXB)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosXB)
  ALLOCATE(mask1(SIZE(OutData%AngPosEX,1))); mask1 = .TRUE.
  OutData%AngPosEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosEX))-1 ),mask1,OutData%AngPosEX)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosEX)
  IF ( ALLOCATED(OutData%PAngVelEA) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEA,1),SIZE(OutData%PAngVelEA,2),SIZE(OutData%PAngVelEA,3))); mask3 = .TRUE.
    OutData%PAngVelEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEA))-1 ),mask3,OutData%PAngVelEA)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEA)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEF) ) THEN
  ALLOCATE(mask4(SIZE(OutData%PAngVelEF,1),SIZE(OutData%PAngVelEF,2),SIZE(OutData%PAngVelEF,3),SIZE(OutData%PAngVelEF,4))); mask4 = .TRUE.
    OutData%PAngVelEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEF))-1 ),mask4,OutData%PAngVelEF)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEF)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEG) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEG,1),SIZE(OutData%PAngVelEG,2),SIZE(OutData%PAngVelEG,3))); mask3 = .TRUE.
    OutData%PAngVelEG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEG))-1 ),mask3,OutData%PAngVelEG)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEG)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEH) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEH,1),SIZE(OutData%PAngVelEH,2),SIZE(OutData%PAngVelEH,3))); mask3 = .TRUE.
    OutData%PAngVelEH = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEH))-1 ),mask3,OutData%PAngVelEH)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEH)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEL) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEL,1),SIZE(OutData%PAngVelEL,2),SIZE(OutData%PAngVelEL,3))); mask3 = .TRUE.
    OutData%PAngVelEL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEL))-1 ),mask3,OutData%PAngVelEL)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEL)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEM) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PAngVelEM,1),SIZE(OutData%PAngVelEM,2),SIZE(OutData%PAngVelEM,3),SIZE(OutData%PAngVelEM,4),SIZE(OutData%PAngVelEM,5))); mask5 = .TRUE.
    OutData%PAngVelEM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEM))-1 ),mask5,OutData%PAngVelEM)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEM)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEN) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEN,1),SIZE(OutData%PAngVelEN,2),SIZE(OutData%PAngVelEN,3))); mask3 = .TRUE.
    OutData%PAngVelEN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEN))-1 ),mask3,OutData%PAngVelEN)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEN)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngVelEA,1))); mask1 = .TRUE.
  OutData%AngVelEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEA))-1 ),mask1,OutData%AngVelEA)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEA)
  IF ( ALLOCATED(OutData%PAngVelEB) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEB,1),SIZE(OutData%PAngVelEB,2),SIZE(OutData%PAngVelEB,3))); mask3 = .TRUE.
    OutData%PAngVelEB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEB))-1 ),mask3,OutData%PAngVelEB)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEB)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelER) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelER,1),SIZE(OutData%PAngVelER,2),SIZE(OutData%PAngVelER,3))); mask3 = .TRUE.
    OutData%PAngVelER = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelER))-1 ),mask3,OutData%PAngVelER)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelER)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEX) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEX,1),SIZE(OutData%PAngVelEX,2),SIZE(OutData%PAngVelEX,3))); mask3 = .TRUE.
    OutData%PAngVelEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEX))-1 ),mask3,OutData%PAngVelEX)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEX)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngVelEG,1))); mask1 = .TRUE.
  OutData%AngVelEG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEG))-1 ),mask1,OutData%AngVelEG)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEG)
  ALLOCATE(mask1(SIZE(OutData%AngVelEH,1))); mask1 = .TRUE.
  OutData%AngVelEH = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEH))-1 ),mask1,OutData%AngVelEH)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEH)
  ALLOCATE(mask1(SIZE(OutData%AngVelEL,1))); mask1 = .TRUE.
  OutData%AngVelEL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEL))-1 ),mask1,OutData%AngVelEL)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEL)
  ALLOCATE(mask1(SIZE(OutData%AngVelEN,1))); mask1 = .TRUE.
  OutData%AngVelEN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEN))-1 ),mask1,OutData%AngVelEN)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEN)
  ALLOCATE(mask1(SIZE(OutData%AngVelEB,1))); mask1 = .TRUE.
  OutData%AngVelEB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEB))-1 ),mask1,OutData%AngVelEB)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEB)
  ALLOCATE(mask1(SIZE(OutData%AngVelER,1))); mask1 = .TRUE.
  OutData%AngVelER = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelER))-1 ),mask1,OutData%AngVelER)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelER)
  ALLOCATE(mask1(SIZE(OutData%AngVelEX,1))); mask1 = .TRUE.
  OutData%AngVelEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEX))-1 ),mask1,OutData%AngVelEX)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEX)
  OutData%TeetAngVel = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%AngAccEBt,1))); mask1 = .TRUE.
  OutData%AngAccEBt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEBt))-1 ),mask1,OutData%AngAccEBt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEBt)
  ALLOCATE(mask1(SIZE(OutData%AngAccERt,1))); mask1 = .TRUE.
  OutData%AngAccERt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccERt))-1 ),mask1,OutData%AngAccERt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccERt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEXt,1))); mask1 = .TRUE.
  OutData%AngAccEXt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEXt))-1 ),mask1,OutData%AngAccEXt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEXt)
  IF ( ALLOCATED(OutData%AngAccEFt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngAccEFt,1),SIZE(OutData%AngAccEFt,2))); mask2 = .TRUE.
    OutData%AngAccEFt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEFt))-1 ),mask2,OutData%AngAccEFt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEFt)
  ENDIF
  IF ( ALLOCATED(OutData%AngVelEF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngVelEF,1),SIZE(OutData%AngVelEF,2))); mask2 = .TRUE.
    OutData%AngVelEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEF))-1 ),mask2,OutData%AngVelEF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEF)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngAccEAt,1))); mask1 = .TRUE.
  OutData%AngAccEAt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEAt))-1 ),mask1,OutData%AngAccEAt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEAt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEGt,1))); mask1 = .TRUE.
  OutData%AngAccEGt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEGt))-1 ),mask1,OutData%AngAccEGt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEGt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEHt,1))); mask1 = .TRUE.
  OutData%AngAccEHt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEHt))-1 ),mask1,OutData%AngAccEHt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEHt)
  ALLOCATE(mask1(SIZE(OutData%AngAccENt,1))); mask1 = .TRUE.
  OutData%AngAccENt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccENt))-1 ),mask1,OutData%AngAccENt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccENt)
  ALLOCATE(mask1(SIZE(OutData%LinAccECt,1))); mask1 = .TRUE.
  OutData%LinAccECt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccECt))-1 ),mask1,OutData%LinAccECt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccECt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEDt,1))); mask1 = .TRUE.
  OutData%LinAccEDt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEDt))-1 ),mask1,OutData%LinAccEDt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEDt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEIt,1))); mask1 = .TRUE.
  OutData%LinAccEIt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEIt))-1 ),mask1,OutData%LinAccEIt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEIt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEJt,1))); mask1 = .TRUE.
  OutData%LinAccEJt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEJt))-1 ),mask1,OutData%LinAccEJt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEJt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEUt,1))); mask1 = .TRUE.
  OutData%LinAccEUt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEUt))-1 ),mask1,OutData%LinAccEUt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEUt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEYt,1))); mask1 = .TRUE.
  OutData%LinAccEYt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEYt))-1 ),mask1,OutData%LinAccEYt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEYt)
  IF ( ALLOCATED(OutData%LinVelES) ) THEN
  ALLOCATE(mask3(SIZE(OutData%LinVelES,1),SIZE(OutData%LinVelES,2),SIZE(OutData%LinVelES,3))); mask3 = .TRUE.
    OutData%LinVelES = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelES))-1 ),mask3,OutData%LinVelES)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelES)
  ENDIF
  IF ( ALLOCATED(OutData%LinVelET) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LinVelET,1),SIZE(OutData%LinVelET,2))); mask2 = .TRUE.
    OutData%LinVelET = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelET))-1 ),mask2,OutData%LinVelET)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelET)
  ENDIF
  IF ( ALLOCATED(OutData%LinVelESm2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%LinVelESm2,1))); mask1 = .TRUE.
    OutData%LinVelESm2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelESm2))-1 ),mask1,OutData%LinVelESm2)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelESm2)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEIMU) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEIMU,1),SIZE(OutData%PLinVelEIMU,2),SIZE(OutData%PLinVelEIMU,3))); mask3 = .TRUE.
    OutData%PLinVelEIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEIMU))-1 ),mask3,OutData%PLinVelEIMU)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEIMU)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEO) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEO,1),SIZE(OutData%PLinVelEO,2),SIZE(OutData%PLinVelEO,3))); mask3 = .TRUE.
    OutData%PLinVelEO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEO))-1 ),mask3,OutData%PLinVelEO)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEO)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelES) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PLinVelES,1),SIZE(OutData%PLinVelES,2),SIZE(OutData%PLinVelES,3),SIZE(OutData%PLinVelES,4),SIZE(OutData%PLinVelES,5))); mask5 = .TRUE.
    OutData%PLinVelES = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelES))-1 ),mask5,OutData%PLinVelES)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelES)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelET) ) THEN
  ALLOCATE(mask4(SIZE(OutData%PLinVelET,1),SIZE(OutData%PLinVelET,2),SIZE(OutData%PLinVelET,3),SIZE(OutData%PLinVelET,4))); mask4 = .TRUE.
    OutData%PLinVelET = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelET))-1 ),mask4,OutData%PLinVelET)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelET)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEZ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEZ,1),SIZE(OutData%PLinVelEZ,2),SIZE(OutData%PLinVelEZ,3))); mask3 = .TRUE.
    OutData%PLinVelEZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEZ))-1 ),mask3,OutData%PLinVelEZ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEZ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEC) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEC,1),SIZE(OutData%PLinVelEC,2),SIZE(OutData%PLinVelEC,3))); mask3 = .TRUE.
    OutData%PLinVelEC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEC))-1 ),mask3,OutData%PLinVelEC)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEC)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelED) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelED,1),SIZE(OutData%PLinVelED,2),SIZE(OutData%PLinVelED,3))); mask3 = .TRUE.
    OutData%PLinVelED = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelED))-1 ),mask3,OutData%PLinVelED)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelED)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEI) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEI,1),SIZE(OutData%PLinVelEI,2),SIZE(OutData%PLinVelEI,3))); mask3 = .TRUE.
    OutData%PLinVelEI = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEI))-1 ),mask3,OutData%PLinVelEI)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEI)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEJ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEJ,1),SIZE(OutData%PLinVelEJ,2),SIZE(OutData%PLinVelEJ,3))); mask3 = .TRUE.
    OutData%PLinVelEJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEJ))-1 ),mask3,OutData%PLinVelEJ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEJ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEK) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEK,1),SIZE(OutData%PLinVelEK,2),SIZE(OutData%PLinVelEK,3))); mask3 = .TRUE.
    OutData%PLinVelEK = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEK))-1 ),mask3,OutData%PLinVelEK)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEK)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEP) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEP,1),SIZE(OutData%PLinVelEP,2),SIZE(OutData%PLinVelEP,3))); mask3 = .TRUE.
    OutData%PLinVelEP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEP))-1 ),mask3,OutData%PLinVelEP)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEP)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEQ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEQ,1),SIZE(OutData%PLinVelEQ,2),SIZE(OutData%PLinVelEQ,3))); mask3 = .TRUE.
    OutData%PLinVelEQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEQ))-1 ),mask3,OutData%PLinVelEQ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEQ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEU) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEU,1),SIZE(OutData%PLinVelEU,2),SIZE(OutData%PLinVelEU,3))); mask3 = .TRUE.
    OutData%PLinVelEU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEU))-1 ),mask3,OutData%PLinVelEU)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEU)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEV) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEV,1),SIZE(OutData%PLinVelEV,2),SIZE(OutData%PLinVelEV,3))); mask3 = .TRUE.
    OutData%PLinVelEV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEV))-1 ),mask3,OutData%PLinVelEV)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEV)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEW) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEW,1),SIZE(OutData%PLinVelEW,2),SIZE(OutData%PLinVelEW,3))); mask3 = .TRUE.
    OutData%PLinVelEW = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEW))-1 ),mask3,OutData%PLinVelEW)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEW)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEY) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEY,1),SIZE(OutData%PLinVelEY,2),SIZE(OutData%PLinVelEY,3))); mask3 = .TRUE.
    OutData%PLinVelEY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEY))-1 ),mask3,OutData%PLinVelEY)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEY)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%LinAccEIMUt,1))); mask1 = .TRUE.
  OutData%LinAccEIMUt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEIMUt))-1 ),mask1,OutData%LinAccEIMUt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEIMUt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEOt,1))); mask1 = .TRUE.
  OutData%LinAccEOt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEOt))-1 ),mask1,OutData%LinAccEOt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEOt)
  IF ( ALLOCATED(OutData%LinAccESt) ) THEN
  ALLOCATE(mask3(SIZE(OutData%LinAccESt,1),SIZE(OutData%LinAccESt,2),SIZE(OutData%LinAccESt,3))); mask3 = .TRUE.
    OutData%LinAccESt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccESt))-1 ),mask3,OutData%LinAccESt)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccESt)
  ENDIF
  IF ( ALLOCATED(OutData%LinAccETt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LinAccETt,1),SIZE(OutData%LinAccETt,2))); mask2 = .TRUE.
    OutData%LinAccETt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccETt))-1 ),mask2,OutData%LinAccETt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccETt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%LinAccEZt,1))); mask1 = .TRUE.
  OutData%LinAccEZt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEZt))-1 ),mask1,OutData%LinAccEZt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEZt)
  ALLOCATE(mask1(SIZE(OutData%LinVelEIMU,1))); mask1 = .TRUE.
  OutData%LinVelEIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelEIMU))-1 ),mask1,OutData%LinVelEIMU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelEIMU)
  ALLOCATE(mask1(SIZE(OutData%LinVelEZ,1))); mask1 = .TRUE.
  OutData%LinVelEZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelEZ))-1 ),mask1,OutData%LinVelEZ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelEZ)
  ALLOCATE(mask1(SIZE(OutData%FrcONcRtt,1))); mask1 = .TRUE.
  OutData%FrcONcRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcONcRtt))-1 ),mask1,OutData%FrcONcRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcONcRtt)
  ALLOCATE(mask1(SIZE(OutData%FrcPRott,1))); mask1 = .TRUE.
  OutData%FrcPRott = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcPRott))-1 ),mask1,OutData%FrcPRott)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcPRott)
  IF ( ALLOCATED(OutData%FrcS0Bt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FrcS0Bt,1),SIZE(OutData%FrcS0Bt,2))); mask2 = .TRUE.
    OutData%FrcS0Bt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcS0Bt))-1 ),mask2,OutData%FrcS0Bt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcS0Bt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%FrcT0Trbt,1))); mask1 = .TRUE.
  OutData%FrcT0Trbt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcT0Trbt))-1 ),mask1,OutData%FrcT0Trbt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcT0Trbt)
  IF ( ALLOCATED(OutData%FSAero) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FSAero,1),SIZE(OutData%FSAero,2),SIZE(OutData%FSAero,3))); mask3 = .TRUE.
    OutData%FSAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSAero))-1 ),mask3,OutData%FSAero)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSAero)
  ENDIF
  IF ( ALLOCATED(OutData%FSTipDrag) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSTipDrag,1),SIZE(OutData%FSTipDrag,2))); mask2 = .TRUE.
    OutData%FSTipDrag = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSTipDrag))-1 ),mask2,OutData%FSTipDrag)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSTipDrag)
  ENDIF
  IF ( ALLOCATED(OutData%FTHydrot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FTHydrot,1),SIZE(OutData%FTHydrot,2))); mask2 = .TRUE.
    OutData%FTHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTHydrot))-1 ),mask2,OutData%FTHydrot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTHydrot)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%FZHydrot,1))); mask1 = .TRUE.
  OutData%FZHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FZHydrot))-1 ),mask1,OutData%FZHydrot)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FZHydrot)
  IF ( ALLOCATED(OutData%MFHydrot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MFHydrot,1),SIZE(OutData%MFHydrot,2))); mask2 = .TRUE.
    OutData%MFHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MFHydrot))-1 ),mask2,OutData%MFHydrot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MFHydrot)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MomBNcRtt,1))); mask1 = .TRUE.
  OutData%MomBNcRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomBNcRtt))-1 ),mask1,OutData%MomBNcRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomBNcRtt)
  IF ( ALLOCATED(OutData%MomH0Bt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MomH0Bt,1),SIZE(OutData%MomH0Bt,2))); mask2 = .TRUE.
    OutData%MomH0Bt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomH0Bt))-1 ),mask2,OutData%MomH0Bt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MomH0Bt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MomLPRott,1))); mask1 = .TRUE.
  OutData%MomLPRott = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomLPRott))-1 ),mask1,OutData%MomLPRott)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomLPRott)
  ALLOCATE(mask1(SIZE(OutData%MomNGnRtt,1))); mask1 = .TRUE.
  OutData%MomNGnRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomNGnRtt))-1 ),mask1,OutData%MomNGnRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomNGnRtt)
  ALLOCATE(mask1(SIZE(OutData%MomNTailt,1))); mask1 = .TRUE.
  OutData%MomNTailt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomNTailt))-1 ),mask1,OutData%MomNTailt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomNTailt)
  ALLOCATE(mask1(SIZE(OutData%MomX0Trbt,1))); mask1 = .TRUE.
  OutData%MomX0Trbt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomX0Trbt))-1 ),mask1,OutData%MomX0Trbt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomX0Trbt)
  IF ( ALLOCATED(OutData%MMAero) ) THEN
  ALLOCATE(mask3(SIZE(OutData%MMAero,1),SIZE(OutData%MMAero,2),SIZE(OutData%MMAero,3))); mask3 = .TRUE.
    OutData%MMAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MMAero))-1 ),mask3,OutData%MMAero)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MMAero)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MXHydrot,1))); mask1 = .TRUE.
  OutData%MXHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MXHydrot))-1 ),mask1,OutData%MXHydrot)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MXHydrot)
  IF ( ALLOCATED(OutData%PFrcONcRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcONcRt,1),SIZE(OutData%PFrcONcRt,2))); mask2 = .TRUE.
    OutData%PFrcONcRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcONcRt))-1 ),mask2,OutData%PFrcONcRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcONcRt)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcPRot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcPRot,1),SIZE(OutData%PFrcPRot,2))); mask2 = .TRUE.
    OutData%PFrcPRot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcPRot))-1 ),mask2,OutData%PFrcPRot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcPRot)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcS0B) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PFrcS0B,1),SIZE(OutData%PFrcS0B,2),SIZE(OutData%PFrcS0B,3))); mask3 = .TRUE.
    OutData%PFrcS0B = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcS0B))-1 ),mask3,OutData%PFrcS0B)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcS0B)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcT0Trb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcT0Trb,1),SIZE(OutData%PFrcT0Trb,2))); mask2 = .TRUE.
    OutData%PFrcT0Trb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcT0Trb))-1 ),mask2,OutData%PFrcT0Trb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcT0Trb)
  ENDIF
  IF ( ALLOCATED(OutData%PFTHydro) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PFTHydro,1),SIZE(OutData%PFTHydro,2),SIZE(OutData%PFTHydro,3))); mask3 = .TRUE.
    OutData%PFTHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFTHydro))-1 ),mask3,OutData%PFTHydro)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFTHydro)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PFZHydro,1),SIZE(OutData%PFZHydro,2))); mask2 = .TRUE.
  OutData%PFZHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFZHydro))-1 ),mask2,OutData%PFZHydro)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PFZHydro)
  IF ( ALLOCATED(OutData%PMFHydro) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PMFHydro,1),SIZE(OutData%PMFHydro,2),SIZE(OutData%PMFHydro,3))); mask3 = .TRUE.
    OutData%PMFHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMFHydro))-1 ),mask3,OutData%PMFHydro)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMFHydro)
  ENDIF
  IF ( ALLOCATED(OutData%PMomBNcRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomBNcRt,1),SIZE(OutData%PMomBNcRt,2))); mask2 = .TRUE.
    OutData%PMomBNcRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomBNcRt))-1 ),mask2,OutData%PMomBNcRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomBNcRt)
  ENDIF
  IF ( ALLOCATED(OutData%PMomH0B) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PMomH0B,1),SIZE(OutData%PMomH0B,2),SIZE(OutData%PMomH0B,3))); mask3 = .TRUE.
    OutData%PMomH0B = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomH0B))-1 ),mask3,OutData%PMomH0B)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomH0B)
  ENDIF
  IF ( ALLOCATED(OutData%PMomLPRot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomLPRot,1),SIZE(OutData%PMomLPRot,2))); mask2 = .TRUE.
    OutData%PMomLPRot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomLPRot))-1 ),mask2,OutData%PMomLPRot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomLPRot)
  ENDIF
  IF ( ALLOCATED(OutData%PMomNGnRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomNGnRt,1),SIZE(OutData%PMomNGnRt,2))); mask2 = .TRUE.
    OutData%PMomNGnRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomNGnRt))-1 ),mask2,OutData%PMomNGnRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomNGnRt)
  ENDIF
  IF ( ALLOCATED(OutData%PMomNTail) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomNTail,1),SIZE(OutData%PMomNTail,2))); mask2 = .TRUE.
    OutData%PMomNTail = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomNTail))-1 ),mask2,OutData%PMomNTail)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomNTail)
  ENDIF
  IF ( ALLOCATED(OutData%PMomX0Trb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomX0Trb,1),SIZE(OutData%PMomX0Trb,2))); mask2 = .TRUE.
    OutData%PMomX0Trb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomX0Trb))-1 ),mask2,OutData%PMomX0Trb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomX0Trb)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PMXHydro,1),SIZE(OutData%PMXHydro,2))); mask2 = .TRUE.
  OutData%PMXHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMXHydro))-1 ),mask2,OutData%PMXHydro)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PMXHydro)
  OutData%TeetAng = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%FrcVGnRtt,1))); mask1 = .TRUE.
  OutData%FrcVGnRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcVGnRtt))-1 ),mask1,OutData%FrcVGnRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcVGnRtt)
  ALLOCATE(mask1(SIZE(OutData%FrcWTailt,1))); mask1 = .TRUE.
  OutData%FrcWTailt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcWTailt))-1 ),mask1,OutData%FrcWTailt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcWTailt)
  ALLOCATE(mask1(SIZE(OutData%FrcZAllt,1))); mask1 = .TRUE.
  OutData%FrcZAllt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcZAllt))-1 ),mask1,OutData%FrcZAllt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcZAllt)
  ALLOCATE(mask1(SIZE(OutData%MomXAllt,1))); mask1 = .TRUE.
  OutData%MomXAllt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomXAllt))-1 ),mask1,OutData%MomXAllt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomXAllt)
  IF ( ALLOCATED(OutData%PFrcVGnRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcVGnRt,1),SIZE(OutData%PFrcVGnRt,2))); mask2 = .TRUE.
    OutData%PFrcVGnRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcVGnRt))-1 ),mask2,OutData%PFrcVGnRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcVGnRt)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcWTail) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcWTail,1),SIZE(OutData%PFrcWTail,2))); mask2 = .TRUE.
    OutData%PFrcWTail = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcWTail))-1 ),mask2,OutData%PFrcWTail)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcWTail)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcZAll) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcZAll,1),SIZE(OutData%PFrcZAll,2))); mask2 = .TRUE.
    OutData%PFrcZAll = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcZAll))-1 ),mask2,OutData%PFrcZAll)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcZAll)
  ENDIF
  IF ( ALLOCATED(OutData%PMomXAll) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomXAll,1),SIZE(OutData%PMomXAll,2))); mask2 = .TRUE.
    OutData%PMomXAll = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomXAll))-1 ),mask2,OutData%PMomXAll)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomXAll)
  ENDIF
  OutData%TeetMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEffFac = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackrthndside

 SUBROUTINE ED_CopyInitInput( SrcInitInputData, DstInitInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_initinputtype), INTENT(INOUT) :: SrcInitInputData
   TYPE(ED_initinputtype), INTENT(INOUT) :: DstInitInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInitInputData%InputFile = SrcInitInputData%InputFile
   DstInitInputData%ADInputFile = SrcInitInputData%ADInputFile
   DstInitInputData%RootName = SrcInitInputData%RootName
 END SUBROUTINE ED_CopyInitInput

 SUBROUTINE ED_DestroyInitInput( InitInputData, ErrStat, ErrMsg )
  TYPE(ED_initinputtype), INTENT(INOUT) :: InitInputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyInitInput

 SUBROUTINE ED_PackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_initinputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
 END SUBROUTINE ED_PackInitInput

 SUBROUTINE ED_UnPackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_initinputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInitInput

 SUBROUTINE ED_CopyInitOutput( SrcInitOutputData, DstInitOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_initoutputtype), INTENT(INOUT) :: SrcInitOutputData
   TYPE(ED_initoutputtype), INTENT(INOUT) :: DstInitOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInitOutputData%WriteOutputHdr)) THEN
   i1_l = LBOUND(SrcInitOutputData%WriteOutputHdr,1)
   i1_u = UBOUND(SrcInitOutputData%WriteOutputHdr,1)
   IF (.NOT.ALLOCATED(DstInitOutputData%WriteOutputHdr)) THEN 
      ALLOCATE(DstInitOutputData%WriteOutputHdr(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInitOutput: Error allocating DstInitOutputData%WriteOutputHdr.'
         RETURN
      END IF
   END IF
   DstInitOutputData%WriteOutputHdr = SrcInitOutputData%WriteOutputHdr
ENDIF
IF (ALLOCATED(SrcInitOutputData%WriteOutputUnt)) THEN
   i1_l = LBOUND(SrcInitOutputData%WriteOutputUnt,1)
   i1_u = UBOUND(SrcInitOutputData%WriteOutputUnt,1)
   IF (.NOT.ALLOCATED(DstInitOutputData%WriteOutputUnt)) THEN 
      ALLOCATE(DstInitOutputData%WriteOutputUnt(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInitOutput: Error allocating DstInitOutputData%WriteOutputUnt.'
         RETURN
      END IF
   END IF
   DstInitOutputData%WriteOutputUnt = SrcInitOutputData%WriteOutputUnt
ENDIF
      CALL NWTC_Library_Copyprogdesc( SrcInitOutputData%Ver, DstInitOutputData%Ver, CtrlCode, ErrStat, ErrMsg )
   DstInitOutputData%NumBl = SrcInitOutputData%NumBl
   DstInitOutputData%Gravity = SrcInitOutputData%Gravity
IF (ALLOCATED(SrcInitOutputData%BlPitch)) THEN
   i1_l = LBOUND(SrcInitOutputData%BlPitch,1)
   i1_u = UBOUND(SrcInitOutputData%BlPitch,1)
   IF (.NOT.ALLOCATED(DstInitOutputData%BlPitch)) THEN 
      ALLOCATE(DstInitOutputData%BlPitch(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInitOutput: Error allocating DstInitOutputData%BlPitch.'
         RETURN
      END IF
   END IF
   DstInitOutputData%BlPitch = SrcInitOutputData%BlPitch
ENDIF
 END SUBROUTINE ED_CopyInitOutput

 SUBROUTINE ED_DestroyInitOutput( InitOutputData, ErrStat, ErrMsg )
  TYPE(ED_initoutputtype), INTENT(INOUT) :: InitOutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(InitOutputData%WriteOutputHdr) ) DEALLOCATE(InitOutputData%WriteOutputHdr)
  IF ( ALLOCATED(InitOutputData%WriteOutputUnt) ) DEALLOCATE(InitOutputData%WriteOutputUnt)
  CALL NWTC_Library_Destroyprogdesc( InitOutputData%Ver, ErrStat, ErrMsg )
  IF ( ALLOCATED(InitOutputData%BlPitch) ) DEALLOCATE(InitOutputData%BlPitch)
 END SUBROUTINE ED_DestroyInitOutput

 SUBROUTINE ED_PackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_initoutputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ver_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Db_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Int_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ver_Buf ) ! Ver
  IF(ALLOCATED(Re_Ver_Buf))  DEALLOCATE(Re_Ver_Buf)
  IF(ALLOCATED(Db_Ver_Buf))  DEALLOCATE(Db_Ver_Buf)
  IF(ALLOCATED(Int_Ver_Buf)) DEALLOCATE(Int_Ver_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, OnlySize ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 ) = Re_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 ) = Db_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 ) = Int_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ver_Buf) )  DEALLOCATE(Re_Ver_Buf)
  IF( ALLOCATED(Db_Ver_Buf) )  DEALLOCATE(Db_Ver_Buf)
  IF( ALLOCATED(Int_Ver_Buf) ) DEALLOCATE(Int_Ver_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
 END SUBROUTINE ED_PackInitOutput

 SUBROUTINE ED_UnPackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_initoutputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ver_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    Re_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    Db_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    Int_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg ) ! Ver 
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1))); mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInitOutput

 SUBROUTINE ED_CopyContState( SrcContStateData, DstContStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_continuousstatetype), INTENT(INOUT) :: SrcContStateData
   TYPE(ED_continuousstatetype), INTENT(INOUT) :: DstContStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcContStateData%QT)) THEN
   i1_l = LBOUND(SrcContStateData%QT,1)
   i1_u = UBOUND(SrcContStateData%QT,1)
   IF (.NOT.ALLOCATED(DstContStateData%QT)) THEN 
      ALLOCATE(DstContStateData%QT(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyContState: Error allocating DstContStateData%QT.'
         RETURN
      END IF
   END IF
   DstContStateData%QT = SrcContStateData%QT
ENDIF
IF (ALLOCATED(SrcContStateData%QDT)) THEN
   i1_l = LBOUND(SrcContStateData%QDT,1)
   i1_u = UBOUND(SrcContStateData%QDT,1)
   IF (.NOT.ALLOCATED(DstContStateData%QDT)) THEN 
      ALLOCATE(DstContStateData%QDT(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyContState: Error allocating DstContStateData%QDT.'
         RETURN
      END IF
   END IF
   DstContStateData%QDT = SrcContStateData%QDT
ENDIF
 END SUBROUTINE ED_CopyContState

 SUBROUTINE ED_DestroyContState( ContStateData, ErrStat, ErrMsg )
  TYPE(ED_continuousstatetype), INTENT(INOUT) :: ContStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(ContStateData%QT) ) DEALLOCATE(ContStateData%QT)
  IF ( ALLOCATED(ContStateData%QDT) ) DEALLOCATE(ContStateData%QDT)
 END SUBROUTINE ED_DestroyContState

 SUBROUTINE ED_PackContState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_continuousstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%QT )  ! QT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%QDT )  ! QDT 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%QT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QT))-1 ) =  PACK(InData%QT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QT)
  ENDIF
  IF ( ALLOCATED(InData%QDT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QDT))-1 ) =  PACK(InData%QDT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QDT)
  ENDIF
 END SUBROUTINE ED_PackContState

 SUBROUTINE ED_UnPackContState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_continuousstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%QT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QT,1))); mask1 = .TRUE.
    OutData%QT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QT))-1 ),mask1,OutData%QT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QT)
  ENDIF
  IF ( ALLOCATED(OutData%QDT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QDT,1))); mask1 = .TRUE.
    OutData%QDT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QDT))-1 ),mask1,OutData%QDT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QDT)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackContState

 SUBROUTINE ED_CopyDiscState( SrcDiscStateData, DstDiscStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_discretestatetype), INTENT(INOUT) :: SrcDiscStateData
   TYPE(ED_discretestatetype), INTENT(INOUT) :: DstDiscStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDiscStateData%DummyDiscState = SrcDiscStateData%DummyDiscState
 END SUBROUTINE ED_CopyDiscState

 SUBROUTINE ED_DestroyDiscState( DiscStateData, ErrStat, ErrMsg )
  TYPE(ED_discretestatetype), INTENT(INOUT) :: DiscStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyDiscState

 SUBROUTINE ED_PackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_discretestatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyDiscState
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyDiscState )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackDiscState

 SUBROUTINE ED_UnPackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_discretestatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyDiscState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackDiscState

 SUBROUTINE ED_CopyConstrState( SrcConstrStateData, DstConstrStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_constraintstatetype), INTENT(INOUT) :: SrcConstrStateData
   TYPE(ED_constraintstatetype), INTENT(INOUT) :: DstConstrStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstConstrStateData%DummyConstrState = SrcConstrStateData%DummyConstrState
 END SUBROUTINE ED_CopyConstrState

 SUBROUTINE ED_DestroyConstrState( ConstrStateData, ErrStat, ErrMsg )
  TYPE(ED_constraintstatetype), INTENT(INOUT) :: ConstrStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyConstrState

 SUBROUTINE ED_PackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_constraintstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyConstrState
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyConstrState )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackConstrState

 SUBROUTINE ED_UnPackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_constraintstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyConstrState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackConstrState

 SUBROUTINE ED_CopyOtherState( SrcOtherStateData, DstOtherStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_otherstatetype), INTENT(INOUT) :: SrcOtherStateData
   TYPE(ED_otherstatetype), INTENT(INOUT) :: DstOtherStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL ED_Copycoordsys( SrcOtherStateData%CoordSys, DstOtherStateData%CoordSys, CtrlCode, ErrStat, ErrMsg )
      CALL ED_Copyrthndside( SrcOtherStateData%RtHS, DstOtherStateData%RtHS, CtrlCode, ErrStat, ErrMsg )
   DstOtherStateData%n = SrcOtherStateData%n
   DO i1 = LBOUND(SrcOtherStateData%xdot,1), UBOUND(SrcOtherStateData%xdot,1)
      CALL ED_CopyContState( SrcOtherStateData%xdot(i1), DstOtherStateData%xdot(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
IF (ALLOCATED(SrcOtherStateData%IC)) THEN
   i1_l = LBOUND(SrcOtherStateData%IC,1)
   i1_u = UBOUND(SrcOtherStateData%IC,1)
   IF (.NOT.ALLOCATED(DstOtherStateData%IC)) THEN 
      ALLOCATE(DstOtherStateData%IC(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOtherState: Error allocating DstOtherStateData%IC.'
         RETURN
      END IF
   END IF
   DstOtherStateData%IC = SrcOtherStateData%IC
ENDIF
IF (ALLOCATED(SrcOtherStateData%QD2T)) THEN
   i1_l = LBOUND(SrcOtherStateData%QD2T,1)
   i1_u = UBOUND(SrcOtherStateData%QD2T,1)
   IF (.NOT.ALLOCATED(DstOtherStateData%QD2T)) THEN 
      ALLOCATE(DstOtherStateData%QD2T(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOtherState: Error allocating DstOtherStateData%QD2T.'
         RETURN
      END IF
   END IF
   DstOtherStateData%QD2T = SrcOtherStateData%QD2T
ENDIF
IF (ALLOCATED(SrcOtherStateData%BlPitch)) THEN
   i1_l = LBOUND(SrcOtherStateData%BlPitch,1)
   i1_u = UBOUND(SrcOtherStateData%BlPitch,1)
   IF (.NOT.ALLOCATED(DstOtherStateData%BlPitch)) THEN 
      ALLOCATE(DstOtherStateData%BlPitch(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOtherState: Error allocating DstOtherStateData%BlPitch.'
         RETURN
      END IF
   END IF
   DstOtherStateData%BlPitch = SrcOtherStateData%BlPitch
ENDIF
IF (ALLOCATED(SrcOtherStateData%AugMat)) THEN
   i1_l = LBOUND(SrcOtherStateData%AugMat,1)
   i1_u = UBOUND(SrcOtherStateData%AugMat,1)
   i2_l = LBOUND(SrcOtherStateData%AugMat,2)
   i2_u = UBOUND(SrcOtherStateData%AugMat,2)
   IF (.NOT.ALLOCATED(DstOtherStateData%AugMat)) THEN 
      ALLOCATE(DstOtherStateData%AugMat(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOtherState: Error allocating DstOtherStateData%AugMat.'
         RETURN
      END IF
   END IF
   DstOtherStateData%AugMat = SrcOtherStateData%AugMat
ENDIF
IF (ALLOCATED(SrcOtherStateData%AugMatOut)) THEN
   i1_l = LBOUND(SrcOtherStateData%AugMatOut,1)
   i1_u = UBOUND(SrcOtherStateData%AugMatOut,1)
   i2_l = LBOUND(SrcOtherStateData%AugMatOut,2)
   i2_u = UBOUND(SrcOtherStateData%AugMatOut,2)
   IF (.NOT.ALLOCATED(DstOtherStateData%AugMatOut)) THEN 
      ALLOCATE(DstOtherStateData%AugMatOut(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOtherState: Error allocating DstOtherStateData%AugMatOut.'
         RETURN
      END IF
   END IF
   DstOtherStateData%AugMatOut = SrcOtherStateData%AugMatOut
ENDIF
      CALL ED_CopyContState( SrcOtherStateData%k1, DstOtherStateData%k1, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE ED_CopyOtherState

 SUBROUTINE ED_DestroyOtherState( OtherStateData, ErrStat, ErrMsg )
  TYPE(ED_otherstatetype), INTENT(INOUT) :: OtherStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL ED_Destroycoordsys( OtherStateData%CoordSys, ErrStat, ErrMsg )
  CALL ED_Destroyrthndside( OtherStateData%RtHS, ErrStat, ErrMsg )
DO i1 = LBOUND(OtherStateData%xdot,1), UBOUND(OtherStateData%xdot,1)
  CALL ED_DestroyContState( OtherStateData%xdot(i1), ErrStat, ErrMsg )
ENDDO
  IF ( ALLOCATED(OtherStateData%IC) ) DEALLOCATE(OtherStateData%IC)
  IF ( ALLOCATED(OtherStateData%QD2T) ) DEALLOCATE(OtherStateData%QD2T)
  IF ( ALLOCATED(OtherStateData%BlPitch) ) DEALLOCATE(OtherStateData%BlPitch)
  IF ( ALLOCATED(OtherStateData%AugMat) ) DEALLOCATE(OtherStateData%AugMat)
  IF ( ALLOCATED(OtherStateData%AugMatOut) ) DEALLOCATE(OtherStateData%AugMatOut)
  CALL ED_DestroyContState( OtherStateData%k1, ErrStat, ErrMsg )
 END SUBROUTINE ED_DestroyOtherState

 SUBROUTINE ED_PackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_otherstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_CoordSys_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_CoordSys_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_CoordSys_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RtHS_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RtHS_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RtHS_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xdot_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xdot_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xdot_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_k1_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_k1_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_k1_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, InData%CoordSys, ErrStat, ErrMsg, .TRUE. ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_CoordSys_Buf  ) ! CoordSys
  IF(ALLOCATED(Db_CoordSys_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_CoordSys_Buf  ) ! CoordSys
  IF(ALLOCATED(Int_CoordSys_Buf))Int_BufSz = Int_BufSz + SIZE( Int_CoordSys_Buf ) ! CoordSys
  IF(ALLOCATED(Re_CoordSys_Buf))  DEALLOCATE(Re_CoordSys_Buf)
  IF(ALLOCATED(Db_CoordSys_Buf))  DEALLOCATE(Db_CoordSys_Buf)
  IF(ALLOCATED(Int_CoordSys_Buf)) DEALLOCATE(Int_CoordSys_Buf)
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, InData%RtHS, ErrStat, ErrMsg, .TRUE. ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RtHS_Buf  ) ! RtHS
  IF(ALLOCATED(Db_RtHS_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RtHS_Buf  ) ! RtHS
  IF(ALLOCATED(Int_RtHS_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RtHS_Buf ) ! RtHS
  IF(ALLOCATED(Re_RtHS_Buf))  DEALLOCATE(Re_RtHS_Buf)
  IF(ALLOCATED(Db_RtHS_Buf))  DEALLOCATE(Db_RtHS_Buf)
  IF(ALLOCATED(Int_RtHS_Buf)) DEALLOCATE(Int_RtHS_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! n
DO i1 = LBOUND(InData%xdot,1), UBOUND(InData%xdot,1)
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, InData%xdot(i1), ErrStat, ErrMsg, .TRUE. ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xdot_Buf  ) ! xdot
  IF(ALLOCATED(Db_xdot_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xdot_Buf  ) ! xdot
  IF(ALLOCATED(Int_xdot_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xdot_Buf ) ! xdot
  IF(ALLOCATED(Re_xdot_Buf))  DEALLOCATE(Re_xdot_Buf)
  IF(ALLOCATED(Db_xdot_Buf))  DEALLOCATE(Db_xdot_Buf)
  IF(ALLOCATED(Int_xdot_Buf)) DEALLOCATE(Int_xdot_Buf)
ENDDO
  Int_BufSz   = Int_BufSz   + SIZE( InData%IC )  ! IC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%QD2T )  ! QD2T 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AugMat )  ! AugMat 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AugMatOut )  ! AugMatOut 
  CALL ED_PackContState( Re_k1_Buf, Db_k1_Buf, Int_k1_Buf, InData%k1, ErrStat, ErrMsg, .TRUE. ) ! k1 
  IF(ALLOCATED(Re_k1_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_k1_Buf  ) ! k1
  IF(ALLOCATED(Db_k1_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_k1_Buf  ) ! k1
  IF(ALLOCATED(Int_k1_Buf))Int_BufSz = Int_BufSz + SIZE( Int_k1_Buf ) ! k1
  IF(ALLOCATED(Re_k1_Buf))  DEALLOCATE(Re_k1_Buf)
  IF(ALLOCATED(Db_k1_Buf))  DEALLOCATE(Db_k1_Buf)
  IF(ALLOCATED(Int_k1_Buf)) DEALLOCATE(Int_k1_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, InData%CoordSys, ErrStat, ErrMsg, OnlySize ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_CoordSys_Buf)-1 ) = Re_CoordSys_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Db_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_CoordSys_Buf)-1 ) = Db_CoordSys_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Int_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_CoordSys_Buf)-1 ) = Int_CoordSys_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_CoordSys_Buf)
  ENDIF
  IF( ALLOCATED(Re_CoordSys_Buf) )  DEALLOCATE(Re_CoordSys_Buf)
  IF( ALLOCATED(Db_CoordSys_Buf) )  DEALLOCATE(Db_CoordSys_Buf)
  IF( ALLOCATED(Int_CoordSys_Buf) ) DEALLOCATE(Int_CoordSys_Buf)
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, InData%RtHS, ErrStat, ErrMsg, OnlySize ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RtHS_Buf)-1 ) = Re_RtHS_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Db_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RtHS_Buf)-1 ) = Db_RtHS_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Int_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RtHS_Buf)-1 ) = Int_RtHS_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RtHS_Buf)
  ENDIF
  IF( ALLOCATED(Re_RtHS_Buf) )  DEALLOCATE(Re_RtHS_Buf)
  IF( ALLOCATED(Db_RtHS_Buf) )  DEALLOCATE(Db_RtHS_Buf)
  IF( ALLOCATED(Int_RtHS_Buf) ) DEALLOCATE(Int_RtHS_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(InData%xdot,1), UBOUND(InData%xdot,1)
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, InData%xdot(i1), ErrStat, ErrMsg, OnlySize ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xdot_Buf)-1 ) = Re_xdot_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Db_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xdot_Buf)-1 ) = Db_xdot_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Int_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xdot_Buf)-1 ) = Int_xdot_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xdot_Buf)
  ENDIF
  IF( ALLOCATED(Re_xdot_Buf) )  DEALLOCATE(Re_xdot_Buf)
  IF( ALLOCATED(Db_xdot_Buf) )  DEALLOCATE(Db_xdot_Buf)
  IF( ALLOCATED(Int_xdot_Buf) ) DEALLOCATE(Int_xdot_Buf)
ENDDO
  IF ( ALLOCATED(InData%IC) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%IC))-1 ) = PACK(InData%IC ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%IC)
  ENDIF
  IF ( ALLOCATED(InData%QD2T) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QD2T))-1 ) =  PACK(InData%QD2T ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QD2T)
  ENDIF
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( ALLOCATED(InData%AugMat) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AugMat))-1 ) =  PACK(InData%AugMat ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AugMat)
  ENDIF
  IF ( ALLOCATED(InData%AugMatOut) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AugMatOut))-1 ) =  PACK(InData%AugMatOut ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AugMatOut)
  ENDIF
  CALL ED_PackContState( Re_k1_Buf, Db_k1_Buf, Int_k1_Buf, InData%k1, ErrStat, ErrMsg, OnlySize ) ! k1 
  IF(ALLOCATED(Re_k1_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_k1_Buf)-1 ) = Re_k1_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_k1_Buf)
  ENDIF
  IF(ALLOCATED(Db_k1_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_k1_Buf)-1 ) = Db_k1_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_k1_Buf)
  ENDIF
  IF(ALLOCATED(Int_k1_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_k1_Buf)-1 ) = Int_k1_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_k1_Buf)
  ENDIF
  IF( ALLOCATED(Re_k1_Buf) )  DEALLOCATE(Re_k1_Buf)
  IF( ALLOCATED(Db_k1_Buf) )  DEALLOCATE(Db_k1_Buf)
  IF( ALLOCATED(Int_k1_Buf) ) DEALLOCATE(Int_k1_Buf)
 END SUBROUTINE ED_PackOtherState

 SUBROUTINE ED_UnPackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_otherstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_CoordSys_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_CoordSys_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_CoordSys_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RtHS_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RtHS_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RtHS_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xdot_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xdot_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xdot_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_k1_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_k1_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_k1_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call ED_Packcoordsys to get correctly sized buffers for unpacking
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, OutData%CoordSys, ErrStat, ErrMsg, .TRUE. ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) THEN
    Re_CoordSys_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_CoordSys_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Db_CoordSys_Buf)) THEN
    Db_CoordSys_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_CoordSys_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Int_CoordSys_Buf)) THEN
    Int_CoordSys_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_CoordSys_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_CoordSys_Buf)
  ENDIF
  CALL ED_UnPackcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, OutData%CoordSys, ErrStat, ErrMsg ) ! CoordSys 
 ! first call ED_Packrthndside to get correctly sized buffers for unpacking
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, OutData%RtHS, ErrStat, ErrMsg, .TRUE. ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) THEN
    Re_RtHS_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RtHS_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Db_RtHS_Buf)) THEN
    Db_RtHS_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RtHS_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Int_RtHS_Buf)) THEN
    Int_RtHS_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RtHS_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RtHS_Buf)
  ENDIF
  CALL ED_UnPackrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, OutData%RtHS, ErrStat, ErrMsg ) ! RtHS 
  OutData%n = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(OutData%xdot,1), UBOUND(OutData%xdot,1)
 ! first call ED_PackContState to get correctly sized buffers for unpacking
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, OutData%xdot(i1), ErrStat, ErrMsg, .TRUE. ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) THEN
    Re_xdot_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xdot_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Db_xdot_Buf)) THEN
    Db_xdot_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xdot_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Int_xdot_Buf)) THEN
    Int_xdot_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xdot_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xdot_Buf)
  ENDIF
  CALL ED_UnPackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, OutData%xdot(i1), ErrStat, ErrMsg ) ! xdot 
ENDDO
  IF ( ALLOCATED(OutData%IC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%IC,1))); mask1 = .TRUE.
    OutData%IC = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%IC))-1 ),mask1,OutData%IC)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%IC)
  ENDIF
  IF ( ALLOCATED(OutData%QD2T) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QD2T,1))); mask1 = .TRUE.
    OutData%QD2T = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QD2T))-1 ),mask1,OutData%QD2T)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QD2T)
  ENDIF
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1))); mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  IF ( ALLOCATED(OutData%AugMat) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AugMat,1),SIZE(OutData%AugMat,2))); mask2 = .TRUE.
    OutData%AugMat = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AugMat))-1 ),mask2,OutData%AugMat)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AugMat)
  ENDIF
  IF ( ALLOCATED(OutData%AugMatOut) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AugMatOut,1),SIZE(OutData%AugMatOut,2))); mask2 = .TRUE.
    OutData%AugMatOut = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AugMatOut))-1 ),mask2,OutData%AugMatOut)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AugMatOut)
  ENDIF
 ! first call ED_PackContState to get correctly sized buffers for unpacking
  CALL ED_PackContState( Re_k1_Buf, Db_k1_Buf, Int_k1_Buf, OutData%k1, ErrStat, ErrMsg, .TRUE. ) ! k1 
  IF(ALLOCATED(Re_k1_Buf)) THEN
    Re_k1_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_k1_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_k1_Buf)
  ENDIF
  IF(ALLOCATED(Db_k1_Buf)) THEN
    Db_k1_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_k1_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_k1_Buf)
  ENDIF
  IF(ALLOCATED(Int_k1_Buf)) THEN
    Int_k1_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_k1_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_k1_Buf)
  ENDIF
  CALL ED_UnPackContState( Re_k1_Buf, Db_k1_Buf, Int_k1_Buf, OutData%k1, ErrStat, ErrMsg ) ! k1 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackOtherState

 SUBROUTINE ED_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_parametertype), INTENT(INOUT) :: SrcParamData
   TYPE(ED_parametertype), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%DT = SrcParamData%DT
   DstParamData%DT24 = SrcParamData%DT24
   DstParamData%BldNodes = SrcParamData%BldNodes
   DstParamData%TipNode = SrcParamData%TipNode
   DstParamData%NDOF = SrcParamData%NDOF
   DstParamData%TwoPiNB = SrcParamData%TwoPiNB
   DstParamData%NAug = SrcParamData%NAug
   DstParamData%NPH = SrcParamData%NPH
IF (ALLOCATED(SrcParamData%PH)) THEN
   i1_l = LBOUND(SrcParamData%PH,1)
   i1_u = UBOUND(SrcParamData%PH,1)
   IF (.NOT.ALLOCATED(DstParamData%PH)) THEN 
      ALLOCATE(DstParamData%PH(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%PH.'
         RETURN
      END IF
   END IF
   DstParamData%PH = SrcParamData%PH
ENDIF
   DstParamData%NPM = SrcParamData%NPM
IF (ALLOCATED(SrcParamData%PM)) THEN
   i1_l = LBOUND(SrcParamData%PM,1)
   i1_u = UBOUND(SrcParamData%PM,1)
   i2_l = LBOUND(SrcParamData%PM,2)
   i2_u = UBOUND(SrcParamData%PM,2)
   IF (.NOT.ALLOCATED(DstParamData%PM)) THEN 
      ALLOCATE(DstParamData%PM(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%PM.'
         RETURN
      END IF
   END IF
   DstParamData%PM = SrcParamData%PM
ENDIF
IF (ALLOCATED(SrcParamData%DOF_Flag)) THEN
   i1_l = LBOUND(SrcParamData%DOF_Flag,1)
   i1_u = UBOUND(SrcParamData%DOF_Flag,1)
   IF (.NOT.ALLOCATED(DstParamData%DOF_Flag)) THEN 
      ALLOCATE(DstParamData%DOF_Flag(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%DOF_Flag.'
         RETURN
      END IF
   END IF
   DstParamData%DOF_Flag = SrcParamData%DOF_Flag
ENDIF
IF (ALLOCATED(SrcParamData%DOF_Desc)) THEN
   i1_l = LBOUND(SrcParamData%DOF_Desc,1)
   i1_u = UBOUND(SrcParamData%DOF_Desc,1)
   IF (.NOT.ALLOCATED(DstParamData%DOF_Desc)) THEN 
      ALLOCATE(DstParamData%DOF_Desc(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%DOF_Desc.'
         RETURN
      END IF
   END IF
   DstParamData%DOF_Desc = SrcParamData%DOF_Desc
ENDIF
      CALL ED_Copyactivedofs( SrcParamData%DOFs, DstParamData%DOFs, CtrlCode, ErrStat, ErrMsg )
   DstParamData%NumOuts = SrcParamData%NumOuts
   DstParamData%OutFmt = SrcParamData%OutFmt
   DstParamData%NBlGages = SrcParamData%NBlGages
   DstParamData%NTwGages = SrcParamData%NTwGages
IF (ALLOCATED(SrcParamData%OutParam)) THEN
   i1_l = LBOUND(SrcParamData%OutParam,1)
   i1_u = UBOUND(SrcParamData%OutParam,1)
   IF (.NOT.ALLOCATED(DstParamData%OutParam)) THEN 
      ALLOCATE(DstParamData%OutParam(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%OutParam.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcParamData%OutParam,1), UBOUND(SrcParamData%OutParam,1)
      CALL NWTC_Library_Copyoutparmtype( SrcParamData%OutParam(i1), DstParamData%OutParam(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
   DstParamData%Delim = SrcParamData%Delim
   DstParamData%AvgNrmTpRd = SrcParamData%AvgNrmTpRd
   DstParamData%AzimB1Up = SrcParamData%AzimB1Up
   DstParamData%CosDel3 = SrcParamData%CosDel3
IF (ALLOCATED(SrcParamData%CosPreC)) THEN
   i1_l = LBOUND(SrcParamData%CosPreC,1)
   i1_u = UBOUND(SrcParamData%CosPreC,1)
   IF (.NOT.ALLOCATED(DstParamData%CosPreC)) THEN 
      ALLOCATE(DstParamData%CosPreC(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%CosPreC.'
         RETURN
      END IF
   END IF
   DstParamData%CosPreC = SrcParamData%CosPreC
ENDIF
   DstParamData%CRFrlSkew = SrcParamData%CRFrlSkew
   DstParamData%CRFrlSkw2 = SrcParamData%CRFrlSkw2
   DstParamData%CRFrlTilt = SrcParamData%CRFrlTilt
   DstParamData%CRFrlTlt2 = SrcParamData%CRFrlTlt2
   DstParamData%CShftSkew = SrcParamData%CShftSkew
   DstParamData%CShftTilt = SrcParamData%CShftTilt
   DstParamData%CSRFrlSkw = SrcParamData%CSRFrlSkw
   DstParamData%CSRFrlTlt = SrcParamData%CSRFrlTlt
   DstParamData%CSTFrlSkw = SrcParamData%CSTFrlSkw
   DstParamData%CSTFrlTlt = SrcParamData%CSTFrlTlt
   DstParamData%CTFinBank = SrcParamData%CTFinBank
   DstParamData%CTFinSkew = SrcParamData%CTFinSkew
   DstParamData%CTFinTilt = SrcParamData%CTFinTilt
   DstParamData%CTFrlSkew = SrcParamData%CTFrlSkew
   DstParamData%CTFrlSkw2 = SrcParamData%CTFrlSkw2
   DstParamData%CTFrlTilt = SrcParamData%CTFrlTilt
   DstParamData%CTFrlTlt2 = SrcParamData%CTFrlTlt2
   DstParamData%FASTHH = SrcParamData%FASTHH
   DstParamData%HubCM = SrcParamData%HubCM
   DstParamData%HubRad = SrcParamData%HubRad
   DstParamData%NacCMxn = SrcParamData%NacCMxn
   DstParamData%NacCMyn = SrcParamData%NacCMyn
   DstParamData%NacCMzn = SrcParamData%NacCMzn
   DstParamData%OverHang = SrcParamData%OverHang
   DstParamData%ProjArea = SrcParamData%ProjArea
   DstParamData%PtfmRefzt = SrcParamData%PtfmRefzt
   DstParamData%RefTwrHt = SrcParamData%RefTwrHt
   DstParamData%RFrlPntxn = SrcParamData%RFrlPntxn
   DstParamData%RFrlPntyn = SrcParamData%RFrlPntyn
   DstParamData%RFrlPntzn = SrcParamData%RFrlPntzn
   DstParamData%rVDxn = SrcParamData%rVDxn
   DstParamData%rVDyn = SrcParamData%rVDyn
   DstParamData%rVDzn = SrcParamData%rVDzn
   DstParamData%rVIMUxn = SrcParamData%rVIMUxn
   DstParamData%rVIMUyn = SrcParamData%rVIMUyn
   DstParamData%rVIMUzn = SrcParamData%rVIMUzn
   DstParamData%rVPxn = SrcParamData%rVPxn
   DstParamData%rVPyn = SrcParamData%rVPyn
   DstParamData%rVPzn = SrcParamData%rVPzn
   DstParamData%rWIxn = SrcParamData%rWIxn
   DstParamData%rWIyn = SrcParamData%rWIyn
   DstParamData%rWIzn = SrcParamData%rWIzn
   DstParamData%rWJxn = SrcParamData%rWJxn
   DstParamData%rWJyn = SrcParamData%rWJyn
   DstParamData%rWJzn = SrcParamData%rWJzn
   DstParamData%rWKxn = SrcParamData%rWKxn
   DstParamData%rWKyn = SrcParamData%rWKyn
   DstParamData%rWKzn = SrcParamData%rWKzn
   DstParamData%rZT0zt = SrcParamData%rZT0zt
   DstParamData%rZYzt = SrcParamData%rZYzt
   DstParamData%SinDel3 = SrcParamData%SinDel3
IF (ALLOCATED(SrcParamData%SinPreC)) THEN
   i1_l = LBOUND(SrcParamData%SinPreC,1)
   i1_u = UBOUND(SrcParamData%SinPreC,1)
   IF (.NOT.ALLOCATED(DstParamData%SinPreC)) THEN 
      ALLOCATE(DstParamData%SinPreC(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%SinPreC.'
         RETURN
      END IF
   END IF
   DstParamData%SinPreC = SrcParamData%SinPreC
ENDIF
   DstParamData%SRFrlSkew = SrcParamData%SRFrlSkew
   DstParamData%SRFrlSkw2 = SrcParamData%SRFrlSkw2
   DstParamData%SRFrlTilt = SrcParamData%SRFrlTilt
   DstParamData%SRFrlTlt2 = SrcParamData%SRFrlTlt2
   DstParamData%SShftSkew = SrcParamData%SShftSkew
   DstParamData%SShftTilt = SrcParamData%SShftTilt
   DstParamData%STFinBank = SrcParamData%STFinBank
   DstParamData%STFinSkew = SrcParamData%STFinSkew
   DstParamData%STFinTilt = SrcParamData%STFinTilt
   DstParamData%STFrlSkew = SrcParamData%STFrlSkew
   DstParamData%STFrlSkw2 = SrcParamData%STFrlSkw2
   DstParamData%STFrlTilt = SrcParamData%STFrlTilt
   DstParamData%STFrlTlt2 = SrcParamData%STFrlTlt2
   DstParamData%TFrlPntxn = SrcParamData%TFrlPntxn
   DstParamData%TFrlPntyn = SrcParamData%TFrlPntyn
   DstParamData%TFrlPntzn = SrcParamData%TFrlPntzn
   DstParamData%TipRad = SrcParamData%TipRad
   DstParamData%TowerHt = SrcParamData%TowerHt
   DstParamData%TowerBsHt = SrcParamData%TowerBsHt
   DstParamData%UndSling = SrcParamData%UndSling
   DstParamData%NumBl = SrcParamData%NumBl
IF (ALLOCATED(SrcParamData%AxRedTFA)) THEN
   i1_l = LBOUND(SrcParamData%AxRedTFA,1)
   i1_u = UBOUND(SrcParamData%AxRedTFA,1)
   i2_l = LBOUND(SrcParamData%AxRedTFA,2)
   i2_u = UBOUND(SrcParamData%AxRedTFA,2)
   i3_l = LBOUND(SrcParamData%AxRedTFA,3)
   i3_u = UBOUND(SrcParamData%AxRedTFA,3)
   IF (.NOT.ALLOCATED(DstParamData%AxRedTFA)) THEN 
      ALLOCATE(DstParamData%AxRedTFA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%AxRedTFA.'
         RETURN
      END IF
   END IF
   DstParamData%AxRedTFA = SrcParamData%AxRedTFA
ENDIF
IF (ALLOCATED(SrcParamData%AxRedTSS)) THEN
   i1_l = LBOUND(SrcParamData%AxRedTSS,1)
   i1_u = UBOUND(SrcParamData%AxRedTSS,1)
   i2_l = LBOUND(SrcParamData%AxRedTSS,2)
   i2_u = UBOUND(SrcParamData%AxRedTSS,2)
   i3_l = LBOUND(SrcParamData%AxRedTSS,3)
   i3_u = UBOUND(SrcParamData%AxRedTSS,3)
   IF (.NOT.ALLOCATED(DstParamData%AxRedTSS)) THEN 
      ALLOCATE(DstParamData%AxRedTSS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%AxRedTSS.'
         RETURN
      END IF
   END IF
   DstParamData%AxRedTSS = SrcParamData%AxRedTSS
ENDIF
   DstParamData%CTFA = SrcParamData%CTFA
   DstParamData%CTSS = SrcParamData%CTSS
IF (ALLOCATED(SrcParamData%DHNodes)) THEN
   i1_l = LBOUND(SrcParamData%DHNodes,1)
   i1_u = UBOUND(SrcParamData%DHNodes,1)
   IF (.NOT.ALLOCATED(DstParamData%DHNodes)) THEN 
      ALLOCATE(DstParamData%DHNodes(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%DHNodes.'
         RETURN
      END IF
   END IF
   DstParamData%DHNodes = SrcParamData%DHNodes
ENDIF
IF (ALLOCATED(SrcParamData%HNodes)) THEN
   i1_l = LBOUND(SrcParamData%HNodes,1)
   i1_u = UBOUND(SrcParamData%HNodes,1)
   IF (.NOT.ALLOCATED(DstParamData%HNodes)) THEN 
      ALLOCATE(DstParamData%HNodes(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%HNodes.'
         RETURN
      END IF
   END IF
   DstParamData%HNodes = SrcParamData%HNodes
ENDIF
IF (ALLOCATED(SrcParamData%HNodesNorm)) THEN
   i1_l = LBOUND(SrcParamData%HNodesNorm,1)
   i1_u = UBOUND(SrcParamData%HNodesNorm,1)
   IF (.NOT.ALLOCATED(DstParamData%HNodesNorm)) THEN 
      ALLOCATE(DstParamData%HNodesNorm(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%HNodesNorm.'
         RETURN
      END IF
   END IF
   DstParamData%HNodesNorm = SrcParamData%HNodesNorm
ENDIF
   DstParamData%KTFA = SrcParamData%KTFA
   DstParamData%KTSS = SrcParamData%KTSS
IF (ALLOCATED(SrcParamData%MassT)) THEN
   i1_l = LBOUND(SrcParamData%MassT,1)
   i1_u = UBOUND(SrcParamData%MassT,1)
   IF (.NOT.ALLOCATED(DstParamData%MassT)) THEN 
      ALLOCATE(DstParamData%MassT(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%MassT.'
         RETURN
      END IF
   END IF
   DstParamData%MassT = SrcParamData%MassT
ENDIF
IF (ALLOCATED(SrcParamData%StiffTSS)) THEN
   i1_l = LBOUND(SrcParamData%StiffTSS,1)
   i1_u = UBOUND(SrcParamData%StiffTSS,1)
   IF (.NOT.ALLOCATED(DstParamData%StiffTSS)) THEN 
      ALLOCATE(DstParamData%StiffTSS(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffTSS.'
         RETURN
      END IF
   END IF
   DstParamData%StiffTSS = SrcParamData%StiffTSS
ENDIF
IF (ALLOCATED(SrcParamData%TwrFASF)) THEN
   i1_l = LBOUND(SrcParamData%TwrFASF,1)
   i1_u = UBOUND(SrcParamData%TwrFASF,1)
   i2_l = LBOUND(SrcParamData%TwrFASF,2)
   i2_u = UBOUND(SrcParamData%TwrFASF,2)
   i3_l = LBOUND(SrcParamData%TwrFASF,3)
   i3_u = UBOUND(SrcParamData%TwrFASF,3)
   IF (.NOT.ALLOCATED(DstParamData%TwrFASF)) THEN 
      ALLOCATE(DstParamData%TwrFASF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%TwrFASF.'
         RETURN
      END IF
   END IF
   DstParamData%TwrFASF = SrcParamData%TwrFASF
ENDIF
   DstParamData%TwrFlexL = SrcParamData%TwrFlexL
IF (ALLOCATED(SrcParamData%TwrSSSF)) THEN
   i1_l = LBOUND(SrcParamData%TwrSSSF,1)
   i1_u = UBOUND(SrcParamData%TwrSSSF,1)
   i2_l = LBOUND(SrcParamData%TwrSSSF,2)
   i2_u = UBOUND(SrcParamData%TwrSSSF,2)
   i3_l = LBOUND(SrcParamData%TwrSSSF,3)
   i3_u = UBOUND(SrcParamData%TwrSSSF,3)
   IF (.NOT.ALLOCATED(DstParamData%TwrSSSF)) THEN 
      ALLOCATE(DstParamData%TwrSSSF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%TwrSSSF.'
         RETURN
      END IF
   END IF
   DstParamData%TwrSSSF = SrcParamData%TwrSSSF
ENDIF
   DstParamData%TTopNode = SrcParamData%TTopNode
   DstParamData%TwrNodes = SrcParamData%TwrNodes
IF (ALLOCATED(SrcParamData%InerTFA)) THEN
   i1_l = LBOUND(SrcParamData%InerTFA,1)
   i1_u = UBOUND(SrcParamData%InerTFA,1)
   IF (.NOT.ALLOCATED(DstParamData%InerTFA)) THEN 
      ALLOCATE(DstParamData%InerTFA(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%InerTFA.'
         RETURN
      END IF
   END IF
   DstParamData%InerTFA = SrcParamData%InerTFA
ENDIF
IF (ALLOCATED(SrcParamData%InerTSS)) THEN
   i1_l = LBOUND(SrcParamData%InerTSS,1)
   i1_u = UBOUND(SrcParamData%InerTSS,1)
   IF (.NOT.ALLOCATED(DstParamData%InerTSS)) THEN 
      ALLOCATE(DstParamData%InerTSS(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%InerTSS.'
         RETURN
      END IF
   END IF
   DstParamData%InerTSS = SrcParamData%InerTSS
ENDIF
IF (ALLOCATED(SrcParamData%StiffTGJ)) THEN
   i1_l = LBOUND(SrcParamData%StiffTGJ,1)
   i1_u = UBOUND(SrcParamData%StiffTGJ,1)
   IF (.NOT.ALLOCATED(DstParamData%StiffTGJ)) THEN 
      ALLOCATE(DstParamData%StiffTGJ(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffTGJ.'
         RETURN
      END IF
   END IF
   DstParamData%StiffTGJ = SrcParamData%StiffTGJ
ENDIF
IF (ALLOCATED(SrcParamData%StiffTEA)) THEN
   i1_l = LBOUND(SrcParamData%StiffTEA,1)
   i1_u = UBOUND(SrcParamData%StiffTEA,1)
   IF (.NOT.ALLOCATED(DstParamData%StiffTEA)) THEN 
      ALLOCATE(DstParamData%StiffTEA(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffTEA.'
         RETURN
      END IF
   END IF
   DstParamData%StiffTEA = SrcParamData%StiffTEA
ENDIF
IF (ALLOCATED(SrcParamData%StiffTFA)) THEN
   i1_l = LBOUND(SrcParamData%StiffTFA,1)
   i1_u = UBOUND(SrcParamData%StiffTFA,1)
   IF (.NOT.ALLOCATED(DstParamData%StiffTFA)) THEN 
      ALLOCATE(DstParamData%StiffTFA(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffTFA.'
         RETURN
      END IF
   END IF
   DstParamData%StiffTFA = SrcParamData%StiffTFA
ENDIF
IF (ALLOCATED(SrcParamData%cgOffTFA)) THEN
   i1_l = LBOUND(SrcParamData%cgOffTFA,1)
   i1_u = UBOUND(SrcParamData%cgOffTFA,1)
   IF (.NOT.ALLOCATED(DstParamData%cgOffTFA)) THEN 
      ALLOCATE(DstParamData%cgOffTFA(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%cgOffTFA.'
         RETURN
      END IF
   END IF
   DstParamData%cgOffTFA = SrcParamData%cgOffTFA
ENDIF
IF (ALLOCATED(SrcParamData%cgOffTSS)) THEN
   i1_l = LBOUND(SrcParamData%cgOffTSS,1)
   i1_u = UBOUND(SrcParamData%cgOffTSS,1)
   IF (.NOT.ALLOCATED(DstParamData%cgOffTSS)) THEN 
      ALLOCATE(DstParamData%cgOffTSS(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%cgOffTSS.'
         RETURN
      END IF
   END IF
   DstParamData%cgOffTSS = SrcParamData%cgOffTSS
ENDIF
   DstParamData%AtfaIner = SrcParamData%AtfaIner
IF (ALLOCATED(SrcParamData%BldCG)) THEN
   i1_l = LBOUND(SrcParamData%BldCG,1)
   i1_u = UBOUND(SrcParamData%BldCG,1)
   IF (.NOT.ALLOCATED(DstParamData%BldCG)) THEN 
      ALLOCATE(DstParamData%BldCG(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldCG.'
         RETURN
      END IF
   END IF
   DstParamData%BldCG = SrcParamData%BldCG
ENDIF
IF (ALLOCATED(SrcParamData%BldMass)) THEN
   i1_l = LBOUND(SrcParamData%BldMass,1)
   i1_u = UBOUND(SrcParamData%BldMass,1)
   IF (.NOT.ALLOCATED(DstParamData%BldMass)) THEN 
      ALLOCATE(DstParamData%BldMass(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldMass.'
         RETURN
      END IF
   END IF
   DstParamData%BldMass = SrcParamData%BldMass
ENDIF
   DstParamData%BoomMass = SrcParamData%BoomMass
IF (ALLOCATED(SrcParamData%FirstMom)) THEN
   i1_l = LBOUND(SrcParamData%FirstMom,1)
   i1_u = UBOUND(SrcParamData%FirstMom,1)
   IF (.NOT.ALLOCATED(DstParamData%FirstMom)) THEN 
      ALLOCATE(DstParamData%FirstMom(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%FirstMom.'
         RETURN
      END IF
   END IF
   DstParamData%FirstMom = SrcParamData%FirstMom
ENDIF
   DstParamData%GenIner = SrcParamData%GenIner
   DstParamData%Hubg1Iner = SrcParamData%Hubg1Iner
   DstParamData%Hubg2Iner = SrcParamData%Hubg2Iner
   DstParamData%HubMass = SrcParamData%HubMass
   DstParamData%Nacd2Iner = SrcParamData%Nacd2Iner
   DstParamData%NacMass = SrcParamData%NacMass
   DstParamData%PtfmMass = SrcParamData%PtfmMass
   DstParamData%PtfmPIner = SrcParamData%PtfmPIner
   DstParamData%PtfmRIner = SrcParamData%PtfmRIner
   DstParamData%PtfmYIner = SrcParamData%PtfmYIner
   DstParamData%RFrlMass = SrcParamData%RFrlMass
   DstParamData%RotIner = SrcParamData%RotIner
   DstParamData%RotMass = SrcParamData%RotMass
   DstParamData%RrfaIner = SrcParamData%RrfaIner
IF (ALLOCATED(SrcParamData%SecondMom)) THEN
   i1_l = LBOUND(SrcParamData%SecondMom,1)
   i1_u = UBOUND(SrcParamData%SecondMom,1)
   IF (.NOT.ALLOCATED(DstParamData%SecondMom)) THEN 
      ALLOCATE(DstParamData%SecondMom(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%SecondMom.'
         RETURN
      END IF
   END IF
   DstParamData%SecondMom = SrcParamData%SecondMom
ENDIF
   DstParamData%TFinMass = SrcParamData%TFinMass
   DstParamData%TFrlIner = SrcParamData%TFrlIner
IF (ALLOCATED(SrcParamData%TipMass)) THEN
   i1_l = LBOUND(SrcParamData%TipMass,1)
   i1_u = UBOUND(SrcParamData%TipMass,1)
   IF (.NOT.ALLOCATED(DstParamData%TipMass)) THEN 
      ALLOCATE(DstParamData%TipMass(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%TipMass.'
         RETURN
      END IF
   END IF
   DstParamData%TipMass = SrcParamData%TipMass
ENDIF
   DstParamData%TurbMass = SrcParamData%TurbMass
   DstParamData%TwrMass = SrcParamData%TwrMass
   DstParamData%TwrTpMass = SrcParamData%TwrTpMass
   DstParamData%YawBrMass = SrcParamData%YawBrMass
   DstParamData%AirDens = SrcParamData%AirDens
   DstParamData%Gravity = SrcParamData%Gravity
IF (ALLOCATED(SrcParamData%PitchAxis)) THEN
   i1_l = LBOUND(SrcParamData%PitchAxis,1)
   i1_u = UBOUND(SrcParamData%PitchAxis,1)
   i2_l = LBOUND(SrcParamData%PitchAxis,2)
   i2_u = UBOUND(SrcParamData%PitchAxis,2)
   IF (.NOT.ALLOCATED(DstParamData%PitchAxis)) THEN 
      ALLOCATE(DstParamData%PitchAxis(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%PitchAxis.'
         RETURN
      END IF
   END IF
   DstParamData%PitchAxis = SrcParamData%PitchAxis
ENDIF
IF (ALLOCATED(SrcParamData%AeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%AeroTwst,1)
   i1_u = UBOUND(SrcParamData%AeroTwst,1)
   IF (.NOT.ALLOCATED(DstParamData%AeroTwst)) THEN 
      ALLOCATE(DstParamData%AeroTwst(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%AeroTwst.'
         RETURN
      END IF
   END IF
   DstParamData%AeroTwst = SrcParamData%AeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%AxRedBld)) THEN
   i1_l = LBOUND(SrcParamData%AxRedBld,1)
   i1_u = UBOUND(SrcParamData%AxRedBld,1)
   i2_l = LBOUND(SrcParamData%AxRedBld,2)
   i2_u = UBOUND(SrcParamData%AxRedBld,2)
   i3_l = LBOUND(SrcParamData%AxRedBld,3)
   i3_u = UBOUND(SrcParamData%AxRedBld,3)
   i4_l = LBOUND(SrcParamData%AxRedBld,4)
   i4_u = UBOUND(SrcParamData%AxRedBld,4)
   IF (.NOT.ALLOCATED(DstParamData%AxRedBld)) THEN 
      ALLOCATE(DstParamData%AxRedBld(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%AxRedBld.'
         RETURN
      END IF
   END IF
   DstParamData%AxRedBld = SrcParamData%AxRedBld
ENDIF
IF (ALLOCATED(SrcParamData%BAlpha)) THEN
   i1_l = LBOUND(SrcParamData%BAlpha,1)
   i1_u = UBOUND(SrcParamData%BAlpha,1)
   i2_l = LBOUND(SrcParamData%BAlpha,2)
   i2_u = UBOUND(SrcParamData%BAlpha,2)
   IF (.NOT.ALLOCATED(DstParamData%BAlpha)) THEN 
      ALLOCATE(DstParamData%BAlpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BAlpha.'
         RETURN
      END IF
   END IF
   DstParamData%BAlpha = SrcParamData%BAlpha
ENDIF
IF (ALLOCATED(SrcParamData%BldEDamp)) THEN
   i1_l = LBOUND(SrcParamData%BldEDamp,1)
   i1_u = UBOUND(SrcParamData%BldEDamp,1)
   i2_l = LBOUND(SrcParamData%BldEDamp,2)
   i2_u = UBOUND(SrcParamData%BldEDamp,2)
   IF (.NOT.ALLOCATED(DstParamData%BldEDamp)) THEN 
      ALLOCATE(DstParamData%BldEDamp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldEDamp.'
         RETURN
      END IF
   END IF
   DstParamData%BldEDamp = SrcParamData%BldEDamp
ENDIF
IF (ALLOCATED(SrcParamData%BldFDamp)) THEN
   i1_l = LBOUND(SrcParamData%BldFDamp,1)
   i1_u = UBOUND(SrcParamData%BldFDamp,1)
   i2_l = LBOUND(SrcParamData%BldFDamp,2)
   i2_u = UBOUND(SrcParamData%BldFDamp,2)
   IF (.NOT.ALLOCATED(DstParamData%BldFDamp)) THEN 
      ALLOCATE(DstParamData%BldFDamp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldFDamp.'
         RETURN
      END IF
   END IF
   DstParamData%BldFDamp = SrcParamData%BldFDamp
ENDIF
   DstParamData%BldFlexL = SrcParamData%BldFlexL
IF (ALLOCATED(SrcParamData%CAeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%CAeroTwst,1)
   i1_u = UBOUND(SrcParamData%CAeroTwst,1)
   IF (.NOT.ALLOCATED(DstParamData%CAeroTwst)) THEN 
      ALLOCATE(DstParamData%CAeroTwst(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%CAeroTwst.'
         RETURN
      END IF
   END IF
   DstParamData%CAeroTwst = SrcParamData%CAeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%CBE)) THEN
   i1_l = LBOUND(SrcParamData%CBE,1)
   i1_u = UBOUND(SrcParamData%CBE,1)
   i2_l = LBOUND(SrcParamData%CBE,2)
   i2_u = UBOUND(SrcParamData%CBE,2)
   i3_l = LBOUND(SrcParamData%CBE,3)
   i3_u = UBOUND(SrcParamData%CBE,3)
   IF (.NOT.ALLOCATED(DstParamData%CBE)) THEN 
      ALLOCATE(DstParamData%CBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%CBE.'
         RETURN
      END IF
   END IF
   DstParamData%CBE = SrcParamData%CBE
ENDIF
IF (ALLOCATED(SrcParamData%CBF)) THEN
   i1_l = LBOUND(SrcParamData%CBF,1)
   i1_u = UBOUND(SrcParamData%CBF,1)
   i2_l = LBOUND(SrcParamData%CBF,2)
   i2_u = UBOUND(SrcParamData%CBF,2)
   i3_l = LBOUND(SrcParamData%CBF,3)
   i3_u = UBOUND(SrcParamData%CBF,3)
   IF (.NOT.ALLOCATED(DstParamData%CBF)) THEN 
      ALLOCATE(DstParamData%CBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%CBF.'
         RETURN
      END IF
   END IF
   DstParamData%CBF = SrcParamData%CBF
ENDIF
IF (ALLOCATED(SrcParamData%cgOffBEdg)) THEN
   i1_l = LBOUND(SrcParamData%cgOffBEdg,1)
   i1_u = UBOUND(SrcParamData%cgOffBEdg,1)
   i2_l = LBOUND(SrcParamData%cgOffBEdg,2)
   i2_u = UBOUND(SrcParamData%cgOffBEdg,2)
   IF (.NOT.ALLOCATED(DstParamData%cgOffBEdg)) THEN 
      ALLOCATE(DstParamData%cgOffBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%cgOffBEdg.'
         RETURN
      END IF
   END IF
   DstParamData%cgOffBEdg = SrcParamData%cgOffBEdg
ENDIF
IF (ALLOCATED(SrcParamData%cgOffBFlp)) THEN
   i1_l = LBOUND(SrcParamData%cgOffBFlp,1)
   i1_u = UBOUND(SrcParamData%cgOffBFlp,1)
   i2_l = LBOUND(SrcParamData%cgOffBFlp,2)
   i2_u = UBOUND(SrcParamData%cgOffBFlp,2)
   IF (.NOT.ALLOCATED(DstParamData%cgOffBFlp)) THEN 
      ALLOCATE(DstParamData%cgOffBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%cgOffBFlp.'
         RETURN
      END IF
   END IF
   DstParamData%cgOffBFlp = SrcParamData%cgOffBFlp
ENDIF
IF (ALLOCATED(SrcParamData%Chord)) THEN
   i1_l = LBOUND(SrcParamData%Chord,1)
   i1_u = UBOUND(SrcParamData%Chord,1)
   IF (.NOT.ALLOCATED(DstParamData%Chord)) THEN 
      ALLOCATE(DstParamData%Chord(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%Chord.'
         RETURN
      END IF
   END IF
   DstParamData%Chord = SrcParamData%Chord
ENDIF
IF (ALLOCATED(SrcParamData%CThetaS)) THEN
   i1_l = LBOUND(SrcParamData%CThetaS,1)
   i1_u = UBOUND(SrcParamData%CThetaS,1)
   i2_l = LBOUND(SrcParamData%CThetaS,2)
   i2_u = UBOUND(SrcParamData%CThetaS,2)
   IF (.NOT.ALLOCATED(DstParamData%CThetaS)) THEN 
      ALLOCATE(DstParamData%CThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%CThetaS.'
         RETURN
      END IF
   END IF
   DstParamData%CThetaS = SrcParamData%CThetaS
ENDIF
IF (ALLOCATED(SrcParamData%DRNodes)) THEN
   i1_l = LBOUND(SrcParamData%DRNodes,1)
   i1_u = UBOUND(SrcParamData%DRNodes,1)
   IF (.NOT.ALLOCATED(DstParamData%DRNodes)) THEN 
      ALLOCATE(DstParamData%DRNodes(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%DRNodes.'
         RETURN
      END IF
   END IF
   DstParamData%DRNodes = SrcParamData%DRNodes
ENDIF
IF (ALLOCATED(SrcParamData%EAOffBEdg)) THEN
   i1_l = LBOUND(SrcParamData%EAOffBEdg,1)
   i1_u = UBOUND(SrcParamData%EAOffBEdg,1)
   i2_l = LBOUND(SrcParamData%EAOffBEdg,2)
   i2_u = UBOUND(SrcParamData%EAOffBEdg,2)
   IF (.NOT.ALLOCATED(DstParamData%EAOffBEdg)) THEN 
      ALLOCATE(DstParamData%EAOffBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%EAOffBEdg.'
         RETURN
      END IF
   END IF
   DstParamData%EAOffBEdg = SrcParamData%EAOffBEdg
ENDIF
IF (ALLOCATED(SrcParamData%EAOffBFlp)) THEN
   i1_l = LBOUND(SrcParamData%EAOffBFlp,1)
   i1_u = UBOUND(SrcParamData%EAOffBFlp,1)
   i2_l = LBOUND(SrcParamData%EAOffBFlp,2)
   i2_u = UBOUND(SrcParamData%EAOffBFlp,2)
   IF (.NOT.ALLOCATED(DstParamData%EAOffBFlp)) THEN 
      ALLOCATE(DstParamData%EAOffBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%EAOffBFlp.'
         RETURN
      END IF
   END IF
   DstParamData%EAOffBFlp = SrcParamData%EAOffBFlp
ENDIF
IF (ALLOCATED(SrcParamData%FStTunr)) THEN
   i1_l = LBOUND(SrcParamData%FStTunr,1)
   i1_u = UBOUND(SrcParamData%FStTunr,1)
   i2_l = LBOUND(SrcParamData%FStTunr,2)
   i2_u = UBOUND(SrcParamData%FStTunr,2)
   IF (.NOT.ALLOCATED(DstParamData%FStTunr)) THEN 
      ALLOCATE(DstParamData%FStTunr(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%FStTunr.'
         RETURN
      END IF
   END IF
   DstParamData%FStTunr = SrcParamData%FStTunr
ENDIF
IF (ALLOCATED(SrcParamData%InerBEdg)) THEN
   i1_l = LBOUND(SrcParamData%InerBEdg,1)
   i1_u = UBOUND(SrcParamData%InerBEdg,1)
   i2_l = LBOUND(SrcParamData%InerBEdg,2)
   i2_u = UBOUND(SrcParamData%InerBEdg,2)
   IF (.NOT.ALLOCATED(DstParamData%InerBEdg)) THEN 
      ALLOCATE(DstParamData%InerBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%InerBEdg.'
         RETURN
      END IF
   END IF
   DstParamData%InerBEdg = SrcParamData%InerBEdg
ENDIF
IF (ALLOCATED(SrcParamData%InerBFlp)) THEN
   i1_l = LBOUND(SrcParamData%InerBFlp,1)
   i1_u = UBOUND(SrcParamData%InerBFlp,1)
   i2_l = LBOUND(SrcParamData%InerBFlp,2)
   i2_u = UBOUND(SrcParamData%InerBFlp,2)
   IF (.NOT.ALLOCATED(DstParamData%InerBFlp)) THEN 
      ALLOCATE(DstParamData%InerBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%InerBFlp.'
         RETURN
      END IF
   END IF
   DstParamData%InerBFlp = SrcParamData%InerBFlp
ENDIF
IF (ALLOCATED(SrcParamData%KBE)) THEN
   i1_l = LBOUND(SrcParamData%KBE,1)
   i1_u = UBOUND(SrcParamData%KBE,1)
   i2_l = LBOUND(SrcParamData%KBE,2)
   i2_u = UBOUND(SrcParamData%KBE,2)
   i3_l = LBOUND(SrcParamData%KBE,3)
   i3_u = UBOUND(SrcParamData%KBE,3)
   IF (.NOT.ALLOCATED(DstParamData%KBE)) THEN 
      ALLOCATE(DstParamData%KBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%KBE.'
         RETURN
      END IF
   END IF
   DstParamData%KBE = SrcParamData%KBE
ENDIF
IF (ALLOCATED(SrcParamData%KBF)) THEN
   i1_l = LBOUND(SrcParamData%KBF,1)
   i1_u = UBOUND(SrcParamData%KBF,1)
   i2_l = LBOUND(SrcParamData%KBF,2)
   i2_u = UBOUND(SrcParamData%KBF,2)
   i3_l = LBOUND(SrcParamData%KBF,3)
   i3_u = UBOUND(SrcParamData%KBF,3)
   IF (.NOT.ALLOCATED(DstParamData%KBF)) THEN 
      ALLOCATE(DstParamData%KBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%KBF.'
         RETURN
      END IF
   END IF
   DstParamData%KBF = SrcParamData%KBF
ENDIF
IF (ALLOCATED(SrcParamData%MassB)) THEN
   i1_l = LBOUND(SrcParamData%MassB,1)
   i1_u = UBOUND(SrcParamData%MassB,1)
   i2_l = LBOUND(SrcParamData%MassB,2)
   i2_u = UBOUND(SrcParamData%MassB,2)
   IF (.NOT.ALLOCATED(DstParamData%MassB)) THEN 
      ALLOCATE(DstParamData%MassB(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%MassB.'
         RETURN
      END IF
   END IF
   DstParamData%MassB = SrcParamData%MassB
ENDIF
IF (ALLOCATED(SrcParamData%RefAxisxb)) THEN
   i1_l = LBOUND(SrcParamData%RefAxisxb,1)
   i1_u = UBOUND(SrcParamData%RefAxisxb,1)
   i2_l = LBOUND(SrcParamData%RefAxisxb,2)
   i2_u = UBOUND(SrcParamData%RefAxisxb,2)
   IF (.NOT.ALLOCATED(DstParamData%RefAxisxb)) THEN 
      ALLOCATE(DstParamData%RefAxisxb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%RefAxisxb.'
         RETURN
      END IF
   END IF
   DstParamData%RefAxisxb = SrcParamData%RefAxisxb
ENDIF
IF (ALLOCATED(SrcParamData%RefAxisyb)) THEN
   i1_l = LBOUND(SrcParamData%RefAxisyb,1)
   i1_u = UBOUND(SrcParamData%RefAxisyb,1)
   i2_l = LBOUND(SrcParamData%RefAxisyb,2)
   i2_u = UBOUND(SrcParamData%RefAxisyb,2)
   IF (.NOT.ALLOCATED(DstParamData%RefAxisyb)) THEN 
      ALLOCATE(DstParamData%RefAxisyb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%RefAxisyb.'
         RETURN
      END IF
   END IF
   DstParamData%RefAxisyb = SrcParamData%RefAxisyb
ENDIF
IF (ALLOCATED(SrcParamData%RNodes)) THEN
   i1_l = LBOUND(SrcParamData%RNodes,1)
   i1_u = UBOUND(SrcParamData%RNodes,1)
   IF (.NOT.ALLOCATED(DstParamData%RNodes)) THEN 
      ALLOCATE(DstParamData%RNodes(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%RNodes.'
         RETURN
      END IF
   END IF
   DstParamData%RNodes = SrcParamData%RNodes
ENDIF
IF (ALLOCATED(SrcParamData%RNodesNorm)) THEN
   i1_l = LBOUND(SrcParamData%RNodesNorm,1)
   i1_u = UBOUND(SrcParamData%RNodesNorm,1)
   IF (.NOT.ALLOCATED(DstParamData%RNodesNorm)) THEN 
      ALLOCATE(DstParamData%RNodesNorm(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%RNodesNorm.'
         RETURN
      END IF
   END IF
   DstParamData%RNodesNorm = SrcParamData%RNodesNorm
ENDIF
IF (ALLOCATED(SrcParamData%rSAerCenn1)) THEN
   i1_l = LBOUND(SrcParamData%rSAerCenn1,1)
   i1_u = UBOUND(SrcParamData%rSAerCenn1,1)
   i2_l = LBOUND(SrcParamData%rSAerCenn1,2)
   i2_u = UBOUND(SrcParamData%rSAerCenn1,2)
   IF (.NOT.ALLOCATED(DstParamData%rSAerCenn1)) THEN 
      ALLOCATE(DstParamData%rSAerCenn1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%rSAerCenn1.'
         RETURN
      END IF
   END IF
   DstParamData%rSAerCenn1 = SrcParamData%rSAerCenn1
ENDIF
IF (ALLOCATED(SrcParamData%rSAerCenn2)) THEN
   i1_l = LBOUND(SrcParamData%rSAerCenn2,1)
   i1_u = UBOUND(SrcParamData%rSAerCenn2,1)
   i2_l = LBOUND(SrcParamData%rSAerCenn2,2)
   i2_u = UBOUND(SrcParamData%rSAerCenn2,2)
   IF (.NOT.ALLOCATED(DstParamData%rSAerCenn2)) THEN 
      ALLOCATE(DstParamData%rSAerCenn2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%rSAerCenn2.'
         RETURN
      END IF
   END IF
   DstParamData%rSAerCenn2 = SrcParamData%rSAerCenn2
ENDIF
IF (ALLOCATED(SrcParamData%SAeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%SAeroTwst,1)
   i1_u = UBOUND(SrcParamData%SAeroTwst,1)
   IF (.NOT.ALLOCATED(DstParamData%SAeroTwst)) THEN 
      ALLOCATE(DstParamData%SAeroTwst(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%SAeroTwst.'
         RETURN
      END IF
   END IF
   DstParamData%SAeroTwst = SrcParamData%SAeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%StiffBE)) THEN
   i1_l = LBOUND(SrcParamData%StiffBE,1)
   i1_u = UBOUND(SrcParamData%StiffBE,1)
   i2_l = LBOUND(SrcParamData%StiffBE,2)
   i2_u = UBOUND(SrcParamData%StiffBE,2)
   IF (.NOT.ALLOCATED(DstParamData%StiffBE)) THEN 
      ALLOCATE(DstParamData%StiffBE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffBE.'
         RETURN
      END IF
   END IF
   DstParamData%StiffBE = SrcParamData%StiffBE
ENDIF
IF (ALLOCATED(SrcParamData%StiffBEA)) THEN
   i1_l = LBOUND(SrcParamData%StiffBEA,1)
   i1_u = UBOUND(SrcParamData%StiffBEA,1)
   i2_l = LBOUND(SrcParamData%StiffBEA,2)
   i2_u = UBOUND(SrcParamData%StiffBEA,2)
   IF (.NOT.ALLOCATED(DstParamData%StiffBEA)) THEN 
      ALLOCATE(DstParamData%StiffBEA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffBEA.'
         RETURN
      END IF
   END IF
   DstParamData%StiffBEA = SrcParamData%StiffBEA
ENDIF
IF (ALLOCATED(SrcParamData%StiffBF)) THEN
   i1_l = LBOUND(SrcParamData%StiffBF,1)
   i1_u = UBOUND(SrcParamData%StiffBF,1)
   i2_l = LBOUND(SrcParamData%StiffBF,2)
   i2_u = UBOUND(SrcParamData%StiffBF,2)
   IF (.NOT.ALLOCATED(DstParamData%StiffBF)) THEN 
      ALLOCATE(DstParamData%StiffBF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffBF.'
         RETURN
      END IF
   END IF
   DstParamData%StiffBF = SrcParamData%StiffBF
ENDIF
IF (ALLOCATED(SrcParamData%StiffBGJ)) THEN
   i1_l = LBOUND(SrcParamData%StiffBGJ,1)
   i1_u = UBOUND(SrcParamData%StiffBGJ,1)
   i2_l = LBOUND(SrcParamData%StiffBGJ,2)
   i2_u = UBOUND(SrcParamData%StiffBGJ,2)
   IF (.NOT.ALLOCATED(DstParamData%StiffBGJ)) THEN 
      ALLOCATE(DstParamData%StiffBGJ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%StiffBGJ.'
         RETURN
      END IF
   END IF
   DstParamData%StiffBGJ = SrcParamData%StiffBGJ
ENDIF
IF (ALLOCATED(SrcParamData%SThetaS)) THEN
   i1_l = LBOUND(SrcParamData%SThetaS,1)
   i1_u = UBOUND(SrcParamData%SThetaS,1)
   i2_l = LBOUND(SrcParamData%SThetaS,2)
   i2_u = UBOUND(SrcParamData%SThetaS,2)
   IF (.NOT.ALLOCATED(DstParamData%SThetaS)) THEN 
      ALLOCATE(DstParamData%SThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%SThetaS.'
         RETURN
      END IF
   END IF
   DstParamData%SThetaS = SrcParamData%SThetaS
ENDIF
IF (ALLOCATED(SrcParamData%ThetaS)) THEN
   i1_l = LBOUND(SrcParamData%ThetaS,1)
   i1_u = UBOUND(SrcParamData%ThetaS,1)
   i2_l = LBOUND(SrcParamData%ThetaS,2)
   i2_u = UBOUND(SrcParamData%ThetaS,2)
   IF (.NOT.ALLOCATED(DstParamData%ThetaS)) THEN 
      ALLOCATE(DstParamData%ThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%ThetaS.'
         RETURN
      END IF
   END IF
   DstParamData%ThetaS = SrcParamData%ThetaS
ENDIF
IF (ALLOCATED(SrcParamData%TwistedSF)) THEN
   i1_l = LBOUND(SrcParamData%TwistedSF,1)
   i1_u = UBOUND(SrcParamData%TwistedSF,1)
   i2_l = LBOUND(SrcParamData%TwistedSF,2)
   i2_u = UBOUND(SrcParamData%TwistedSF,2)
   i3_l = LBOUND(SrcParamData%TwistedSF,3)
   i3_u = UBOUND(SrcParamData%TwistedSF,3)
   i4_l = LBOUND(SrcParamData%TwistedSF,4)
   i4_u = UBOUND(SrcParamData%TwistedSF,4)
   i5_l = LBOUND(SrcParamData%TwistedSF,5)
   i5_u = UBOUND(SrcParamData%TwistedSF,5)
   IF (.NOT.ALLOCATED(DstParamData%TwistedSF)) THEN 
      ALLOCATE(DstParamData%TwistedSF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%TwistedSF.'
         RETURN
      END IF
   END IF
   DstParamData%TwistedSF = SrcParamData%TwistedSF
ENDIF
IF (ALLOCATED(SrcParamData%BldFl1Sh)) THEN
   i1_l = LBOUND(SrcParamData%BldFl1Sh,1)
   i1_u = UBOUND(SrcParamData%BldFl1Sh,1)
   i2_l = LBOUND(SrcParamData%BldFl1Sh,2)
   i2_u = UBOUND(SrcParamData%BldFl1Sh,2)
   IF (.NOT.ALLOCATED(DstParamData%BldFl1Sh)) THEN 
      ALLOCATE(DstParamData%BldFl1Sh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldFl1Sh.'
         RETURN
      END IF
   END IF
   DstParamData%BldFl1Sh = SrcParamData%BldFl1Sh
ENDIF
IF (ALLOCATED(SrcParamData%BldFl2Sh)) THEN
   i1_l = LBOUND(SrcParamData%BldFl2Sh,1)
   i1_u = UBOUND(SrcParamData%BldFl2Sh,1)
   i2_l = LBOUND(SrcParamData%BldFl2Sh,2)
   i2_u = UBOUND(SrcParamData%BldFl2Sh,2)
   IF (.NOT.ALLOCATED(DstParamData%BldFl2Sh)) THEN 
      ALLOCATE(DstParamData%BldFl2Sh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldFl2Sh.'
         RETURN
      END IF
   END IF
   DstParamData%BldFl2Sh = SrcParamData%BldFl2Sh
ENDIF
IF (ALLOCATED(SrcParamData%BldEdgSh)) THEN
   i1_l = LBOUND(SrcParamData%BldEdgSh,1)
   i1_u = UBOUND(SrcParamData%BldEdgSh,1)
   i2_l = LBOUND(SrcParamData%BldEdgSh,2)
   i2_u = UBOUND(SrcParamData%BldEdgSh,2)
   IF (.NOT.ALLOCATED(DstParamData%BldEdgSh)) THEN 
      ALLOCATE(DstParamData%BldEdgSh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BldEdgSh.'
         RETURN
      END IF
   END IF
   DstParamData%BldEdgSh = SrcParamData%BldEdgSh
ENDIF
IF (ALLOCATED(SrcParamData%FreqBE)) THEN
   i1_l = LBOUND(SrcParamData%FreqBE,1)
   i1_u = UBOUND(SrcParamData%FreqBE,1)
   i2_l = LBOUND(SrcParamData%FreqBE,2)
   i2_u = UBOUND(SrcParamData%FreqBE,2)
   i3_l = LBOUND(SrcParamData%FreqBE,3)
   i3_u = UBOUND(SrcParamData%FreqBE,3)
   IF (.NOT.ALLOCATED(DstParamData%FreqBE)) THEN 
      ALLOCATE(DstParamData%FreqBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%FreqBE.'
         RETURN
      END IF
   END IF
   DstParamData%FreqBE = SrcParamData%FreqBE
ENDIF
IF (ALLOCATED(SrcParamData%FreqBF)) THEN
   i1_l = LBOUND(SrcParamData%FreqBF,1)
   i1_u = UBOUND(SrcParamData%FreqBF,1)
   i2_l = LBOUND(SrcParamData%FreqBF,2)
   i2_u = UBOUND(SrcParamData%FreqBF,2)
   i3_l = LBOUND(SrcParamData%FreqBF,3)
   i3_u = UBOUND(SrcParamData%FreqBF,3)
   IF (.NOT.ALLOCATED(DstParamData%FreqBF)) THEN 
      ALLOCATE(DstParamData%FreqBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%FreqBF.'
         RETURN
      END IF
   END IF
   DstParamData%FreqBF = SrcParamData%FreqBF
ENDIF
   DstParamData%FreqTFA = SrcParamData%FreqTFA
   DstParamData%FreqTSS = SrcParamData%FreqTSS
   DstParamData%TeetCDmp = SrcParamData%TeetCDmp
   DstParamData%TeetDmp = SrcParamData%TeetDmp
   DstParamData%TeetDmpP = SrcParamData%TeetDmpP
   DstParamData%TeetHSSp = SrcParamData%TeetHSSp
   DstParamData%TeetHStP = SrcParamData%TeetHStP
   DstParamData%TeetSSSp = SrcParamData%TeetSSSp
   DstParamData%TeetSStP = SrcParamData%TeetSStP
   DstParamData%TeetMod = SrcParamData%TeetMod
   DstParamData%TFrlCDmp = SrcParamData%TFrlCDmp
   DstParamData%TFrlDmp = SrcParamData%TFrlDmp
   DstParamData%TFrlDSDmp = SrcParamData%TFrlDSDmp
   DstParamData%TFrlDSDP = SrcParamData%TFrlDSDP
   DstParamData%TFrlDSSP = SrcParamData%TFrlDSSP
   DstParamData%TFrlDSSpr = SrcParamData%TFrlDSSpr
   DstParamData%TFrlSpr = SrcParamData%TFrlSpr
   DstParamData%TFrlUSDmp = SrcParamData%TFrlUSDmp
   DstParamData%TFrlUSDP = SrcParamData%TFrlUSDP
   DstParamData%TFrlUSSP = SrcParamData%TFrlUSSP
   DstParamData%TFrlUSSpr = SrcParamData%TFrlUSSpr
   DstParamData%TFrlMod = SrcParamData%TFrlMod
   DstParamData%RFrlCDmp = SrcParamData%RFrlCDmp
   DstParamData%RFrlDmp = SrcParamData%RFrlDmp
   DstParamData%RFrlDSDmp = SrcParamData%RFrlDSDmp
   DstParamData%RFrlDSDP = SrcParamData%RFrlDSDP
   DstParamData%RFrlDSSP = SrcParamData%RFrlDSSP
   DstParamData%RFrlDSSpr = SrcParamData%RFrlDSSpr
   DstParamData%RFrlSpr = SrcParamData%RFrlSpr
   DstParamData%RFrlUSDmp = SrcParamData%RFrlUSDmp
   DstParamData%RFrlUSDP = SrcParamData%RFrlUSDP
   DstParamData%RFrlUSSP = SrcParamData%RFrlUSSP
   DstParamData%RFrlUSSpr = SrcParamData%RFrlUSSpr
   DstParamData%RFrlMod = SrcParamData%RFrlMod
   DstParamData%ShftGagL = SrcParamData%ShftGagL
   DstParamData%BldGagNd = SrcParamData%BldGagNd
   DstParamData%TwrGagNd = SrcParamData%TwrGagNd
   DstParamData%TStart = SrcParamData%TStart
   DstParamData%DTTorDmp = SrcParamData%DTTorDmp
   DstParamData%DTTorSpr = SrcParamData%DTTorSpr
   DstParamData%GBRatio = SrcParamData%GBRatio
   DstParamData%GBoxEff = SrcParamData%GBoxEff
   DstParamData%RotSpeed = SrcParamData%RotSpeed
   DstParamData%RootName = SrcParamData%RootName
IF (ALLOCATED(SrcParamData%BElmntMass)) THEN
   i1_l = LBOUND(SrcParamData%BElmntMass,1)
   i1_u = UBOUND(SrcParamData%BElmntMass,1)
   i2_l = LBOUND(SrcParamData%BElmntMass,2)
   i2_u = UBOUND(SrcParamData%BElmntMass,2)
   IF (.NOT.ALLOCATED(DstParamData%BElmntMass)) THEN 
      ALLOCATE(DstParamData%BElmntMass(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%BElmntMass.'
         RETURN
      END IF
   END IF
   DstParamData%BElmntMass = SrcParamData%BElmntMass
ENDIF
IF (ALLOCATED(SrcParamData%TElmntMass)) THEN
   i1_l = LBOUND(SrcParamData%TElmntMass,1)
   i1_u = UBOUND(SrcParamData%TElmntMass,1)
   IF (.NOT.ALLOCATED(DstParamData%TElmntMass)) THEN 
      ALLOCATE(DstParamData%TElmntMass(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyParam: Error allocating DstParamData%TElmntMass.'
         RETURN
      END IF
   END IF
   DstParamData%TElmntMass = SrcParamData%TElmntMass
ENDIF
   DstParamData%method = SrcParamData%method
   DstParamData%PtfmCMxt = SrcParamData%PtfmCMxt
   DstParamData%PtfmCMyt = SrcParamData%PtfmCMyt
 END SUBROUTINE ED_CopyParam

 SUBROUTINE ED_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(ED_parametertype), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  IF ( ALLOCATED(ParamData%PH) ) DEALLOCATE(ParamData%PH)
  IF ( ALLOCATED(ParamData%PM) ) DEALLOCATE(ParamData%PM)
  IF ( ALLOCATED(ParamData%DOF_Flag) ) DEALLOCATE(ParamData%DOF_Flag)
  IF ( ALLOCATED(ParamData%DOF_Desc) ) DEALLOCATE(ParamData%DOF_Desc)
  CALL ED_Destroyactivedofs( ParamData%DOFs, ErrStat, ErrMsg )
IF (ALLOCATED(ParamData%OutParam)) THEN
DO i1 = LBOUND(ParamData%OutParam,1), UBOUND(ParamData%OutParam,1)
  CALL NWTC_Library_Destroyoutparmtype( ParamData%OutParam(i1), ErrStat, ErrMsg )
ENDDO
ENDIF
  IF ( ALLOCATED(ParamData%CosPreC) ) DEALLOCATE(ParamData%CosPreC)
  IF ( ALLOCATED(ParamData%SinPreC) ) DEALLOCATE(ParamData%SinPreC)
  IF ( ALLOCATED(ParamData%AxRedTFA) ) DEALLOCATE(ParamData%AxRedTFA)
  IF ( ALLOCATED(ParamData%AxRedTSS) ) DEALLOCATE(ParamData%AxRedTSS)
  IF ( ALLOCATED(ParamData%DHNodes) ) DEALLOCATE(ParamData%DHNodes)
  IF ( ALLOCATED(ParamData%HNodes) ) DEALLOCATE(ParamData%HNodes)
  IF ( ALLOCATED(ParamData%HNodesNorm) ) DEALLOCATE(ParamData%HNodesNorm)
  IF ( ALLOCATED(ParamData%MassT) ) DEALLOCATE(ParamData%MassT)
  IF ( ALLOCATED(ParamData%StiffTSS) ) DEALLOCATE(ParamData%StiffTSS)
  IF ( ALLOCATED(ParamData%TwrFASF) ) DEALLOCATE(ParamData%TwrFASF)
  IF ( ALLOCATED(ParamData%TwrSSSF) ) DEALLOCATE(ParamData%TwrSSSF)
  IF ( ALLOCATED(ParamData%InerTFA) ) DEALLOCATE(ParamData%InerTFA)
  IF ( ALLOCATED(ParamData%InerTSS) ) DEALLOCATE(ParamData%InerTSS)
  IF ( ALLOCATED(ParamData%StiffTGJ) ) DEALLOCATE(ParamData%StiffTGJ)
  IF ( ALLOCATED(ParamData%StiffTEA) ) DEALLOCATE(ParamData%StiffTEA)
  IF ( ALLOCATED(ParamData%StiffTFA) ) DEALLOCATE(ParamData%StiffTFA)
  IF ( ALLOCATED(ParamData%cgOffTFA) ) DEALLOCATE(ParamData%cgOffTFA)
  IF ( ALLOCATED(ParamData%cgOffTSS) ) DEALLOCATE(ParamData%cgOffTSS)
  IF ( ALLOCATED(ParamData%BldCG) ) DEALLOCATE(ParamData%BldCG)
  IF ( ALLOCATED(ParamData%BldMass) ) DEALLOCATE(ParamData%BldMass)
  IF ( ALLOCATED(ParamData%FirstMom) ) DEALLOCATE(ParamData%FirstMom)
  IF ( ALLOCATED(ParamData%SecondMom) ) DEALLOCATE(ParamData%SecondMom)
  IF ( ALLOCATED(ParamData%TipMass) ) DEALLOCATE(ParamData%TipMass)
  IF ( ALLOCATED(ParamData%PitchAxis) ) DEALLOCATE(ParamData%PitchAxis)
  IF ( ALLOCATED(ParamData%AeroTwst) ) DEALLOCATE(ParamData%AeroTwst)
  IF ( ALLOCATED(ParamData%AxRedBld) ) DEALLOCATE(ParamData%AxRedBld)
  IF ( ALLOCATED(ParamData%BAlpha) ) DEALLOCATE(ParamData%BAlpha)
  IF ( ALLOCATED(ParamData%BldEDamp) ) DEALLOCATE(ParamData%BldEDamp)
  IF ( ALLOCATED(ParamData%BldFDamp) ) DEALLOCATE(ParamData%BldFDamp)
  IF ( ALLOCATED(ParamData%CAeroTwst) ) DEALLOCATE(ParamData%CAeroTwst)
  IF ( ALLOCATED(ParamData%CBE) ) DEALLOCATE(ParamData%CBE)
  IF ( ALLOCATED(ParamData%CBF) ) DEALLOCATE(ParamData%CBF)
  IF ( ALLOCATED(ParamData%cgOffBEdg) ) DEALLOCATE(ParamData%cgOffBEdg)
  IF ( ALLOCATED(ParamData%cgOffBFlp) ) DEALLOCATE(ParamData%cgOffBFlp)
  IF ( ALLOCATED(ParamData%Chord) ) DEALLOCATE(ParamData%Chord)
  IF ( ALLOCATED(ParamData%CThetaS) ) DEALLOCATE(ParamData%CThetaS)
  IF ( ALLOCATED(ParamData%DRNodes) ) DEALLOCATE(ParamData%DRNodes)
  IF ( ALLOCATED(ParamData%EAOffBEdg) ) DEALLOCATE(ParamData%EAOffBEdg)
  IF ( ALLOCATED(ParamData%EAOffBFlp) ) DEALLOCATE(ParamData%EAOffBFlp)
  IF ( ALLOCATED(ParamData%FStTunr) ) DEALLOCATE(ParamData%FStTunr)
  IF ( ALLOCATED(ParamData%InerBEdg) ) DEALLOCATE(ParamData%InerBEdg)
  IF ( ALLOCATED(ParamData%InerBFlp) ) DEALLOCATE(ParamData%InerBFlp)
  IF ( ALLOCATED(ParamData%KBE) ) DEALLOCATE(ParamData%KBE)
  IF ( ALLOCATED(ParamData%KBF) ) DEALLOCATE(ParamData%KBF)
  IF ( ALLOCATED(ParamData%MassB) ) DEALLOCATE(ParamData%MassB)
  IF ( ALLOCATED(ParamData%RefAxisxb) ) DEALLOCATE(ParamData%RefAxisxb)
  IF ( ALLOCATED(ParamData%RefAxisyb) ) DEALLOCATE(ParamData%RefAxisyb)
  IF ( ALLOCATED(ParamData%RNodes) ) DEALLOCATE(ParamData%RNodes)
  IF ( ALLOCATED(ParamData%RNodesNorm) ) DEALLOCATE(ParamData%RNodesNorm)
  IF ( ALLOCATED(ParamData%rSAerCenn1) ) DEALLOCATE(ParamData%rSAerCenn1)
  IF ( ALLOCATED(ParamData%rSAerCenn2) ) DEALLOCATE(ParamData%rSAerCenn2)
  IF ( ALLOCATED(ParamData%SAeroTwst) ) DEALLOCATE(ParamData%SAeroTwst)
  IF ( ALLOCATED(ParamData%StiffBE) ) DEALLOCATE(ParamData%StiffBE)
  IF ( ALLOCATED(ParamData%StiffBEA) ) DEALLOCATE(ParamData%StiffBEA)
  IF ( ALLOCATED(ParamData%StiffBF) ) DEALLOCATE(ParamData%StiffBF)
  IF ( ALLOCATED(ParamData%StiffBGJ) ) DEALLOCATE(ParamData%StiffBGJ)
  IF ( ALLOCATED(ParamData%SThetaS) ) DEALLOCATE(ParamData%SThetaS)
  IF ( ALLOCATED(ParamData%ThetaS) ) DEALLOCATE(ParamData%ThetaS)
  IF ( ALLOCATED(ParamData%TwistedSF) ) DEALLOCATE(ParamData%TwistedSF)
  IF ( ALLOCATED(ParamData%BldFl1Sh) ) DEALLOCATE(ParamData%BldFl1Sh)
  IF ( ALLOCATED(ParamData%BldFl2Sh) ) DEALLOCATE(ParamData%BldFl2Sh)
  IF ( ALLOCATED(ParamData%BldEdgSh) ) DEALLOCATE(ParamData%BldEdgSh)
  IF ( ALLOCATED(ParamData%FreqBE) ) DEALLOCATE(ParamData%FreqBE)
  IF ( ALLOCATED(ParamData%FreqBF) ) DEALLOCATE(ParamData%FreqBF)
  IF ( ALLOCATED(ParamData%BElmntMass) ) DEALLOCATE(ParamData%BElmntMass)
  IF ( ALLOCATED(ParamData%TElmntMass) ) DEALLOCATE(ParamData%TElmntMass)
 END SUBROUTINE ED_DestroyParam

 SUBROUTINE ED_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_parametertype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_DOFs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DOFs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DOFs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OutParam_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OutParam_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OutParam_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Db_BufSz   = Db_BufSz   + 1  ! DT24
  Int_BufSz  = Int_BufSz  + 1  ! BldNodes
  Int_BufSz  = Int_BufSz  + 1  ! TipNode
  Int_BufSz  = Int_BufSz  + 1  ! NDOF
  Re_BufSz   = Re_BufSz   + 1  ! TwoPiNB
  Int_BufSz  = Int_BufSz  + 1  ! NAug
  Int_BufSz  = Int_BufSz  + 1  ! NPH
  Int_BufSz   = Int_BufSz   + SIZE( InData%PH )  ! PH 
  Int_BufSz  = Int_BufSz  + 1  ! NPM
  Int_BufSz   = Int_BufSz   + SIZE( InData%PM )  ! PM 
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, InData%DOFs, ErrStat, ErrMsg, .TRUE. ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DOFs_Buf  ) ! DOFs
  IF(ALLOCATED(Db_DOFs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DOFs_Buf  ) ! DOFs
  IF(ALLOCATED(Int_DOFs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DOFs_Buf ) ! DOFs
  IF(ALLOCATED(Re_DOFs_Buf))  DEALLOCATE(Re_DOFs_Buf)
  IF(ALLOCATED(Db_DOFs_Buf))  DEALLOCATE(Db_DOFs_Buf)
  IF(ALLOCATED(Int_DOFs_Buf)) DEALLOCATE(Int_DOFs_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumOuts
  Int_BufSz  = Int_BufSz  + 1  ! NBlGages
  Int_BufSz  = Int_BufSz  + 1  ! NTwGages
DO i1 = LBOUND(InData%OutParam,1), UBOUND(InData%OutParam,1)
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, InData%OutParam(i1), ErrStat, ErrMsg, .TRUE. ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OutParam_Buf  ) ! OutParam
  IF(ALLOCATED(Db_OutParam_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OutParam_Buf  ) ! OutParam
  IF(ALLOCATED(Int_OutParam_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OutParam_Buf ) ! OutParam
  IF(ALLOCATED(Re_OutParam_Buf))  DEALLOCATE(Re_OutParam_Buf)
  IF(ALLOCATED(Db_OutParam_Buf))  DEALLOCATE(Db_OutParam_Buf)
  IF(ALLOCATED(Int_OutParam_Buf)) DEALLOCATE(Int_OutParam_Buf)
ENDDO
  Re_BufSz   = Re_BufSz   + 1  ! AvgNrmTpRd
  Re_BufSz   = Re_BufSz   + 1  ! AzimB1Up
  Re_BufSz   = Re_BufSz   + 1  ! CosDel3
  Re_BufSz    = Re_BufSz    + SIZE( InData%CosPreC )  ! CosPreC 
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! CShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! CShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! CSRFrlSkw
  Re_BufSz   = Re_BufSz   + 1  ! CSRFrlTlt
  Re_BufSz   = Re_BufSz   + 1  ! CSTFrlSkw
  Re_BufSz   = Re_BufSz   + 1  ! CSTFrlTlt
  Re_BufSz   = Re_BufSz   + 1  ! CTFinBank
  Re_BufSz   = Re_BufSz   + 1  ! CTFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! CTFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! FASTHH
  Re_BufSz   = Re_BufSz   + 1  ! HubCM
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Re_BufSz   = Re_BufSz   + 1  ! NacCMxn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMyn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMzn
  Re_BufSz   = Re_BufSz   + 1  ! OverHang
  Re_BufSz   = Re_BufSz   + 1  ! ProjArea
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRefzt
  Re_BufSz   = Re_BufSz   + 1  ! RefTwrHt
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! rVDxn
  Re_BufSz   = Re_BufSz   + 1  ! rVDyn
  Re_BufSz   = Re_BufSz   + 1  ! rVDzn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUxn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUyn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUzn
  Re_BufSz   = Re_BufSz   + 1  ! rVPxn
  Re_BufSz   = Re_BufSz   + 1  ! rVPyn
  Re_BufSz   = Re_BufSz   + 1  ! rVPzn
  Re_BufSz   = Re_BufSz   + 1  ! rWIxn
  Re_BufSz   = Re_BufSz   + 1  ! rWIyn
  Re_BufSz   = Re_BufSz   + 1  ! rWIzn
  Re_BufSz   = Re_BufSz   + 1  ! rWJxn
  Re_BufSz   = Re_BufSz   + 1  ! rWJyn
  Re_BufSz   = Re_BufSz   + 1  ! rWJzn
  Re_BufSz   = Re_BufSz   + 1  ! rWKxn
  Re_BufSz   = Re_BufSz   + 1  ! rWKyn
  Re_BufSz   = Re_BufSz   + 1  ! rWKzn
  Re_BufSz   = Re_BufSz   + 1  ! rZT0zt
  Re_BufSz   = Re_BufSz   + 1  ! rZYzt
  Re_BufSz   = Re_BufSz   + 1  ! SinDel3
  Re_BufSz    = Re_BufSz    + SIZE( InData%SinPreC )  ! SinPreC 
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! SShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! SShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFinBank
  Re_BufSz   = Re_BufSz   + 1  ! STFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! STFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! STFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! STFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! TipRad
  Re_BufSz   = Re_BufSz   + 1  ! TowerHt
  Re_BufSz   = Re_BufSz   + 1  ! TowerBsHt
  Re_BufSz   = Re_BufSz   + 1  ! UndSling
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedTFA )  ! AxRedTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedTSS )  ! AxRedTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CTFA )  ! CTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CTSS )  ! CTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DHNodes )  ! DHNodes 
  Re_BufSz    = Re_BufSz    + SIZE( InData%HNodes )  ! HNodes 
  Re_BufSz    = Re_BufSz    + SIZE( InData%HNodesNorm )  ! HNodesNorm 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KTFA )  ! KTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KTSS )  ! KTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MassT )  ! MassT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTSS )  ! StiffTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrFASF )  ! TwrFASF 
  Re_BufSz   = Re_BufSz   + 1  ! TwrFlexL
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrSSSF )  ! TwrSSSF 
  Int_BufSz  = Int_BufSz  + 1  ! TTopNode
  Int_BufSz  = Int_BufSz  + 1  ! TwrNodes
  Re_BufSz    = Re_BufSz    + SIZE( InData%InerTFA )  ! InerTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%InerTSS )  ! InerTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTGJ )  ! StiffTGJ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTEA )  ! StiffTEA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTFA )  ! StiffTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffTFA )  ! cgOffTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffTSS )  ! cgOffTSS 
  Re_BufSz   = Re_BufSz   + 1  ! AtfaIner
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldCG )  ! BldCG 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldMass )  ! BldMass 
  Re_BufSz   = Re_BufSz   + 1  ! BoomMass
  Re_BufSz    = Re_BufSz    + SIZE( InData%FirstMom )  ! FirstMom 
  Re_BufSz   = Re_BufSz   + 1  ! GenIner
  Re_BufSz   = Re_BufSz   + 1  ! Hubg1Iner
  Re_BufSz   = Re_BufSz   + 1  ! Hubg2Iner
  Re_BufSz   = Re_BufSz   + 1  ! HubMass
  Re_BufSz   = Re_BufSz   + 1  ! Nacd2Iner
  Re_BufSz   = Re_BufSz   + 1  ! NacMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYIner
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMass
  Re_BufSz   = Re_BufSz   + 1  ! RotIner
  Re_BufSz   = Re_BufSz   + 1  ! RotMass
  Re_BufSz   = Re_BufSz   + 1  ! RrfaIner
  Re_BufSz    = Re_BufSz    + SIZE( InData%SecondMom )  ! SecondMom 
  Re_BufSz   = Re_BufSz   + 1  ! TFinMass
  Re_BufSz   = Re_BufSz   + 1  ! TFrlIner
  Re_BufSz    = Re_BufSz    + SIZE( InData%TipMass )  ! TipMass 
  Re_BufSz   = Re_BufSz   + 1  ! TurbMass
  Re_BufSz   = Re_BufSz   + 1  ! TwrMass
  Re_BufSz   = Re_BufSz   + 1  ! TwrTpMass
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMass
  Re_BufSz   = Re_BufSz   + 1  ! AirDens
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  Re_BufSz    = Re_BufSz    + SIZE( InData%PitchAxis )  ! PitchAxis 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AeroTwst )  ! AeroTwst 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedBld )  ! AxRedBld 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BAlpha )  ! BAlpha 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldEDamp )  ! BldEDamp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFDamp )  ! BldFDamp 
  Re_BufSz   = Re_BufSz   + 1  ! BldFlexL
  Re_BufSz    = Re_BufSz    + SIZE( InData%CAeroTwst )  ! CAeroTwst 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CBE )  ! CBE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CBF )  ! CBF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffBEdg )  ! cgOffBEdg 
  Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffBFlp )  ! cgOffBFlp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Chord )  ! Chord 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CThetaS )  ! CThetaS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DRNodes )  ! DRNodes 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EAOffBEdg )  ! EAOffBEdg 
  Re_BufSz    = Re_BufSz    + SIZE( InData%EAOffBFlp )  ! EAOffBFlp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FStTunr )  ! FStTunr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%InerBEdg )  ! InerBEdg 
  Re_BufSz    = Re_BufSz    + SIZE( InData%InerBFlp )  ! InerBFlp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KBE )  ! KBE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KBF )  ! KBF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MassB )  ! MassB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RefAxisxb )  ! RefAxisxb 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RefAxisyb )  ! RefAxisyb 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RNodes )  ! RNodes 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RNodesNorm )  ! RNodesNorm 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rSAerCenn1 )  ! rSAerCenn1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rSAerCenn2 )  ! rSAerCenn2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SAeroTwst )  ! SAeroTwst 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBE )  ! StiffBE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBEA )  ! StiffBEA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBF )  ! StiffBF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBGJ )  ! StiffBGJ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SThetaS )  ! SThetaS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ThetaS )  ! ThetaS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwistedSF )  ! TwistedSF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl1Sh )  ! BldFl1Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl2Sh )  ! BldFl2Sh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdgSh )  ! BldEdgSh 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqBE )  ! FreqBE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqBF )  ! FreqBF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqTFA )  ! FreqTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqTSS )  ! FreqTSS 
  Re_BufSz   = Re_BufSz   + 1  ! TeetCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmpP
  Re_BufSz   = Re_BufSz   + 1  ! TeetHSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetHStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetSSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetSStP
  Int_BufSz  = Int_BufSz  + 1  ! TeetMod
  Re_BufSz   = Re_BufSz   + 1  ! TFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSpr
  Int_BufSz  = Int_BufSz  + 1  ! TFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSpr
  Int_BufSz  = Int_BufSz  + 1  ! RFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! ShftGagL
  Int_BufSz   = Int_BufSz   + SIZE( InData%BldGagNd )  ! BldGagNd 
  Int_BufSz   = Int_BufSz   + SIZE( InData%TwrGagNd )  ! TwrGagNd 
  Db_BufSz   = Db_BufSz   + 1  ! TStart
  Re_BufSz   = Re_BufSz   + 1  ! DTTorDmp
  Re_BufSz   = Re_BufSz   + 1  ! DTTorSpr
  Re_BufSz   = Re_BufSz   + 1  ! GBRatio
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEff
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
  Re_BufSz    = Re_BufSz    + SIZE( InData%BElmntMass )  ! BElmntMass 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TElmntMass )  ! TElmntMass 
  Int_BufSz  = Int_BufSz  + 1  ! method
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMxt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMyt
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT24 )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%BldNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TipNode )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NDOF )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwoPiNB )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NAug )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPH )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PH) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PH))-1 ) = PACK(InData%PH ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PH)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPM )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PM) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PM))-1 ) = PACK(InData%PM ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PM)
  ENDIF
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, InData%DOFs, ErrStat, ErrMsg, OnlySize ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DOFs_Buf)-1 ) = Re_DOFs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DOFs_Buf)-1 ) = Db_DOFs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DOFs_Buf)-1 ) = Int_DOFs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DOFs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DOFs_Buf) )  DEALLOCATE(Re_DOFs_Buf)
  IF( ALLOCATED(Db_DOFs_Buf) )  DEALLOCATE(Db_DOFs_Buf)
  IF( ALLOCATED(Int_DOFs_Buf) ) DEALLOCATE(Int_DOFs_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumOuts )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwGages )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(InData%OutParam,1), UBOUND(InData%OutParam,1)
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, InData%OutParam(i1), ErrStat, ErrMsg, OnlySize ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutParam_Buf)-1 ) = Re_OutParam_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutParam_Buf)-1 ) = Db_OutParam_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutParam_Buf)-1 ) = Int_OutParam_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OutParam_Buf)
  ENDIF
  IF( ALLOCATED(Re_OutParam_Buf) )  DEALLOCATE(Re_OutParam_Buf)
  IF( ALLOCATED(Db_OutParam_Buf) )  DEALLOCATE(Db_OutParam_Buf)
  IF( ALLOCATED(Int_OutParam_Buf) ) DEALLOCATE(Int_OutParam_Buf)
ENDDO
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AvgNrmTpRd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AzimB1Up )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CosDel3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CosPreC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CosPreC))-1 ) =  PACK(InData%CosPreC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CosPreC)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSRFrlSkw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSRFrlTlt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSTFrlSkw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSTFrlTlt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FASTHH )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubCM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OverHang )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ProjArea )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRefzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RefTwrHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rZT0zt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rZYzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SinDel3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%SinPreC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SinPreC))-1 ) =  PACK(InData%SinPreC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SinPreC)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerBsHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UndSling )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%AxRedTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedTFA))-1 ) =  PACK(InData%AxRedTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedTFA)
  ENDIF
  IF ( ALLOCATED(InData%AxRedTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedTSS))-1 ) =  PACK(InData%AxRedTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedTSS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTFA))-1 ) =  PACK(InData%CTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%CTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTSS))-1 ) =  PACK(InData%CTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%CTSS)
  IF ( ALLOCATED(InData%DHNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DHNodes))-1 ) =  PACK(InData%DHNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DHNodes)
  ENDIF
  IF ( ALLOCATED(InData%HNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HNodes))-1 ) =  PACK(InData%HNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HNodes)
  ENDIF
  IF ( ALLOCATED(InData%HNodesNorm) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HNodesNorm))-1 ) =  PACK(InData%HNodesNorm ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HNodesNorm)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KTFA))-1 ) =  PACK(InData%KTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%KTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KTSS))-1 ) =  PACK(InData%KTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%KTSS)
  IF ( ALLOCATED(InData%MassT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MassT))-1 ) =  PACK(InData%MassT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MassT)
  ENDIF
  IF ( ALLOCATED(InData%StiffTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTSS))-1 ) =  PACK(InData%StiffTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTSS)
  ENDIF
  IF ( ALLOCATED(InData%TwrFASF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrFASF))-1 ) =  PACK(InData%TwrFASF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrFASF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrFlexL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TwrSSSF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrSSSF))-1 ) =  PACK(InData%TwrSSSF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrSSSF)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TTopNode )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%InerTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerTFA))-1 ) =  PACK(InData%InerTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerTFA)
  ENDIF
  IF ( ALLOCATED(InData%InerTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerTSS))-1 ) =  PACK(InData%InerTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerTSS)
  ENDIF
  IF ( ALLOCATED(InData%StiffTGJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTGJ))-1 ) =  PACK(InData%StiffTGJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTGJ)
  ENDIF
  IF ( ALLOCATED(InData%StiffTEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTEA))-1 ) =  PACK(InData%StiffTEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTEA)
  ENDIF
  IF ( ALLOCATED(InData%StiffTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTFA))-1 ) =  PACK(InData%StiffTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTFA)
  ENDIF
  IF ( ALLOCATED(InData%cgOffTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffTFA))-1 ) =  PACK(InData%cgOffTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffTFA)
  ENDIF
  IF ( ALLOCATED(InData%cgOffTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffTSS))-1 ) =  PACK(InData%cgOffTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffTSS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AtfaIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BldCG) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldCG))-1 ) =  PACK(InData%BldCG ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldCG)
  ENDIF
  IF ( ALLOCATED(InData%BldMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldMass))-1 ) =  PACK(InData%BldMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%FirstMom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FirstMom))-1 ) =  PACK(InData%FirstMom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FirstMom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Hubg1Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Hubg2Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Nacd2Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RrfaIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%SecondMom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SecondMom))-1 ) =  PACK(InData%SecondMom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SecondMom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TipMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TipMass))-1 ) =  PACK(InData%TipMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TipMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TurbMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrTpMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AirDens )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%PitchAxis) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PitchAxis))-1 ) =  PACK(InData%PitchAxis ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PitchAxis)
  ENDIF
  IF ( ALLOCATED(InData%AeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroTwst))-1 ) =  PACK(InData%AeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%AxRedBld) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedBld))-1 ) =  PACK(InData%AxRedBld ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedBld)
  ENDIF
  IF ( ALLOCATED(InData%BAlpha) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BAlpha))-1 ) =  PACK(InData%BAlpha ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BAlpha)
  ENDIF
  IF ( ALLOCATED(InData%BldEDamp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEDamp))-1 ) =  PACK(InData%BldEDamp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEDamp)
  ENDIF
  IF ( ALLOCATED(InData%BldFDamp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFDamp))-1 ) =  PACK(InData%BldFDamp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFDamp)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BldFlexL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CAeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CAeroTwst))-1 ) =  PACK(InData%CAeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CAeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%CBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CBE))-1 ) =  PACK(InData%CBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CBE)
  ENDIF
  IF ( ALLOCATED(InData%CBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CBF))-1 ) =  PACK(InData%CBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CBF)
  ENDIF
  IF ( ALLOCATED(InData%cgOffBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffBEdg))-1 ) =  PACK(InData%cgOffBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffBEdg)
  ENDIF
  IF ( ALLOCATED(InData%cgOffBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffBFlp))-1 ) =  PACK(InData%cgOffBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffBFlp)
  ENDIF
  IF ( ALLOCATED(InData%Chord) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Chord))-1 ) =  PACK(InData%Chord ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Chord)
  ENDIF
  IF ( ALLOCATED(InData%CThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CThetaS))-1 ) =  PACK(InData%CThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CThetaS)
  ENDIF
  IF ( ALLOCATED(InData%DRNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DRNodes))-1 ) =  PACK(InData%DRNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DRNodes)
  ENDIF
  IF ( ALLOCATED(InData%EAOffBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAOffBEdg))-1 ) =  PACK(InData%EAOffBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAOffBEdg)
  ENDIF
  IF ( ALLOCATED(InData%EAOffBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAOffBFlp))-1 ) =  PACK(InData%EAOffBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAOffBFlp)
  ENDIF
  IF ( ALLOCATED(InData%FStTunr) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FStTunr))-1 ) =  PACK(InData%FStTunr ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FStTunr)
  ENDIF
  IF ( ALLOCATED(InData%InerBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerBEdg))-1 ) =  PACK(InData%InerBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerBEdg)
  ENDIF
  IF ( ALLOCATED(InData%InerBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerBFlp))-1 ) =  PACK(InData%InerBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerBFlp)
  ENDIF
  IF ( ALLOCATED(InData%KBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KBE))-1 ) =  PACK(InData%KBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%KBE)
  ENDIF
  IF ( ALLOCATED(InData%KBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KBF))-1 ) =  PACK(InData%KBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%KBF)
  ENDIF
  IF ( ALLOCATED(InData%MassB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MassB))-1 ) =  PACK(InData%MassB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MassB)
  ENDIF
  IF ( ALLOCATED(InData%RefAxisxb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RefAxisxb))-1 ) =  PACK(InData%RefAxisxb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RefAxisxb)
  ENDIF
  IF ( ALLOCATED(InData%RefAxisyb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RefAxisyb))-1 ) =  PACK(InData%RefAxisyb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RefAxisyb)
  ENDIF
  IF ( ALLOCATED(InData%RNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodes))-1 ) =  PACK(InData%RNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodes)
  ENDIF
  IF ( ALLOCATED(InData%RNodesNorm) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodesNorm))-1 ) =  PACK(InData%RNodesNorm ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodesNorm)
  ENDIF
  IF ( ALLOCATED(InData%rSAerCenn1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rSAerCenn1))-1 ) =  PACK(InData%rSAerCenn1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rSAerCenn1)
  ENDIF
  IF ( ALLOCATED(InData%rSAerCenn2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rSAerCenn2))-1 ) =  PACK(InData%rSAerCenn2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rSAerCenn2)
  ENDIF
  IF ( ALLOCATED(InData%SAeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SAeroTwst))-1 ) =  PACK(InData%SAeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SAeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%StiffBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBE))-1 ) =  PACK(InData%StiffBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBE)
  ENDIF
  IF ( ALLOCATED(InData%StiffBEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBEA))-1 ) =  PACK(InData%StiffBEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBEA)
  ENDIF
  IF ( ALLOCATED(InData%StiffBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBF))-1 ) =  PACK(InData%StiffBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBF)
  ENDIF
  IF ( ALLOCATED(InData%StiffBGJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBGJ))-1 ) =  PACK(InData%StiffBGJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBGJ)
  ENDIF
  IF ( ALLOCATED(InData%SThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SThetaS))-1 ) =  PACK(InData%SThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SThetaS)
  ENDIF
  IF ( ALLOCATED(InData%ThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ThetaS))-1 ) =  PACK(InData%ThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ThetaS)
  ENDIF
  IF ( ALLOCATED(InData%TwistedSF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwistedSF))-1 ) =  PACK(InData%TwistedSF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwistedSF)
  ENDIF
  IF ( ALLOCATED(InData%BldFl1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl1Sh))-1 ) =  PACK(InData%BldFl1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldFl2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl2Sh))-1 ) =  PACK(InData%BldFl2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldEdgSh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdgSh))-1 ) =  PACK(InData%BldEdgSh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdgSh)
  ENDIF
  IF ( ALLOCATED(InData%FreqBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqBE))-1 ) =  PACK(InData%FreqBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FreqBE)
  ENDIF
  IF ( ALLOCATED(InData%FreqBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqBF))-1 ) =  PACK(InData%FreqBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FreqBF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqTFA))-1 ) =  PACK(InData%FreqTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FreqTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqTSS))-1 ) =  PACK(InData%FreqTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FreqTSS)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmpP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TeetMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftGagL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BldGagNd))-1 ) = PACK(InData%BldGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%BldGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%TwrGagNd))-1 ) = PACK(InData%TwrGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%TwrGagNd)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TStart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBRatio )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEff )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BElmntMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BElmntMass))-1 ) =  PACK(InData%BElmntMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BElmntMass)
  ENDIF
  IF ( ALLOCATED(InData%TElmntMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TElmntMass))-1 ) =  PACK(InData%TElmntMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TElmntMass)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%method )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMxt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMyt )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackParam

 SUBROUTINE ED_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_parametertype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_DOFs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DOFs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DOFs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OutParam_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OutParam_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OutParam_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DT24 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%BldNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TipNode = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NDOF = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TwoPiNB = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NAug = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPH = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PH) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PH,1))); mask1 = .TRUE.
    OutData%PH = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PH))-1 ),mask1,OutData%PH)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PH)
  ENDIF
  OutData%NPM = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PM) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PM,1),SIZE(OutData%PM,2))); mask2 = .TRUE.
    OutData%PM = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PM))-1 ),mask2,OutData%PM)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PM)
  ENDIF
 ! first call ED_Packactivedofs to get correctly sized buffers for unpacking
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, OutData%DOFs, ErrStat, ErrMsg, .TRUE. ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) THEN
    Re_DOFs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DOFs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DOFs_Buf)) THEN
    Db_DOFs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DOFs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DOFs_Buf)) THEN
    Int_DOFs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DOFs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DOFs_Buf)
  ENDIF
  CALL ED_UnPackactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, OutData%DOFs, ErrStat, ErrMsg ) ! DOFs 
  OutData%NumOuts = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NBlGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(OutData%OutParam,1), UBOUND(OutData%OutParam,1)
 ! first call NWTC_Library_Packoutparmtype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, OutData%OutParam(i1), ErrStat, ErrMsg, .TRUE. ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) THEN
    Re_OutParam_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutParam_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutParam_Buf)) THEN
    Db_OutParam_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutParam_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutParam_Buf)) THEN
    Int_OutParam_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutParam_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OutParam_Buf)
  ENDIF
  CALL NWTC_Library_UnPackoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, OutData%OutParam(i1), ErrStat, ErrMsg ) ! OutParam 
ENDDO
  OutData%AvgNrmTpRd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%AzimB1Up = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CosDel3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CosPreC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CosPreC,1))); mask1 = .TRUE.
    OutData%CosPreC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CosPreC))-1 ),mask1,OutData%CosPreC)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CosPreC)
  ENDIF
  OutData%CRFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSRFrlSkw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSRFrlTlt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSTFrlSkw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSTFrlTlt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FASTHH = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubCM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OverHang = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ProjArea = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRefzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RefTwrHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rZT0zt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rZYzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SinDel3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%SinPreC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SinPreC,1))); mask1 = .TRUE.
    OutData%SinPreC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SinPreC))-1 ),mask1,OutData%SinPreC)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SinPreC)
  ENDIF
  OutData%SRFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerBsHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UndSling = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%AxRedTFA) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AxRedTFA,1),SIZE(OutData%AxRedTFA,2),SIZE(OutData%AxRedTFA,3))); mask3 = .TRUE.
    OutData%AxRedTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedTFA))-1 ),mask3,OutData%AxRedTFA)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedTFA)
  ENDIF
  IF ( ALLOCATED(OutData%AxRedTSS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AxRedTSS,1),SIZE(OutData%AxRedTSS,2),SIZE(OutData%AxRedTSS,3))); mask3 = .TRUE.
    OutData%AxRedTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedTSS))-1 ),mask3,OutData%AxRedTSS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedTSS)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%CTFA,1),SIZE(OutData%CTFA,2))); mask2 = .TRUE.
  OutData%CTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTFA))-1 ),mask2,OutData%CTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%CTFA)
  ALLOCATE(mask2(SIZE(OutData%CTSS,1),SIZE(OutData%CTSS,2))); mask2 = .TRUE.
  OutData%CTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTSS))-1 ),mask2,OutData%CTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%CTSS)
  IF ( ALLOCATED(OutData%DHNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DHNodes,1))); mask1 = .TRUE.
    OutData%DHNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DHNodes))-1 ),mask1,OutData%DHNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DHNodes)
  ENDIF
  IF ( ALLOCATED(OutData%HNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HNodes,1))); mask1 = .TRUE.
    OutData%HNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HNodes))-1 ),mask1,OutData%HNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HNodes)
  ENDIF
  IF ( ALLOCATED(OutData%HNodesNorm) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HNodesNorm,1))); mask1 = .TRUE.
    OutData%HNodesNorm = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HNodesNorm))-1 ),mask1,OutData%HNodesNorm)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HNodesNorm)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%KTFA,1),SIZE(OutData%KTFA,2))); mask2 = .TRUE.
  OutData%KTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KTFA))-1 ),mask2,OutData%KTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%KTFA)
  ALLOCATE(mask2(SIZE(OutData%KTSS,1),SIZE(OutData%KTSS,2))); mask2 = .TRUE.
  OutData%KTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KTSS))-1 ),mask2,OutData%KTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%KTSS)
  IF ( ALLOCATED(OutData%MassT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%MassT,1))); mask1 = .TRUE.
    OutData%MassT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MassT))-1 ),mask1,OutData%MassT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MassT)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTSS,1))); mask1 = .TRUE.
    OutData%StiffTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTSS))-1 ),mask1,OutData%StiffTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTSS)
  ENDIF
  IF ( ALLOCATED(OutData%TwrFASF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrFASF,1),SIZE(OutData%TwrFASF,2),SIZE(OutData%TwrFASF,3))); mask3 = .TRUE.
    OutData%TwrFASF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrFASF))-1 ),mask3,OutData%TwrFASF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrFASF)
  ENDIF
  OutData%TwrFlexL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrSSSF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrSSSF,1),SIZE(OutData%TwrSSSF,2),SIZE(OutData%TwrSSSF,3))); mask3 = .TRUE.
    OutData%TwrSSSF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrSSSF))-1 ),mask3,OutData%TwrSSSF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrSSSF)
  ENDIF
  OutData%TTopNode = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%InerTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InerTFA,1))); mask1 = .TRUE.
    OutData%InerTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerTFA))-1 ),mask1,OutData%InerTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerTFA)
  ENDIF
  IF ( ALLOCATED(OutData%InerTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InerTSS,1))); mask1 = .TRUE.
    OutData%InerTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerTSS))-1 ),mask1,OutData%InerTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerTSS)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTGJ) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTGJ,1))); mask1 = .TRUE.
    OutData%StiffTGJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTGJ))-1 ),mask1,OutData%StiffTGJ)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTGJ)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTEA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTEA,1))); mask1 = .TRUE.
    OutData%StiffTEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTEA))-1 ),mask1,OutData%StiffTEA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTEA)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTFA,1))); mask1 = .TRUE.
    OutData%StiffTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTFA))-1 ),mask1,OutData%StiffTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTFA)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%cgOffTFA,1))); mask1 = .TRUE.
    OutData%cgOffTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffTFA))-1 ),mask1,OutData%cgOffTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffTFA)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%cgOffTSS,1))); mask1 = .TRUE.
    OutData%cgOffTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffTSS))-1 ),mask1,OutData%cgOffTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffTSS)
  ENDIF
  OutData%AtfaIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BldCG) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldCG,1))); mask1 = .TRUE.
    OutData%BldCG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldCG))-1 ),mask1,OutData%BldCG)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldCG)
  ENDIF
  IF ( ALLOCATED(OutData%BldMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldMass,1))); mask1 = .TRUE.
    OutData%BldMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldMass))-1 ),mask1,OutData%BldMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldMass)
  ENDIF
  OutData%BoomMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%FirstMom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FirstMom,1))); mask1 = .TRUE.
    OutData%FirstMom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FirstMom))-1 ),mask1,OutData%FirstMom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FirstMom)
  ENDIF
  OutData%GenIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Hubg1Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Hubg2Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Nacd2Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RrfaIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%SecondMom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SecondMom,1))); mask1 = .TRUE.
    OutData%SecondMom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SecondMom))-1 ),mask1,OutData%SecondMom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SecondMom)
  ENDIF
  OutData%TFinMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TipMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TipMass,1))); mask1 = .TRUE.
    OutData%TipMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TipMass))-1 ),mask1,OutData%TipMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TipMass)
  ENDIF
  OutData%TurbMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrTpMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%AirDens = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%PitchAxis) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PitchAxis,1),SIZE(OutData%PitchAxis,2))); mask2 = .TRUE.
    OutData%PitchAxis = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PitchAxis))-1 ),mask2,OutData%PitchAxis)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PitchAxis)
  ENDIF
  IF ( ALLOCATED(OutData%AeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AeroTwst,1))); mask1 = .TRUE.
    OutData%AeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroTwst))-1 ),mask1,OutData%AeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%AxRedBld) ) THEN
  ALLOCATE(mask4(SIZE(OutData%AxRedBld,1),SIZE(OutData%AxRedBld,2),SIZE(OutData%AxRedBld,3),SIZE(OutData%AxRedBld,4))); mask4 = .TRUE.
    OutData%AxRedBld = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedBld))-1 ),mask4,OutData%AxRedBld)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedBld)
  ENDIF
  IF ( ALLOCATED(OutData%BAlpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BAlpha,1),SIZE(OutData%BAlpha,2))); mask2 = .TRUE.
    OutData%BAlpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BAlpha))-1 ),mask2,OutData%BAlpha)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BAlpha)
  ENDIF
  IF ( ALLOCATED(OutData%BldEDamp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldEDamp,1),SIZE(OutData%BldEDamp,2))); mask2 = .TRUE.
    OutData%BldEDamp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEDamp))-1 ),mask2,OutData%BldEDamp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEDamp)
  ENDIF
  IF ( ALLOCATED(OutData%BldFDamp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFDamp,1),SIZE(OutData%BldFDamp,2))); mask2 = .TRUE.
    OutData%BldFDamp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFDamp))-1 ),mask2,OutData%BldFDamp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFDamp)
  ENDIF
  OutData%BldFlexL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CAeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CAeroTwst,1))); mask1 = .TRUE.
    OutData%CAeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CAeroTwst))-1 ),mask1,OutData%CAeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CAeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%CBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CBE,1),SIZE(OutData%CBE,2),SIZE(OutData%CBE,3))); mask3 = .TRUE.
    OutData%CBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CBE))-1 ),mask3,OutData%CBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CBE)
  ENDIF
  IF ( ALLOCATED(OutData%CBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CBF,1),SIZE(OutData%CBF,2),SIZE(OutData%CBF,3))); mask3 = .TRUE.
    OutData%CBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CBF))-1 ),mask3,OutData%CBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CBF)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%cgOffBEdg,1),SIZE(OutData%cgOffBEdg,2))); mask2 = .TRUE.
    OutData%cgOffBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffBEdg))-1 ),mask2,OutData%cgOffBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%cgOffBFlp,1),SIZE(OutData%cgOffBFlp,2))); mask2 = .TRUE.
    OutData%cgOffBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffBFlp))-1 ),mask2,OutData%cgOffBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%Chord) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Chord,1))); mask1 = .TRUE.
    OutData%Chord = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Chord))-1 ),mask1,OutData%Chord)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Chord)
  ENDIF
  IF ( ALLOCATED(OutData%CThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CThetaS,1),SIZE(OutData%CThetaS,2))); mask2 = .TRUE.
    OutData%CThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CThetaS))-1 ),mask2,OutData%CThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%DRNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DRNodes,1))); mask1 = .TRUE.
    OutData%DRNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DRNodes))-1 ),mask1,OutData%DRNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DRNodes)
  ENDIF
  IF ( ALLOCATED(OutData%EAOffBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%EAOffBEdg,1),SIZE(OutData%EAOffBEdg,2))); mask2 = .TRUE.
    OutData%EAOffBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAOffBEdg))-1 ),mask2,OutData%EAOffBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAOffBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%EAOffBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%EAOffBFlp,1),SIZE(OutData%EAOffBFlp,2))); mask2 = .TRUE.
    OutData%EAOffBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAOffBFlp))-1 ),mask2,OutData%EAOffBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAOffBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%FStTunr) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FStTunr,1),SIZE(OutData%FStTunr,2))); mask2 = .TRUE.
    OutData%FStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FStTunr))-1 ),mask2,OutData%FStTunr)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FStTunr)
  ENDIF
  IF ( ALLOCATED(OutData%InerBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%InerBEdg,1),SIZE(OutData%InerBEdg,2))); mask2 = .TRUE.
    OutData%InerBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerBEdg))-1 ),mask2,OutData%InerBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%InerBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%InerBFlp,1),SIZE(OutData%InerBFlp,2))); mask2 = .TRUE.
    OutData%InerBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerBFlp))-1 ),mask2,OutData%InerBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%KBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%KBE,1),SIZE(OutData%KBE,2),SIZE(OutData%KBE,3))); mask3 = .TRUE.
    OutData%KBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KBE))-1 ),mask3,OutData%KBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%KBE)
  ENDIF
  IF ( ALLOCATED(OutData%KBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%KBF,1),SIZE(OutData%KBF,2),SIZE(OutData%KBF,3))); mask3 = .TRUE.
    OutData%KBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KBF))-1 ),mask3,OutData%KBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%KBF)
  ENDIF
  IF ( ALLOCATED(OutData%MassB) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MassB,1),SIZE(OutData%MassB,2))); mask2 = .TRUE.
    OutData%MassB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MassB))-1 ),mask2,OutData%MassB)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MassB)
  ENDIF
  IF ( ALLOCATED(OutData%RefAxisxb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%RefAxisxb,1),SIZE(OutData%RefAxisxb,2))); mask2 = .TRUE.
    OutData%RefAxisxb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RefAxisxb))-1 ),mask2,OutData%RefAxisxb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RefAxisxb)
  ENDIF
  IF ( ALLOCATED(OutData%RefAxisyb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%RefAxisyb,1),SIZE(OutData%RefAxisyb,2))); mask2 = .TRUE.
    OutData%RefAxisyb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RefAxisyb))-1 ),mask2,OutData%RefAxisyb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RefAxisyb)
  ENDIF
  IF ( ALLOCATED(OutData%RNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodes,1))); mask1 = .TRUE.
    OutData%RNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodes))-1 ),mask1,OutData%RNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodes)
  ENDIF
  IF ( ALLOCATED(OutData%RNodesNorm) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodesNorm,1))); mask1 = .TRUE.
    OutData%RNodesNorm = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodesNorm))-1 ),mask1,OutData%RNodesNorm)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodesNorm)
  ENDIF
  IF ( ALLOCATED(OutData%rSAerCenn1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rSAerCenn1,1),SIZE(OutData%rSAerCenn1,2))); mask2 = .TRUE.
    OutData%rSAerCenn1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rSAerCenn1))-1 ),mask2,OutData%rSAerCenn1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rSAerCenn1)
  ENDIF
  IF ( ALLOCATED(OutData%rSAerCenn2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rSAerCenn2,1),SIZE(OutData%rSAerCenn2,2))); mask2 = .TRUE.
    OutData%rSAerCenn2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rSAerCenn2))-1 ),mask2,OutData%rSAerCenn2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rSAerCenn2)
  ENDIF
  IF ( ALLOCATED(OutData%SAeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SAeroTwst,1))); mask1 = .TRUE.
    OutData%SAeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SAeroTwst))-1 ),mask1,OutData%SAeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SAeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBE,1),SIZE(OutData%StiffBE,2))); mask2 = .TRUE.
    OutData%StiffBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBE))-1 ),mask2,OutData%StiffBE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBE)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBEA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBEA,1),SIZE(OutData%StiffBEA,2))); mask2 = .TRUE.
    OutData%StiffBEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBEA))-1 ),mask2,OutData%StiffBEA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBEA)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBF,1),SIZE(OutData%StiffBF,2))); mask2 = .TRUE.
    OutData%StiffBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBF))-1 ),mask2,OutData%StiffBF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBF)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBGJ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBGJ,1),SIZE(OutData%StiffBGJ,2))); mask2 = .TRUE.
    OutData%StiffBGJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBGJ))-1 ),mask2,OutData%StiffBGJ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBGJ)
  ENDIF
  IF ( ALLOCATED(OutData%SThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SThetaS,1),SIZE(OutData%SThetaS,2))); mask2 = .TRUE.
    OutData%SThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SThetaS))-1 ),mask2,OutData%SThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%ThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ThetaS,1),SIZE(OutData%ThetaS,2))); mask2 = .TRUE.
    OutData%ThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ThetaS))-1 ),mask2,OutData%ThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%TwistedSF) ) THEN
  ALLOCATE(mask5(SIZE(OutData%TwistedSF,1),SIZE(OutData%TwistedSF,2),SIZE(OutData%TwistedSF,3),SIZE(OutData%TwistedSF,4),SIZE(OutData%TwistedSF,5))); mask5 = .TRUE.
    OutData%TwistedSF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwistedSF))-1 ),mask5,OutData%TwistedSF)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwistedSF)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl1Sh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFl1Sh,1),SIZE(OutData%BldFl1Sh,2))); mask2 = .TRUE.
    OutData%BldFl1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl1Sh))-1 ),mask2,OutData%BldFl1Sh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl2Sh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFl2Sh,1),SIZE(OutData%BldFl2Sh,2))); mask2 = .TRUE.
    OutData%BldFl2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl2Sh))-1 ),mask2,OutData%BldFl2Sh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldEdgSh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldEdgSh,1),SIZE(OutData%BldEdgSh,2))); mask2 = .TRUE.
    OutData%BldEdgSh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdgSh))-1 ),mask2,OutData%BldEdgSh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdgSh)
  ENDIF
  IF ( ALLOCATED(OutData%FreqBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FreqBE,1),SIZE(OutData%FreqBE,2),SIZE(OutData%FreqBE,3))); mask3 = .TRUE.
    OutData%FreqBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqBE))-1 ),mask3,OutData%FreqBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqBE)
  ENDIF
  IF ( ALLOCATED(OutData%FreqBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FreqBF,1),SIZE(OutData%FreqBF,2),SIZE(OutData%FreqBF,3))); mask3 = .TRUE.
    OutData%FreqBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqBF))-1 ),mask3,OutData%FreqBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqBF)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%FreqTFA,1),SIZE(OutData%FreqTFA,2))); mask2 = .TRUE.
  OutData%FreqTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqTFA))-1 ),mask2,OutData%FreqTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqTFA)
  ALLOCATE(mask2(SIZE(OutData%FreqTSS,1),SIZE(OutData%FreqTSS,2))); mask2 = .TRUE.
  OutData%FreqTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqTSS))-1 ),mask2,OutData%FreqTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqTSS)
  OutData%TeetCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmpP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%RFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ShftGagL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%BldGagNd,1))); mask1 = .TRUE.
  OutData%BldGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%BldGagNd))-1 ),mask1,OutData%BldGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%BldGagNd)
  ALLOCATE(mask1(SIZE(OutData%TwrGagNd,1))); mask1 = .TRUE.
  OutData%TwrGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%TwrGagNd))-1 ),mask1,OutData%TwrGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%TwrGagNd)
  OutData%TStart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DTTorDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBRatio = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEff = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BElmntMass) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BElmntMass,1),SIZE(OutData%BElmntMass,2))); mask2 = .TRUE.
    OutData%BElmntMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BElmntMass))-1 ),mask2,OutData%BElmntMass)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BElmntMass)
  ENDIF
  IF ( ALLOCATED(OutData%TElmntMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TElmntMass,1))); mask1 = .TRUE.
    OutData%TElmntMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TElmntMass))-1 ),mask1,OutData%TElmntMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TElmntMass)
  ENDIF
  OutData%method = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%PtfmCMxt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMyt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackParam

 SUBROUTINE ED_CopyInput( SrcInputData, DstInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_inputtype), INTENT(INOUT) :: SrcInputData
   TYPE(ED_inputtype), INTENT(INOUT) :: DstInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
     CALL MeshCopy( SrcInputData%PlatformPtMesh, DstInputData%PlatformPtMesh, CtrlCode, ErrStat, ErrMsg )
     CALL MeshCopy( SrcInputData%TowerLn2Mesh, DstInputData%TowerLn2Mesh, CtrlCode, ErrStat, ErrMsg )
IF (ALLOCATED(SrcInputData%TwrAddedMass)) THEN
   i1_l = LBOUND(SrcInputData%TwrAddedMass,1)
   i1_u = UBOUND(SrcInputData%TwrAddedMass,1)
   i2_l = LBOUND(SrcInputData%TwrAddedMass,2)
   i2_u = UBOUND(SrcInputData%TwrAddedMass,2)
   i3_l = LBOUND(SrcInputData%TwrAddedMass,3)
   i3_u = UBOUND(SrcInputData%TwrAddedMass,3)
   IF (.NOT.ALLOCATED(DstInputData%TwrAddedMass)) THEN 
      ALLOCATE(DstInputData%TwrAddedMass(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%TwrAddedMass.'
         RETURN
      END IF
   END IF
   DstInputData%TwrAddedMass = SrcInputData%TwrAddedMass
ENDIF
   DstInputData%PtfmAddedMass = SrcInputData%PtfmAddedMass
IF (ALLOCATED(SrcInputData%BlPitchCom)) THEN
   i1_l = LBOUND(SrcInputData%BlPitchCom,1)
   i1_u = UBOUND(SrcInputData%BlPitchCom,1)
   IF (.NOT.ALLOCATED(DstInputData%BlPitchCom)) THEN 
      ALLOCATE(DstInputData%BlPitchCom(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%BlPitchCom.'
         RETURN
      END IF
   END IF
   DstInputData%BlPitchCom = SrcInputData%BlPitchCom
ENDIF
   DstInputData%YawMom = SrcInputData%YawMom
   DstInputData%GenTrq = SrcInputData%GenTrq
   DstInputData%HSSBrTrq = SrcInputData%HSSBrTrq
IF (ALLOCATED(SrcInputData%AeroBladeForce)) THEN
   i1_l = LBOUND(SrcInputData%AeroBladeForce,1)
   i1_u = UBOUND(SrcInputData%AeroBladeForce,1)
   i2_l = LBOUND(SrcInputData%AeroBladeForce,2)
   i2_u = UBOUND(SrcInputData%AeroBladeForce,2)
   i3_l = LBOUND(SrcInputData%AeroBladeForce,3)
   i3_u = UBOUND(SrcInputData%AeroBladeForce,3)
   IF (.NOT.ALLOCATED(DstInputData%AeroBladeForce)) THEN 
      ALLOCATE(DstInputData%AeroBladeForce(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%AeroBladeForce.'
         RETURN
      END IF
   END IF
   DstInputData%AeroBladeForce = SrcInputData%AeroBladeForce
ENDIF
IF (ALLOCATED(SrcInputData%AeroBladeMoment)) THEN
   i1_l = LBOUND(SrcInputData%AeroBladeMoment,1)
   i1_u = UBOUND(SrcInputData%AeroBladeMoment,1)
   i2_l = LBOUND(SrcInputData%AeroBladeMoment,2)
   i2_u = UBOUND(SrcInputData%AeroBladeMoment,2)
   i3_l = LBOUND(SrcInputData%AeroBladeMoment,3)
   i3_u = UBOUND(SrcInputData%AeroBladeMoment,3)
   IF (.NOT.ALLOCATED(DstInputData%AeroBladeMoment)) THEN 
      ALLOCATE(DstInputData%AeroBladeMoment(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%AeroBladeMoment.'
         RETURN
      END IF
   END IF
   DstInputData%AeroBladeMoment = SrcInputData%AeroBladeMoment
ENDIF
IF (ALLOCATED(SrcInputData%FTAero)) THEN
   i1_l = LBOUND(SrcInputData%FTAero,1)
   i1_u = UBOUND(SrcInputData%FTAero,1)
   i2_l = LBOUND(SrcInputData%FTAero,2)
   i2_u = UBOUND(SrcInputData%FTAero,2)
   IF (.NOT.ALLOCATED(DstInputData%FTAero)) THEN 
      ALLOCATE(DstInputData%FTAero(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%FTAero.'
         RETURN
      END IF
   END IF
   DstInputData%FTAero = SrcInputData%FTAero
ENDIF
IF (ALLOCATED(SrcInputData%MFAero)) THEN
   i1_l = LBOUND(SrcInputData%MFAero,1)
   i1_u = UBOUND(SrcInputData%MFAero,1)
   i2_l = LBOUND(SrcInputData%MFAero,2)
   i2_u = UBOUND(SrcInputData%MFAero,2)
   IF (.NOT.ALLOCATED(DstInputData%MFAero)) THEN 
      ALLOCATE(DstInputData%MFAero(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyInput: Error allocating DstInputData%MFAero.'
         RETURN
      END IF
   END IF
   DstInputData%MFAero = SrcInputData%MFAero
ENDIF
 END SUBROUTINE ED_CopyInput

 SUBROUTINE ED_DestroyInput( InputData, ErrStat, ErrMsg )
  TYPE(ED_inputtype), INTENT(INOUT) :: InputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL MeshDestroy( InputData%PlatformPtMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( InputData%TowerLn2Mesh, ErrStat, ErrMsg )
  IF ( ALLOCATED(InputData%TwrAddedMass) ) DEALLOCATE(InputData%TwrAddedMass)
  IF ( ALLOCATED(InputData%BlPitchCom) ) DEALLOCATE(InputData%BlPitchCom)
  IF ( ALLOCATED(InputData%AeroBladeForce) ) DEALLOCATE(InputData%AeroBladeForce)
  IF ( ALLOCATED(InputData%AeroBladeMoment) ) DEALLOCATE(InputData%AeroBladeMoment)
  IF ( ALLOCATED(InputData%FTAero) ) DEALLOCATE(InputData%FTAero)
  IF ( ALLOCATED(InputData%MFAero) ) DEALLOCATE(InputData%MFAero)
 END SUBROUTINE ED_DestroyInput

 SUBROUTINE ED_PackInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_inputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Int_PlatformPtMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_PlatformPtMesh_Buf ) ! PlatformPtMesh
  IF(ALLOCATED(Re_PlatformPtMesh_Buf))  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF(ALLOCATED(Db_PlatformPtMesh_Buf))  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TowerLn2Mesh_Buf ) ! TowerLn2Mesh
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf))  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf))  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrAddedMass )  ! TwrAddedMass 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PtfmAddedMass )  ! PtfmAddedMass 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitchCom )  ! BlPitchCom 
  Re_BufSz   = Re_BufSz   + 1  ! YawMom
  Re_BufSz   = Re_BufSz   + 1  ! GenTrq
  Re_BufSz   = Re_BufSz   + 1  ! HSSBrTrq
  Re_BufSz    = Re_BufSz    + SIZE( InData%AeroBladeForce )  ! AeroBladeForce 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AeroBladeMoment )  ! AeroBladeMoment 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FTAero )  ! FTAero 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MFAero )  ! MFAero 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 ) = Re_PlatformPtMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 ) = Db_PlatformPtMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 ) = Int_PlatformPtMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 ) = Re_TowerLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 ) = Db_TowerLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 ) = Int_TowerLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  IF ( ALLOCATED(InData%TwrAddedMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrAddedMass))-1 ) =  PACK(InData%TwrAddedMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrAddedMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PtfmAddedMass))-1 ) =  PACK(InData%PtfmAddedMass ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PtfmAddedMass)
  IF ( ALLOCATED(InData%BlPitchCom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitchCom))-1 ) =  PACK(InData%BlPitchCom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitchCom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenTrq )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSSBrTrq )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%AeroBladeForce) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroBladeForce))-1 ) =  PACK(InData%AeroBladeForce ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroBladeForce)
  ENDIF
  IF ( ALLOCATED(InData%AeroBladeMoment) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroBladeMoment))-1 ) =  PACK(InData%AeroBladeMoment ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroBladeMoment)
  ENDIF
  IF ( ALLOCATED(InData%FTAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTAero))-1 ) =  PACK(InData%FTAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTAero)
  ENDIF
  IF ( ALLOCATED(InData%MFAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MFAero))-1 ) =  PACK(InData%MFAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MFAero)
  ENDIF
 END SUBROUTINE ED_PackInput

 SUBROUTINE ED_UnPackInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_inputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    Re_PlatformPtMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    Db_PlatformPtMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    Int_PlatformPtMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg ) ! PlatformPtMesh 
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    Re_TowerLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    Db_TowerLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    Int_TowerLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg ) ! TowerLn2Mesh 
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  IF ( ALLOCATED(OutData%TwrAddedMass) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrAddedMass,1),SIZE(OutData%TwrAddedMass,2),SIZE(OutData%TwrAddedMass,3))); mask3 = .TRUE.
    OutData%TwrAddedMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrAddedMass))-1 ),mask3,OutData%TwrAddedMass)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrAddedMass)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PtfmAddedMass,1),SIZE(OutData%PtfmAddedMass,2))); mask2 = .TRUE.
  OutData%PtfmAddedMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PtfmAddedMass))-1 ),mask2,OutData%PtfmAddedMass)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PtfmAddedMass)
  IF ( ALLOCATED(OutData%BlPitchCom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitchCom,1))); mask1 = .TRUE.
    OutData%BlPitchCom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitchCom))-1 ),mask1,OutData%BlPitchCom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitchCom)
  ENDIF
  OutData%YawMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GenTrq = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HSSBrTrq = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%AeroBladeForce) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AeroBladeForce,1),SIZE(OutData%AeroBladeForce,2),SIZE(OutData%AeroBladeForce,3))); mask3 = .TRUE.
    OutData%AeroBladeForce = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroBladeForce))-1 ),mask3,OutData%AeroBladeForce)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroBladeForce)
  ENDIF
  IF ( ALLOCATED(OutData%AeroBladeMoment) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AeroBladeMoment,1),SIZE(OutData%AeroBladeMoment,2),SIZE(OutData%AeroBladeMoment,3))); mask3 = .TRUE.
    OutData%AeroBladeMoment = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroBladeMoment))-1 ),mask3,OutData%AeroBladeMoment)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroBladeMoment)
  ENDIF
  IF ( ALLOCATED(OutData%FTAero) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FTAero,1),SIZE(OutData%FTAero,2))); mask2 = .TRUE.
    OutData%FTAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTAero))-1 ),mask2,OutData%FTAero)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTAero)
  ENDIF
  IF ( ALLOCATED(OutData%MFAero) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MFAero,1),SIZE(OutData%MFAero,2))); mask2 = .TRUE.
    OutData%MFAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MFAero))-1 ),mask2,OutData%MFAero)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MFAero)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInput

 SUBROUTINE ED_CopyOutput( SrcOutputData, DstOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_outputtype), INTENT(INOUT) :: SrcOutputData
   TYPE(ED_outputtype), INTENT(INOUT) :: DstOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
     CALL MeshCopy( SrcOutputData%PlatformPtMesh, DstOutputData%PlatformPtMesh, CtrlCode, ErrStat, ErrMsg )
     CALL MeshCopy( SrcOutputData%TowerLn2Mesh, DstOutputData%TowerLn2Mesh, CtrlCode, ErrStat, ErrMsg )
IF (ALLOCATED(SrcOutputData%AllOuts)) THEN
   i1_l = LBOUND(SrcOutputData%AllOuts,1)
   i1_u = UBOUND(SrcOutputData%AllOuts,1)
   IF (.NOT.ALLOCATED(DstOutputData%AllOuts)) THEN 
      ALLOCATE(DstOutputData%AllOuts(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOutput: Error allocating DstOutputData%AllOuts.'
         RETURN
      END IF
   END IF
   DstOutputData%AllOuts = SrcOutputData%AllOuts
ENDIF
IF (ALLOCATED(SrcOutputData%WriteOutput)) THEN
   i1_l = LBOUND(SrcOutputData%WriteOutput,1)
   i1_u = UBOUND(SrcOutputData%WriteOutput,1)
   IF (.NOT.ALLOCATED(DstOutputData%WriteOutput)) THEN 
      ALLOCATE(DstOutputData%WriteOutput(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOutput: Error allocating DstOutputData%WriteOutput.'
         RETURN
      END IF
   END IF
   DstOutputData%WriteOutput = SrcOutputData%WriteOutput
ENDIF
IF (ALLOCATED(SrcOutputData%BlPitch)) THEN
   i1_l = LBOUND(SrcOutputData%BlPitch,1)
   i1_u = UBOUND(SrcOutputData%BlPitch,1)
   IF (.NOT.ALLOCATED(DstOutputData%BlPitch)) THEN 
      ALLOCATE(DstOutputData%BlPitch(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'ED_CopyOutput: Error allocating DstOutputData%BlPitch.'
         RETURN
      END IF
   END IF
   DstOutputData%BlPitch = SrcOutputData%BlPitch
ENDIF
   DstOutputData%Yaw = SrcOutputData%Yaw
   DstOutputData%YawRate = SrcOutputData%YawRate
   DstOutputData%LSS_Spd = SrcOutputData%LSS_Spd
   DstOutputData%HSS_Spd = SrcOutputData%HSS_Spd
   DstOutputData%RotSpeed = SrcOutputData%RotSpeed
   DstOutputData%TwrAccel = SrcOutputData%TwrAccel
   DstOutputData%YawAngle = SrcOutputData%YawAngle
   DstOutputData%RootMyc = SrcOutputData%RootMyc
   DstOutputData%YawBrTAxp = SrcOutputData%YawBrTAxp
   DstOutputData%YawBrTAyp = SrcOutputData%YawBrTAyp
   DstOutputData%LSSTipPxa = SrcOutputData%LSSTipPxa
   DstOutputData%RootMxc = SrcOutputData%RootMxc
   DstOutputData%LSSTipMya = SrcOutputData%LSSTipMya
   DstOutputData%LSSTipMza = SrcOutputData%LSSTipMza
   DstOutputData%LSSTipMys = SrcOutputData%LSSTipMys
   DstOutputData%LSSTipMzs = SrcOutputData%LSSTipMzs
   DstOutputData%YawBrMyn = SrcOutputData%YawBrMyn
   DstOutputData%YawBrMzn = SrcOutputData%YawBrMzn
   DstOutputData%NcIMURAxs = SrcOutputData%NcIMURAxs
   DstOutputData%NcIMURAys = SrcOutputData%NcIMURAys
   DstOutputData%NcIMURAzs = SrcOutputData%NcIMURAzs
   DstOutputData%RotPwr = SrcOutputData%RotPwr
 END SUBROUTINE ED_CopyOutput

 SUBROUTINE ED_DestroyOutput( OutputData, ErrStat, ErrMsg )
  TYPE(ED_outputtype), INTENT(INOUT) :: OutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL MeshDestroy( OutputData%PlatformPtMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%TowerLn2Mesh, ErrStat, ErrMsg )
  IF ( ALLOCATED(OutputData%AllOuts) ) DEALLOCATE(OutputData%AllOuts)
  IF ( ALLOCATED(OutputData%WriteOutput) ) DEALLOCATE(OutputData%WriteOutput)
  IF ( ALLOCATED(OutputData%BlPitch) ) DEALLOCATE(OutputData%BlPitch)
 END SUBROUTINE ED_DestroyOutput

 SUBROUTINE ED_PackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_outputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Int_PlatformPtMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_PlatformPtMesh_Buf ) ! PlatformPtMesh
  IF(ALLOCATED(Re_PlatformPtMesh_Buf))  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF(ALLOCATED(Db_PlatformPtMesh_Buf))  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TowerLn2Mesh_Buf ) ! TowerLn2Mesh
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf))  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf))  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  Re_BufSz    = Re_BufSz    + SIZE( InData%AllOuts )  ! AllOuts 
  Re_BufSz    = Re_BufSz    + SIZE( InData%WriteOutput )  ! WriteOutput 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz   = Re_BufSz   + 1  ! Yaw
  Re_BufSz   = Re_BufSz   + 1  ! YawRate
  Re_BufSz   = Re_BufSz   + 1  ! LSS_Spd
  Re_BufSz   = Re_BufSz   + 1  ! HSS_Spd
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
  Re_BufSz   = Re_BufSz   + 1  ! TwrAccel
  Re_BufSz   = Re_BufSz   + 1  ! YawAngle
  Re_BufSz    = Re_BufSz    + SIZE( InData%RootMyc )  ! RootMyc 
  Re_BufSz   = Re_BufSz   + 1  ! YawBrTAxp
  Re_BufSz   = Re_BufSz   + 1  ! YawBrTAyp
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipPxa
  Re_BufSz    = Re_BufSz    + SIZE( InData%RootMxc )  ! RootMxc 
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMya
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMza
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMys
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMzs
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMyn
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMzn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAxs
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAys
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAzs
  Re_BufSz   = Re_BufSz   + 1  ! RotPwr
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 ) = Re_PlatformPtMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 ) = Db_PlatformPtMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 ) = Int_PlatformPtMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 ) = Re_TowerLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 ) = Db_TowerLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 ) = Int_TowerLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  IF ( ALLOCATED(InData%AllOuts) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AllOuts))-1 ) =  PACK(InData%AllOuts ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AllOuts)
  ENDIF
  IF ( ALLOCATED(InData%WriteOutput) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%WriteOutput))-1 ) =  PACK(InData%WriteOutput ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%WriteOutput)
  ENDIF
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Yaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawRate )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSS_Spd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSS_Spd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrAccel )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawAngle )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RootMyc))-1 ) =  PACK(InData%RootMyc ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RootMyc)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrTAxp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrTAyp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipPxa )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RootMxc))-1 ) =  PACK(InData%RootMxc ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RootMxc)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMya )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMza )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMys )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMzs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAxs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAys )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAzs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotPwr )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackOutput

 SUBROUTINE ED_UnPackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_outputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    Re_PlatformPtMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    Db_PlatformPtMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    Int_PlatformPtMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg ) ! PlatformPtMesh 
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    Re_TowerLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    Db_TowerLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    Int_TowerLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg ) ! TowerLn2Mesh 
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  IF ( ALLOCATED(OutData%AllOuts) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AllOuts,1))); mask1 = .TRUE.
    OutData%AllOuts = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AllOuts))-1 ),mask1,OutData%AllOuts)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AllOuts)
  ENDIF
  IF ( ALLOCATED(OutData%WriteOutput) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WriteOutput,1))); mask1 = .TRUE.
    OutData%WriteOutput = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%WriteOutput))-1 ),mask1,OutData%WriteOutput)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%WriteOutput)
  ENDIF
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1))); mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  OutData%Yaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawRate = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSS_Spd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HSS_Spd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrAccel = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawAngle = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%RootMyc,1))); mask1 = .TRUE.
  OutData%RootMyc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RootMyc))-1 ),mask1,OutData%RootMyc)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RootMyc)
  OutData%YawBrTAxp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrTAyp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipPxa = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%RootMxc,1))); mask1 = .TRUE.
  OutData%RootMxc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RootMxc))-1 ),mask1,OutData%RootMxc)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RootMxc)
  OutData%LSSTipMya = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMza = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMys = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMzs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAxs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAys = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAzs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotPwr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackOutput

 SUBROUTINE ED_Pack( Re_RetAry, Db_RetAry, Int_RetAry, &
                     InData, ParamData, ContStateData, DiscStateData, &
                     ConstrStateData, OtherStateData, OutData, ErrStat, ErrMsg, &
                     SizeOnly )
  TYPE(ED_InputType),           INTENT(INOUT) :: InData
  TYPE(ED_ParameterType),       INTENT(INOUT) :: ParamData
  TYPE(ED_ContinuousStateType), INTENT(INOUT) :: ContStateData
  TYPE(ED_DiscreteStateType),   INTENT(INOUT) :: DiscStateData
  TYPE(ED_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  TYPE(ED_OtherStateType),      INTENT(INOUT) :: OtherStateData
  TYPE(ED_OutputType),          INTENT(INOUT) :: OutData
  REAL(ReKi), ALLOCATABLE,      INTENT(  OUT) :: Re_RetAry(:)
  REAL(DbKi), ALLOCATABLE,      INTENT(  OUT) :: Db_RetAry(:)
  INTEGER(IntKi), ALLOCATABLE,  INTENT(  OUT) :: Int_RetAry(:)
  INTEGER(IntKi),               INTENT(  OUT) :: ErrStat
  CHARACTER(*),                 INTENT(  OUT) :: ErrMsg
  LOGICAL, OPTIONAL,            INTENT(IN   ) :: SizeOnly
    ! Local variables
  REAL(ReKi), ALLOCATABLE                :: Re_Ary(:)
  REAL(DbKi), ALLOCATABLE                :: Db_Ary(:)
  INTEGER(IntKi), ALLOCATABLE            :: Int_Ary(:)
  INTEGER(IntKi)                         :: Re_BufSz
  INTEGER(IntKi)                         :: Re_Xferred
  INTEGER(IntKi)                         :: Re_CurrSz
  INTEGER(IntKi)                         :: Db_BufSz
  INTEGER(IntKi)                         :: Db_Xferred
  INTEGER(IntKi)                         :: Db_CurrSz
  INTEGER(IntKi)                         :: Int_BufSz
  INTEGER(IntKi)                         :: Int_Xferred
  INTEGER(IntKi)                         :: Int_CurrSz
  INTEGER(IntKi)                         :: ErrStat2
  CHARACTER(Len(ErrMsg))                 :: ErrMsg2
  LOGICAL                                :: OnlySize ! if present and true, do not pack, just allocate buffers
    ! Executable statements
  ErrStat = ErrID_None
  ErrMsg  = ""
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! Pack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
  Re_Xferred  = Re_Xferred - 1
  Db_Xferred  = Db_Xferred - 1
  Int_Xferred  = Int_Xferred - 1
  IF ( ALLOCATED( Re_RetAry ) ) DEALLOCATE( Re_RetAry ) ;
  IF ( Re_Xferred .GT. 0) ALLOCATE( Re_RetAry( Re_Xferred ) ) ;
  IF ( ALLOCATED( Db_RetAry ) ) DEALLOCATE( Db_RetAry ) ;
  IF ( Db_Xferred .GT. 0) ALLOCATE( Db_RetAry( Db_Xferred ) ) ;
  IF ( ALLOCATED( Int_RetAry ) ) DEALLOCATE( Int_RetAry ) ;
  IF ( Int_Xferred .GT. 0) ALLOCATE( Int_RetAry( Int_Xferred ) ) ;
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! Pack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
  Re_Xferred   = Re_Xferred - 1
  Db_Xferred   = Db_Xferred - 1
  Int_Xferred  = Int_Xferred - 1
 END SUBROUTINE ED_Pack

 SUBROUTINE ED_UnPack( Re_RetAry, Db_RetAry, Int_RetAry, &
                     InData, ParamData, ContStateData, DiscStateData, &
                     ConstrStateData, OtherStateData, OutData, ErrStat, ErrMsg )
  TYPE(ED_InputType),           INTENT(INOUT) :: InData
  TYPE(ED_ParameterType),       INTENT(INOUT) :: ParamData
  TYPE(ED_ContinuousStateType), INTENT(INOUT) :: ContStateData
  TYPE(ED_DiscreteStateType),   INTENT(INOUT) :: DiscStateData
  TYPE(ED_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  TYPE(ED_OtherStateType),      INTENT(INOUT) :: OtherStateData
  TYPE(ED_OutputType),          INTENT(INOUT) :: OutData
  REAL(ReKi), ALLOCATABLE,      INTENT(IN   ) :: Re_RetAry(:)
  REAL(DbKi), ALLOCATABLE,      INTENT(IN   ) :: Db_RetAry(:)
  INTEGER(IntKi), ALLOCATABLE,   INTENT(IN   ) :: Int_RetAry(:)
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  REAL(ReKi), ALLOCATABLE                :: Re_Ary(:)
  REAL(DbKi), ALLOCATABLE                :: Db_Ary(:)
  INTEGER(IntKi), ALLOCATABLE            :: Int_Ary(:)
  INTEGER(IntKi)                         :: Re_BufSz
  INTEGER(IntKi)                         :: Re_Xferred
  INTEGER(IntKi)                         :: Re_CurrSz
  INTEGER(IntKi)                         :: Db_BufSz
  INTEGER(IntKi)                         :: Db_Xferred
  INTEGER(IntKi)                         :: Db_CurrSz
  INTEGER(IntKi)                         :: Int_BufSz
  INTEGER(IntKi)                         :: Int_Xferred
  INTEGER(IntKi)                         :: Int_CurrSz
  INTEGER(IntKi)                         :: ErrStat2
  CHARACTER(Len(ErrMsg))                 :: ErrMsg2
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! UnPack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL ED_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL ED_UnPackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPack


 SUBROUTINE ED_Input_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(ED_inputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(ED_inputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: b3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: c3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: b4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: c4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: b5       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: c5       ! temporary for extrapolation/interpolation
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i21    ! dim1 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i31    ! dim1 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i41    ! dim1 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i51    ! dim1 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i61    ! dim1 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i71    ! dim1 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i81    ! dim1 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i91    ! dim1 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i02    ! dim2 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i12    ! dim2 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i22    ! dim2 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i32    ! dim2 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i42    ! dim2 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i52    ! dim2 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i62    ! dim2 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i72    ! dim2 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i82    ! dim2 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i92    ! dim2 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i03    ! dim3 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i13    ! dim3 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i23    ! dim3 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i33    ! dim3 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i43    ! dim3 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i53    ! dim3 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i63    ! dim3 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i73    ! dim3 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i83    ! dim3 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i93    ! dim3 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i04    ! dim4 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i14    ! dim4 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i24    ! dim4 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i34    ! dim4 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i44    ! dim4 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i54    ! dim4 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i64    ! dim4 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i74    ! dim4 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i84    ! dim4 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i94    ! dim4 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i05    ! dim5 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i15    ! dim5 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i25    ! dim5 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i35    ! dim5 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i45    ! dim5 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i55    ! dim5 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i65    ! dim5 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i75    ! dim5 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i85    ! dim5 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i95    ! dim5 level 9 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in ED_Input_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
  CALL MeshCopy(u(1)%PlatformPtMesh, u_out%PlatformPtMesh, MESH_UPDATECOPY, ErrStat, ErrMsg )
  CALL MeshCopy(u(1)%TowerLn2Mesh, u_out%TowerLn2Mesh, MESH_UPDATECOPY, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  u_out%TwrAddedMass = u(1)%TwrAddedMass
END IF ! check if allocated
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  u_out%BlPitchCom = u(1)%BlPitchCom
END IF ! check if allocated
  u_out%YawMom = u(1)%YawMom
  u_out%GenTrq = u(1)%GenTrq
  u_out%HSSBrTrq = u(1)%HSSBrTrq
IF (ALLOCATED(u_out%AeroBladeForce) .AND. ALLOCATED(u(1)%AeroBladeForce)) THEN
  u_out%AeroBladeForce = u(1)%AeroBladeForce
END IF ! check if allocated
IF (ALLOCATED(u_out%AeroBladeMoment) .AND. ALLOCATED(u(1)%AeroBladeMoment)) THEN
  u_out%AeroBladeMoment = u(1)%AeroBladeMoment
END IF ! check if allocated
IF (ALLOCATED(u_out%FTAero) .AND. ALLOCATED(u(1)%FTAero)) THEN
  u_out%FTAero = u(1)%FTAero
END IF ! check if allocated
IF (ALLOCATED(u_out%MFAero) .AND. ALLOCATED(u(1)%MFAero)) THEN
  u_out%MFAero = u(1)%MFAero
END IF ! check if allocated
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  CALL MeshExtrapInterp1(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat, ErrMsg )
  CALL MeshExtrapInterp1(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  ALLOCATE(b3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  ALLOCATE(c3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  b3 = -(u(1)%TwrAddedMass - u(2)%TwrAddedMass)/t(2)
  u_out%TwrAddedMass = u(1)%TwrAddedMass + b3 * t_out
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
  ALLOCATE(b2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  ALLOCATE(c2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  b2 = -(u(1)%PtfmAddedMass - u(2)%PtfmAddedMass)/t(2)
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitchCom,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitchCom,1)))
  b1 = -(u(1)%BlPitchCom - u(2)%BlPitchCom)/t(2)
  u_out%BlPitchCom = u(1)%BlPitchCom + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = -(u(1)%YawMom - u(2)%YawMom)/t(2)
  u_out%YawMom = u(1)%YawMom + b0 * t_out
  b0 = -(u(1)%GenTrq - u(2)%GenTrq)/t(2)
  u_out%GenTrq = u(1)%GenTrq + b0 * t_out
  b0 = -(u(1)%HSSBrTrq - u(2)%HSSBrTrq)/t(2)
  u_out%HSSBrTrq = u(1)%HSSBrTrq + b0 * t_out
IF (ALLOCATED(u_out%AeroBladeForce) .AND. ALLOCATED(u(1)%AeroBladeForce)) THEN
  ALLOCATE(b3(SIZE(u_out%AeroBladeForce,1),SIZE(u_out%AeroBladeForce,2), &
              SIZE(u_out%AeroBladeForce,3)                     ))
  ALLOCATE(c3(SIZE(u_out%AeroBladeForce,1),SIZE(u_out%AeroBladeForce,2), &
              SIZE(u_out%AeroBladeForce,3)                     ))
  b3 = -(u(1)%AeroBladeForce - u(2)%AeroBladeForce)/t(2)
  u_out%AeroBladeForce = u(1)%AeroBladeForce + b3 * t_out
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
IF (ALLOCATED(u_out%AeroBladeMoment) .AND. ALLOCATED(u(1)%AeroBladeMoment)) THEN
  ALLOCATE(b3(SIZE(u_out%AeroBladeMoment,1),SIZE(u_out%AeroBladeMoment,2), &
              SIZE(u_out%AeroBladeMoment,3)                     ))
  ALLOCATE(c3(SIZE(u_out%AeroBladeMoment,1),SIZE(u_out%AeroBladeMoment,2), &
              SIZE(u_out%AeroBladeMoment,3)                     ))
  b3 = -(u(1)%AeroBladeMoment - u(2)%AeroBladeMoment)/t(2)
  u_out%AeroBladeMoment = u(1)%AeroBladeMoment + b3 * t_out
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
IF (ALLOCATED(u_out%FTAero) .AND. ALLOCATED(u(1)%FTAero)) THEN
  ALLOCATE(b2(SIZE(u_out%FTAero,1),SIZE(u_out%FTAero,2) ))
  ALLOCATE(c2(SIZE(u_out%FTAero,1),SIZE(u_out%FTAero,2) ))
  b2 = -(u(1)%FTAero - u(2)%FTAero)/t(2)
  u_out%FTAero = u(1)%FTAero + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
IF (ALLOCATED(u_out%MFAero) .AND. ALLOCATED(u(1)%MFAero)) THEN
  ALLOCATE(b2(SIZE(u_out%MFAero,1),SIZE(u_out%MFAero,2) ))
  ALLOCATE(c2(SIZE(u_out%MFAero,1),SIZE(u_out%MFAero,2) ))
  b2 = -(u(1)%MFAero - u(2)%MFAero)/t(2)
  u_out%MFAero = u(1)%MFAero + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  CALL MeshExtrapInterp2(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, u(3)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat, ErrMsg )
  CALL MeshExtrapInterp2(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, u(3)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  ALLOCATE(b3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  ALLOCATE(c3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  b3 = (t(3)**2*(u(1)%TwrAddedMass - u(2)%TwrAddedMass) + t(2)**2*(-u(1)%TwrAddedMass + u(3)%TwrAddedMass))/(t(2)*t(3)*(t(2) - t(3)))
  c3 = ( (t(2)-t(3))*u(1)%TwrAddedMass + t(3)*u(2)%TwrAddedMass - t(2)*u(3)%TwrAddedMass ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TwrAddedMass = u(1)%TwrAddedMass + b3 * t_out + c3 * t_out**2
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
  ALLOCATE(b2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  ALLOCATE(c2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  b2 = (t(3)**2*(u(1)%PtfmAddedMass - u(2)%PtfmAddedMass) + t(2)**2*(-u(1)%PtfmAddedMass + u(3)%PtfmAddedMass))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%PtfmAddedMass + t(3)*u(2)%PtfmAddedMass - t(2)*u(3)%PtfmAddedMass ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitchCom,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitchCom,1)))
  b1 = (t(3)**2*(u(1)%BlPitchCom - u(2)%BlPitchCom) + t(2)**2*(-u(1)%BlPitchCom + u(3)%BlPitchCom))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%BlPitchCom + t(3)*u(2)%BlPitchCom - t(2)*u(3)%BlPitchCom ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%BlPitchCom = u(1)%BlPitchCom + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = (t(3)**2*(u(1)%YawMom - u(2)%YawMom) + t(2)**2*(-u(1)%YawMom + u(3)%YawMom))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawMom + t(3)*u(2)%YawMom - t(2)*u(3)%YawMom ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawMom = u(1)%YawMom + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%GenTrq - u(2)%GenTrq) + t(2)**2*(-u(1)%GenTrq + u(3)%GenTrq))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%GenTrq + t(3)*u(2)%GenTrq - t(2)*u(3)%GenTrq ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%GenTrq = u(1)%GenTrq + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%HSSBrTrq - u(2)%HSSBrTrq) + t(2)**2*(-u(1)%HSSBrTrq + u(3)%HSSBrTrq))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%HSSBrTrq + t(3)*u(2)%HSSBrTrq - t(2)*u(3)%HSSBrTrq ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%HSSBrTrq = u(1)%HSSBrTrq + b0 * t_out + c0 * t_out**2
IF (ALLOCATED(u_out%AeroBladeForce) .AND. ALLOCATED(u(1)%AeroBladeForce)) THEN
  ALLOCATE(b3(SIZE(u_out%AeroBladeForce,1),SIZE(u_out%AeroBladeForce,2), &
              SIZE(u_out%AeroBladeForce,3)                     ))
  ALLOCATE(c3(SIZE(u_out%AeroBladeForce,1),SIZE(u_out%AeroBladeForce,2), &
              SIZE(u_out%AeroBladeForce,3)                     ))
  b3 = (t(3)**2*(u(1)%AeroBladeForce - u(2)%AeroBladeForce) + t(2)**2*(-u(1)%AeroBladeForce + u(3)%AeroBladeForce))/(t(2)*t(3)*(t(2) - t(3)))
  c3 = ( (t(2)-t(3))*u(1)%AeroBladeForce + t(3)*u(2)%AeroBladeForce - t(2)*u(3)%AeroBladeForce ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%AeroBladeForce = u(1)%AeroBladeForce + b3 * t_out + c3 * t_out**2
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
IF (ALLOCATED(u_out%AeroBladeMoment) .AND. ALLOCATED(u(1)%AeroBladeMoment)) THEN
  ALLOCATE(b3(SIZE(u_out%AeroBladeMoment,1),SIZE(u_out%AeroBladeMoment,2), &
              SIZE(u_out%AeroBladeMoment,3)                     ))
  ALLOCATE(c3(SIZE(u_out%AeroBladeMoment,1),SIZE(u_out%AeroBladeMoment,2), &
              SIZE(u_out%AeroBladeMoment,3)                     ))
  b3 = (t(3)**2*(u(1)%AeroBladeMoment - u(2)%AeroBladeMoment) + t(2)**2*(-u(1)%AeroBladeMoment + u(3)%AeroBladeMoment))/(t(2)*t(3)*(t(2) - t(3)))
  c3 = ( (t(2)-t(3))*u(1)%AeroBladeMoment + t(3)*u(2)%AeroBladeMoment - t(2)*u(3)%AeroBladeMoment ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%AeroBladeMoment = u(1)%AeroBladeMoment + b3 * t_out + c3 * t_out**2
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
IF (ALLOCATED(u_out%FTAero) .AND. ALLOCATED(u(1)%FTAero)) THEN
  ALLOCATE(b2(SIZE(u_out%FTAero,1),SIZE(u_out%FTAero,2) ))
  ALLOCATE(c2(SIZE(u_out%FTAero,1),SIZE(u_out%FTAero,2) ))
  b2 = (t(3)**2*(u(1)%FTAero - u(2)%FTAero) + t(2)**2*(-u(1)%FTAero + u(3)%FTAero))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%FTAero + t(3)*u(2)%FTAero - t(2)*u(3)%FTAero ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%FTAero = u(1)%FTAero + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
IF (ALLOCATED(u_out%MFAero) .AND. ALLOCATED(u(1)%MFAero)) THEN
  ALLOCATE(b2(SIZE(u_out%MFAero,1),SIZE(u_out%MFAero,2) ))
  ALLOCATE(c2(SIZE(u_out%MFAero,1),SIZE(u_out%MFAero,2) ))
  b2 = (t(3)**2*(u(1)%MFAero - u(2)%MFAero) + t(2)**2*(-u(1)%MFAero + u(3)%MFAero))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%MFAero + t(3)*u(2)%MFAero - t(2)*u(3)%MFAero ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%MFAero = u(1)%MFAero + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in ED_Input_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE ED_Input_ExtrapInterp


 SUBROUTINE ED_Output_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(ED_outputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(ED_outputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: b3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: c3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: b4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: c4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: b5       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: c5       ! temporary for extrapolation/interpolation
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i21    ! dim1 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i31    ! dim1 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i41    ! dim1 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i51    ! dim1 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i61    ! dim1 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i71    ! dim1 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i81    ! dim1 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i91    ! dim1 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i02    ! dim2 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i12    ! dim2 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i22    ! dim2 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i32    ! dim2 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i42    ! dim2 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i52    ! dim2 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i62    ! dim2 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i72    ! dim2 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i82    ! dim2 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i92    ! dim2 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i03    ! dim3 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i13    ! dim3 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i23    ! dim3 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i33    ! dim3 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i43    ! dim3 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i53    ! dim3 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i63    ! dim3 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i73    ! dim3 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i83    ! dim3 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i93    ! dim3 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i04    ! dim4 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i14    ! dim4 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i24    ! dim4 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i34    ! dim4 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i44    ! dim4 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i54    ! dim4 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i64    ! dim4 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i74    ! dim4 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i84    ! dim4 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i94    ! dim4 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i05    ! dim5 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i15    ! dim5 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i25    ! dim5 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i35    ! dim5 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i45    ! dim5 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i55    ! dim5 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i65    ! dim5 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i75    ! dim5 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i85    ! dim5 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i95    ! dim5 level 9 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in ED_Output_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
  CALL MeshCopy(u(1)%PlatformPtMesh, u_out%PlatformPtMesh, MESH_UPDATECOPY, ErrStat, ErrMsg )
  CALL MeshCopy(u(1)%TowerLn2Mesh, u_out%TowerLn2Mesh, MESH_UPDATECOPY, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%AllOuts) .AND. ALLOCATED(u(1)%AllOuts)) THEN
  u_out%AllOuts = u(1)%AllOuts
END IF ! check if allocated
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  u_out%WriteOutput = u(1)%WriteOutput
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  u_out%BlPitch = u(1)%BlPitch
END IF ! check if allocated
  u_out%Yaw = u(1)%Yaw
  u_out%YawRate = u(1)%YawRate
  u_out%LSS_Spd = u(1)%LSS_Spd
  u_out%HSS_Spd = u(1)%HSS_Spd
  u_out%RotSpeed = u(1)%RotSpeed
  u_out%TwrAccel = u(1)%TwrAccel
  u_out%YawAngle = u(1)%YawAngle
  u_out%RootMyc = u(1)%RootMyc
  u_out%YawBrTAxp = u(1)%YawBrTAxp
  u_out%YawBrTAyp = u(1)%YawBrTAyp
  u_out%LSSTipPxa = u(1)%LSSTipPxa
  u_out%RootMxc = u(1)%RootMxc
  u_out%LSSTipMya = u(1)%LSSTipMya
  u_out%LSSTipMza = u(1)%LSSTipMza
  u_out%LSSTipMys = u(1)%LSSTipMys
  u_out%LSSTipMzs = u(1)%LSSTipMzs
  u_out%YawBrMyn = u(1)%YawBrMyn
  u_out%YawBrMzn = u(1)%YawBrMzn
  u_out%NcIMURAxs = u(1)%NcIMURAxs
  u_out%NcIMURAys = u(1)%NcIMURAys
  u_out%NcIMURAzs = u(1)%NcIMURAzs
  u_out%RotPwr = u(1)%RotPwr
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  CALL MeshExtrapInterp1(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat, ErrMsg )
  CALL MeshExtrapInterp1(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%AllOuts) .AND. ALLOCATED(u(1)%AllOuts)) THEN
  ALLOCATE(b1(SIZE(u_out%AllOuts,1)))
  ALLOCATE(c1(SIZE(u_out%AllOuts,1)))
  b1 = -(u(1)%AllOuts - u(2)%AllOuts)/t(2)
  u_out%AllOuts = u(1)%AllOuts + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  ALLOCATE(b1(SIZE(u_out%WriteOutput,1)))
  ALLOCATE(c1(SIZE(u_out%WriteOutput,1)))
  b1 = -(u(1)%WriteOutput - u(2)%WriteOutput)/t(2)
  u_out%WriteOutput = u(1)%WriteOutput + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitch,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitch,1)))
  b1 = -(u(1)%BlPitch - u(2)%BlPitch)/t(2)
  u_out%BlPitch = u(1)%BlPitch + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = -(u(1)%Yaw - u(2)%Yaw)/t(2)
  u_out%Yaw = u(1)%Yaw + b0 * t_out
  b0 = -(u(1)%YawRate - u(2)%YawRate)/t(2)
  u_out%YawRate = u(1)%YawRate + b0 * t_out
  b0 = -(u(1)%LSS_Spd - u(2)%LSS_Spd)/t(2)
  u_out%LSS_Spd = u(1)%LSS_Spd + b0 * t_out
  b0 = -(u(1)%HSS_Spd - u(2)%HSS_Spd)/t(2)
  u_out%HSS_Spd = u(1)%HSS_Spd + b0 * t_out
  b0 = -(u(1)%RotSpeed - u(2)%RotSpeed)/t(2)
  u_out%RotSpeed = u(1)%RotSpeed + b0 * t_out
  b0 = -(u(1)%TwrAccel - u(2)%TwrAccel)/t(2)
  u_out%TwrAccel = u(1)%TwrAccel + b0 * t_out
  b0 = -(u(1)%YawAngle - u(2)%YawAngle)/t(2)
  u_out%YawAngle = u(1)%YawAngle + b0 * t_out
  ALLOCATE(b1(SIZE(u_out%RootMyc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMyc,1)))
  b1 = -(u(1)%RootMyc - u(2)%RootMyc)/t(2)
  u_out%RootMyc = u(1)%RootMyc + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%YawBrTAxp - u(2)%YawBrTAxp)/t(2)
  u_out%YawBrTAxp = u(1)%YawBrTAxp + b0 * t_out
  b0 = -(u(1)%YawBrTAyp - u(2)%YawBrTAyp)/t(2)
  u_out%YawBrTAyp = u(1)%YawBrTAyp + b0 * t_out
  b0 = -(u(1)%LSSTipPxa - u(2)%LSSTipPxa)/t(2)
  u_out%LSSTipPxa = u(1)%LSSTipPxa + b0 * t_out
  ALLOCATE(b1(SIZE(u_out%RootMxc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMxc,1)))
  b1 = -(u(1)%RootMxc - u(2)%RootMxc)/t(2)
  u_out%RootMxc = u(1)%RootMxc + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%LSSTipMya - u(2)%LSSTipMya)/t(2)
  u_out%LSSTipMya = u(1)%LSSTipMya + b0 * t_out
  b0 = -(u(1)%LSSTipMza - u(2)%LSSTipMza)/t(2)
  u_out%LSSTipMza = u(1)%LSSTipMza + b0 * t_out
  b0 = -(u(1)%LSSTipMys - u(2)%LSSTipMys)/t(2)
  u_out%LSSTipMys = u(1)%LSSTipMys + b0 * t_out
  b0 = -(u(1)%LSSTipMzs - u(2)%LSSTipMzs)/t(2)
  u_out%LSSTipMzs = u(1)%LSSTipMzs + b0 * t_out
  b0 = -(u(1)%YawBrMyn - u(2)%YawBrMyn)/t(2)
  u_out%YawBrMyn = u(1)%YawBrMyn + b0 * t_out
  b0 = -(u(1)%YawBrMzn - u(2)%YawBrMzn)/t(2)
  u_out%YawBrMzn = u(1)%YawBrMzn + b0 * t_out
  b0 = -(u(1)%NcIMURAxs - u(2)%NcIMURAxs)/t(2)
  u_out%NcIMURAxs = u(1)%NcIMURAxs + b0 * t_out
  b0 = -(u(1)%NcIMURAys - u(2)%NcIMURAys)/t(2)
  u_out%NcIMURAys = u(1)%NcIMURAys + b0 * t_out
  b0 = -(u(1)%NcIMURAzs - u(2)%NcIMURAzs)/t(2)
  u_out%NcIMURAzs = u(1)%NcIMURAzs + b0 * t_out
  b0 = -(u(1)%RotPwr - u(2)%RotPwr)/t(2)
  u_out%RotPwr = u(1)%RotPwr + b0 * t_out
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  CALL MeshExtrapInterp2(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, u(3)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat, ErrMsg )
  CALL MeshExtrapInterp2(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, u(3)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%AllOuts) .AND. ALLOCATED(u(1)%AllOuts)) THEN
  ALLOCATE(b1(SIZE(u_out%AllOuts,1)))
  ALLOCATE(c1(SIZE(u_out%AllOuts,1)))
  b1 = (t(3)**2*(u(1)%AllOuts - u(2)%AllOuts) + t(2)**2*(-u(1)%AllOuts + u(3)%AllOuts))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%AllOuts + t(3)*u(2)%AllOuts - t(2)*u(3)%AllOuts ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%AllOuts = u(1)%AllOuts + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  ALLOCATE(b1(SIZE(u_out%WriteOutput,1)))
  ALLOCATE(c1(SIZE(u_out%WriteOutput,1)))
  b1 = (t(3)**2*(u(1)%WriteOutput - u(2)%WriteOutput) + t(2)**2*(-u(1)%WriteOutput + u(3)%WriteOutput))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%WriteOutput + t(3)*u(2)%WriteOutput - t(2)*u(3)%WriteOutput ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%WriteOutput = u(1)%WriteOutput + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitch,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitch,1)))
  b1 = (t(3)**2*(u(1)%BlPitch - u(2)%BlPitch) + t(2)**2*(-u(1)%BlPitch + u(3)%BlPitch))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%BlPitch + t(3)*u(2)%BlPitch - t(2)*u(3)%BlPitch ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%BlPitch = u(1)%BlPitch + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = (t(3)**2*(u(1)%Yaw - u(2)%Yaw) + t(2)**2*(-u(1)%Yaw + u(3)%Yaw))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%Yaw + t(3)*u(2)%Yaw - t(2)*u(3)%Yaw ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%Yaw = u(1)%Yaw + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawRate - u(2)%YawRate) + t(2)**2*(-u(1)%YawRate + u(3)%YawRate))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawRate + t(3)*u(2)%YawRate - t(2)*u(3)%YawRate ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawRate = u(1)%YawRate + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSS_Spd - u(2)%LSS_Spd) + t(2)**2*(-u(1)%LSS_Spd + u(3)%LSS_Spd))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSS_Spd + t(3)*u(2)%LSS_Spd - t(2)*u(3)%LSS_Spd ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSS_Spd = u(1)%LSS_Spd + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%HSS_Spd - u(2)%HSS_Spd) + t(2)**2*(-u(1)%HSS_Spd + u(3)%HSS_Spd))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%HSS_Spd + t(3)*u(2)%HSS_Spd - t(2)*u(3)%HSS_Spd ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%HSS_Spd = u(1)%HSS_Spd + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%RotSpeed - u(2)%RotSpeed) + t(2)**2*(-u(1)%RotSpeed + u(3)%RotSpeed))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%RotSpeed + t(3)*u(2)%RotSpeed - t(2)*u(3)%RotSpeed ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RotSpeed = u(1)%RotSpeed + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%TwrAccel - u(2)%TwrAccel) + t(2)**2*(-u(1)%TwrAccel + u(3)%TwrAccel))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%TwrAccel + t(3)*u(2)%TwrAccel - t(2)*u(3)%TwrAccel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TwrAccel = u(1)%TwrAccel + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawAngle - u(2)%YawAngle) + t(2)**2*(-u(1)%YawAngle + u(3)%YawAngle))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawAngle + t(3)*u(2)%YawAngle - t(2)*u(3)%YawAngle ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawAngle = u(1)%YawAngle + b0 * t_out + c0 * t_out**2
  ALLOCATE(b1(SIZE(u_out%RootMyc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMyc,1)))
  b1 = (t(3)**2*(u(1)%RootMyc - u(2)%RootMyc) + t(2)**2*(-u(1)%RootMyc + u(3)%RootMyc))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%RootMyc + t(3)*u(2)%RootMyc - t(2)*u(3)%RootMyc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RootMyc = u(1)%RootMyc + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%YawBrTAxp - u(2)%YawBrTAxp) + t(2)**2*(-u(1)%YawBrTAxp + u(3)%YawBrTAxp))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrTAxp + t(3)*u(2)%YawBrTAxp - t(2)*u(3)%YawBrTAxp ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrTAxp = u(1)%YawBrTAxp + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrTAyp - u(2)%YawBrTAyp) + t(2)**2*(-u(1)%YawBrTAyp + u(3)%YawBrTAyp))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrTAyp + t(3)*u(2)%YawBrTAyp - t(2)*u(3)%YawBrTAyp ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrTAyp = u(1)%YawBrTAyp + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipPxa - u(2)%LSSTipPxa) + t(2)**2*(-u(1)%LSSTipPxa + u(3)%LSSTipPxa))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipPxa + t(3)*u(2)%LSSTipPxa - t(2)*u(3)%LSSTipPxa ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipPxa = u(1)%LSSTipPxa + b0 * t_out + c0 * t_out**2
  ALLOCATE(b1(SIZE(u_out%RootMxc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMxc,1)))
  b1 = (t(3)**2*(u(1)%RootMxc - u(2)%RootMxc) + t(2)**2*(-u(1)%RootMxc + u(3)%RootMxc))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%RootMxc + t(3)*u(2)%RootMxc - t(2)*u(3)%RootMxc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RootMxc = u(1)%RootMxc + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%LSSTipMya - u(2)%LSSTipMya) + t(2)**2*(-u(1)%LSSTipMya + u(3)%LSSTipMya))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMya + t(3)*u(2)%LSSTipMya - t(2)*u(3)%LSSTipMya ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMya = u(1)%LSSTipMya + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMza - u(2)%LSSTipMza) + t(2)**2*(-u(1)%LSSTipMza + u(3)%LSSTipMza))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMza + t(3)*u(2)%LSSTipMza - t(2)*u(3)%LSSTipMza ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMza = u(1)%LSSTipMza + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMys - u(2)%LSSTipMys) + t(2)**2*(-u(1)%LSSTipMys + u(3)%LSSTipMys))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMys + t(3)*u(2)%LSSTipMys - t(2)*u(3)%LSSTipMys ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMys = u(1)%LSSTipMys + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMzs - u(2)%LSSTipMzs) + t(2)**2*(-u(1)%LSSTipMzs + u(3)%LSSTipMzs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMzs + t(3)*u(2)%LSSTipMzs - t(2)*u(3)%LSSTipMzs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMzs = u(1)%LSSTipMzs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrMyn - u(2)%YawBrMyn) + t(2)**2*(-u(1)%YawBrMyn + u(3)%YawBrMyn))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrMyn + t(3)*u(2)%YawBrMyn - t(2)*u(3)%YawBrMyn ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrMyn = u(1)%YawBrMyn + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrMzn - u(2)%YawBrMzn) + t(2)**2*(-u(1)%YawBrMzn + u(3)%YawBrMzn))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrMzn + t(3)*u(2)%YawBrMzn - t(2)*u(3)%YawBrMzn ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrMzn = u(1)%YawBrMzn + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAxs - u(2)%NcIMURAxs) + t(2)**2*(-u(1)%NcIMURAxs + u(3)%NcIMURAxs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAxs + t(3)*u(2)%NcIMURAxs - t(2)*u(3)%NcIMURAxs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAxs = u(1)%NcIMURAxs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAys - u(2)%NcIMURAys) + t(2)**2*(-u(1)%NcIMURAys + u(3)%NcIMURAys))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAys + t(3)*u(2)%NcIMURAys - t(2)*u(3)%NcIMURAys ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAys = u(1)%NcIMURAys + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAzs - u(2)%NcIMURAzs) + t(2)**2*(-u(1)%NcIMURAzs + u(3)%NcIMURAzs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAzs + t(3)*u(2)%NcIMURAzs - t(2)*u(3)%NcIMURAzs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAzs = u(1)%NcIMURAzs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%RotPwr - u(2)%RotPwr) + t(2)**2*(-u(1)%RotPwr + u(3)%RotPwr))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%RotPwr + t(3)*u(2)%RotPwr - t(2)*u(3)%RotPwr ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RotPwr = u(1)%RotPwr + b0 * t_out + c0 * t_out**2
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in ED_Output_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE ED_Output_ExtrapInterp

END MODULE ElastoDyn_Types
!ENDOFREGISTRYGENERATEDFILE
