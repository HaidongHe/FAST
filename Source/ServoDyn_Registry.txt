###################################################################################################################################
# Registry for ServoDyn in the FAST Modularization Framework
# This Registry file is used to create MODULE ServoDyn_Types  which contains all of the user-defined types needed in ServoDyn.
# It also contains copy, destroy, pack, and unpack routines associated with each defined data types.
# See the NWTC Programmer's Handbook for further information on the format/contents of this file.
#
# Entries are of the form
# <keyword>	<ModuleName/ModName>	<TypeName>	<FieldType>	<FieldName>	<Dims>	<IO>	<DNAME>	<DESCRIP>	<UNITS>
#
# Use ^ as a shortcut for the value in the same column from the previous line.
###################################################################################################################################

#bjj NOTE: All variables initialized here should be double-checked that they are properly initialized in the new framework (i.e. can run twice)

# ...... Include files (definitions from NWTC Library) ............................................................................
# make sure that the file name does not have any trailing white spaces!
include	Registry_NWTC_Library.txt

# ..... Input file data ...........................................................................................................
# This is data defined in the Input File for this module (or could otherwise be passed in)
# ..... Primary Input file data ...........................................................................................................
typedef	ServoDyn/SrvD	SrvD_InputFile	DbKi	DT	-	-	-	"Communication interval for controllers"	s
typedef	^	SrvD_InputFile	IntKi	PCMode	-	-	-	"Pitch control mode"	-
typedef	^	SrvD_InputFile	DbKi	TPCOn	-	-	-	"Time to enable active pitch control [unused when PCMode=0]"	s
typedef	^	SrvD_InputFile	DbKi	TPitManS	3	-	-	"Time to start override pitch maneuver for blade (K) and end standard pitch control"	s
typedef	^	SrvD_InputFile	ReKi	PitManRat	3	-	-	"Pitch rates at which override pitch maneuvers head toward final pitch angles"	rad/s
typedef	^	SrvD_InputFile	ReKi	BlPitchF	3	-	-	"Blade (K) final pitch for pitch maneuvers"	radians
typedef	^	SrvD_InputFile	IntKi	VSContrl	-	-	-	"Variable-speed control mode"	-
typedef	^	SrvD_InputFile	IntKi	GenModel	-	-	-	"Generator model [used only when VSContrl=0]"	-
typedef	^	SrvD_InputFile	ReKi	GenEff	-	-	-	"Generator efficiency [ignored by the Thevenin and user-defined generator models]"	-
typedef	^	SrvD_InputFile	LOGICAL	GenTiStr	-	-	-	"Method to start the generator {T: timed using TimGenOn, F: generator speed using SpdGenOn}"	-
typedef	^	SrvD_InputFile	LOGICAL	GenTiStp	-	-	-	"Method to stop the generator {T: timed using TimGenOf, F: when generator power = 0}"	-
typedef	^	SrvD_InputFile	ReKi	SpdGenOn	-	-	-	"Generator speed to turn on the generator for a startup (HSS speed) [used only when GenTiStr=False]"	rad/s
typedef	^	SrvD_InputFile	DbKi	TimGenOn	-	-	-	"Time to turn on the generator for a startup [used only when GenTiStr=True]"	s
typedef	^	SrvD_InputFile	DbKi	TimGenOf	-	-	-	"Time to turn off the generator [used only when GenTiStp=True]"	s
typedef	^	SrvD_InputFile	ReKi	VS_RtGnSp	-	-	-	"Rated generator speed for simple variable-speed generator control (HSS side) [used only when VSContrl=1]"	rad/s
typedef	^	SrvD_InputFile	ReKi	VS_RtTq	-	-	-	"Rated generator torque/constant generator torque in Region 3 for simple variable-speed generator control (HSS side) [used only when VSContrl=1]"	N-m
typedef	^	SrvD_InputFile	ReKi	VS_Rgn2K	-	-	-	"Generator torque constant in Region 2 for simple variable-speed generator control (HSS side) [used only when VSContrl=1]"	N-m/(rad/s)^2
typedef	^	SrvD_InputFile	ReKi	VS_SlPc	-	-	-	"Rated generator slip percentage in Region 2 1/2 for simple variable-speed generator control [used only when VSContrl=1]"	-
typedef	^	SrvD_InputFile	ReKi	SIG_SlPc	-	-	-	"Rated generator slip percentage [used only when VSContrl=0 and GenModel=1]"	-
typedef	^	SrvD_InputFile	ReKi	SIG_SySp	-	-	-	"Synchronous (zero-torque) generator speed [used only when VSContrl=0 and GenModel=1]"	rad/s
typedef	^	SrvD_InputFile	ReKi	SIG_RtTq	-	-	-	"Rated torque [used only when VSContrl=0 and GenModel=1]"	N-m
typedef	^	SrvD_InputFile	ReKi	SIG_PORt	-	-	-	"Pull-out ratio (Tpullout/Trated) [used only when VSContrl=0 and GenModel=1]"	-
typedef	^	SrvD_InputFile	ReKi	TEC_Freq	-	-	-	"Line frequency [50 or 60] [used only when VSContrl=0 and GenModel=2]"	Hz
typedef	^	SrvD_InputFile	IntKi	TEC_NPol	-	-	-	"Number of poles [even integer > 0] [used only when VSContrl=0 and GenModel=2]"	-
typedef	^	SrvD_InputFile	ReKi	TEC_SRes	-	-	-	"Stator resistance [used only when VSContrl=0 and GenModel=2]"	ohms
typedef	^	SrvD_InputFile	ReKi	TEC_RRes	-	-	-	"Rotor resistance [used only when VSContrl=0 and GenModel=2]"	ohms
typedef	^	SrvD_InputFile	ReKi	TEC_VLL	-	-	-	"Line-to-line RMS voltage [used only when VSContrl=0 and GenModel=2]"	volts
typedef	^	SrvD_InputFile	ReKi	TEC_SLR	-	-	-	"Stator leakage reactance [used only when VSContrl=0 and GenModel=2]"	ohms
typedef	^	SrvD_InputFile	ReKi	TEC_RLR	-	-	-	"Rotor leakage reactance [used only when VSContrl=0 and GenModel=2]"	ohms
typedef	^	SrvD_InputFile	ReKi	TEC_MR	-	-	-	"Magnetizing reactance [used only when VSContrl=0 and GenModel=2]"	ohms
typedef	^	SrvD_InputFile	IntKi	HSSBrMode	-	-	-	"HSS brake model"	-
typedef	^	SrvD_InputFile	DbKi	THSSBrDp	-	-	-	"Time to initiate deployment of the HSS brake"	s
typedef	^	SrvD_InputFile	DbKi	HSSBrDT	-	-	-	"Time for HSS-brake to reach full deployment once initiated [used only when HSSBrMode=1]"	s
typedef	^	SrvD_InputFile	ReKi	HSSBrTqF	-	-	-	"Fully deployed HSS-brake torque"	N-m
typedef	^	SrvD_InputFile	IntKi	YCMode	-	-	-	"Yaw control mode"	-
typedef	^	SrvD_InputFile	DbKi	TYCOn	-	-	-	"Time to enable active yaw control [unused when YCMode=0]"	s
typedef	^	SrvD_InputFile	ReKi	YawNeut	-	-	-	"Neutral yaw position--yaw spring force is zero at this yaw"	radians
typedef	^	SrvD_InputFile	ReKi	YawSpr	-	-	-	"Nacelle-yaw spring constant"	N-m/rad
typedef	^	SrvD_InputFile	ReKi	YawDamp	-	-	-	"Nacelle-yaw constant"	N-m/(rad/s)
typedef	^	SrvD_InputFile	DbKi	TYawManS	-	-	-	"Time to start override yaw maneuver and end standard yaw control"	s
typedef	^	SrvD_InputFile	ReKi	YawManRat	-	-	-	"Yaw maneuver rate (in absolute value)"	rad/s
typedef	^	SrvD_InputFile	ReKi	NacYawF	-	-	-	"Final yaw angle for override yaw maneuvers"	radians
typedef	^	SrvD_InputFile	LOGICAL	SumPrint	-	-	-	"Print summary data to <RootName>.fsm?"	-
typedef	^	SrvD_InputFile	IntKi	OutFile	-	-	-	"Switch to determine where output will be placed: (1: in module output file only; 2: in glue code output file only; 3: both)"	-
typedef	^	SrvD_InputFile	LOGICAL	TabDelim	-	-	-	"Use tab delimiters in text tabular output file?"	-
typedef	^	SrvD_InputFile	CHARACTER(20)	OutFmt	-	-	-	"Format used for text tabular output (except time)"	-
#typedef	^	SrvD_InputFile	IntKi	OutFileFmt	-	-	-	"Format for module tabular (time-marching) output: {1: text file [<RootName>.out], 2: binary file [<RootName>.outb], 3: both}"	-
typedef	^	SrvD_InputFile	DbKi	Tstart	-	-	-	"Time to start module's tabular output"	s
typedef	^	SrvD_InputFile	IntKi	NumOuts	-	-	-	"Number of parameters in the output list (number of outputs requested)"	-
typedef	^	SrvD_InputFile	CHARACTER(10)	OutList	{:}	-	-	"List of user-requested output channels"	-



# ..... Internal data types .......................................................................................................




# ..... Initialization data .......................................................................................................
# Define inputs that the initialization routine may need here:
typedef	^	InitInputType	CHARACTER(1024)	InputFile	-	-	-	"Name of the input file"	-
typedef	^	^	IntKi	NumBl	-	-	-	"Number of blades on the turbine"
typedef	^	^	CHARACTER(1024)	RootName	-	-	-	"RootName for writing output files"	-
typedef	^	^	ReKi	BlPitchInit	{:}	-	-	"Initial blade pitch"	-

# Define outputs from the initialization routine here:
typedef	^	InitOutputType	CHARACTER(10)	WriteOutputHdr	{:}	-	-	"Names of the output-to-file channels"	-
typedef	^	^	CHARACTER(10)	WriteOutputUnt	{:}	-	-	"Units of the output-to-file channels"	-
typedef	^	^	ProgDesc	Ver	-	-	-	"This module's name, version, and date"	-

# ..... States ....................................................................................................................
# Define continuous (differentiable) states here:
typedef	^	ContinuousStateType	ReKi	DummyContState	-	-	-	"Remove this variable if you have continuous states"	-

# Define discrete (nondifferentiable) states here:
typedef	^	DiscreteStateType	ReKi	DummyDiscState	-	-	-	"Remove this variable if you have discrete states"	-

# Define constraint states here:
typedef	^	ConstraintStateType	ReKi	DummyConstrState	-	-	-	"Remove this variable if you have constraint states"	-

# Define "other" states (any data that are not considered actual states) here:
typedef	^	OtherStateType	ReKi	BlPitchI	{:}	-	-	"Initial blade pitch angles at the start of the override pitch maneuver"	radians
typedef	^	OtherStateType	DbKi	BegPitMan	{:}	-	-	"Time that the override pitch manuever actually began"	seconds
typedef	^	OtherStateType	DbKi	BegYawMan	-	-	-	"Time that the yaw maneuver actually began"	seconds
typedef	^	OtherStateType	ReKi	NacYawI	-	-	-	"Initial yaw angle at the start of the override yaw maneuver"	radians
typedef	^	OtherStateType	ReKi	YawManRat	-	-	-	"Yaw rate at which override yaw maneuver head toward for final yaw angle"	rad/s
typedef	^	OtherStateType	DbKi	TYawManE	-	-	-	"Time to end override yaw maneuver"	s
typedef	^	OtherStateType	ReKi	BlPitchFrct	{:}	-	-	"Blade pitch angle fractions used for the override pitch maneuver calculation"	rad/s
typedef	^	OtherStateType	DbKi	TTpBrDp	{:}	-	-	"Times to initiate deployment of tip brakes"	s
typedef	^	OtherStateType	DbKi	TTpBrFl	{:}	-	-	"Times at which tip brakes are fully deployed"	s
typedef	^	OtherStateType	DbKi	TPitManE	{:}	-	-	"Time to end pitch maneuvers for each blade"	s
typedef	^	OtherStateType	ReKi	PitManRat	{:}	-	-	"Pitch rates at which override pitch maneuvers head toward final pitch angles"	rad/s

# ..... Parameters ................................................................................................................
# Define parameters here:
# Time step for integration of continuous states (if a fixed-step integrator is used) and update of discrete states:
typedef	^	ParameterType	DbKi	DT	-	-	-	"Time step for continuous state integration & discrete state update"	seconds
# parameters from DriveTrain

#typedef	^	ParameterType	ReKi	GenCTrq	-	-	-	"Constant generator torque"
#typedef	^	ParameterType	ReKi	GenSpRZT	-	-	-	"Difference between rated and zero-torque generator speeds for SIG"
#typedef	^	ParameterType	ReKi	GenSpRat	-	-	-	"Rated generator speed"
#typedef	^	ParameterType	ReKi	GenSpZT	-	-	-	"Zero-torque generator speed"

typedef	^	ParameterType	DbKi	HSSBrDT	-	-	-	"Time it takes for HSS brake to reach full deployment once deployed"	seconds
typedef	^	ParameterType	ReKi	HSSBrFrac	-	-	-	"Fraction of full braking torque: 0 (off) <= HSSBrFrac <= 1 (full), (-). !bjj: used to be local variable in FAST.f90/Subroutine DrvTrTrq()"
typedef	^	ParameterType	ReKi	HSSBrTqF	-	-	-	"Fully deployed HSS brake torque"

typedef	^	ParameterType	ReKi	HSSBrTrqC	-	-	-	"A copy of the value of HSSBrTrq calculated in SUBROUTINE DrvTrTrq()"
typedef	^	ParameterType	ReKi	SIG_POSl	-	-	-	"Pullout slip"
typedef	^	ParameterType	ReKi	SIG_POTq	-	-	-	"Pullout torque"
typedef	^	ParameterType	ReKi	SIG_SlPc	-	-	-	"Rated generator slip percentage"
typedef	^	ParameterType	ReKi	SIG_Slop	-	-	-	"Torque/Speed slope for simple induction generator"
typedef	^	ParameterType	ReKi	SIG_SySp	-	-	-	"Synchronous (zero-torque) generator speed"	rad/s
typedef	^	ParameterType	ReKi	TEC_A0	-	-	-	"A0 term for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_C0	-	-	-	"C0 term for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_C1	-	-	-	"C1 term for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_C2	-	-	-	"C2 term for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_K2	-	-	-	"K2 term for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_MR	-	-	-	"Magnetizing reactance for Thevenin-equivalent circuit"	ohms
typedef	^	ParameterType	ReKi	TEC_Re1	-	-	-	"Thevenin's equivalent stator resistance (ohms)"	ohms
typedef	^	ParameterType	ReKi	TEC_RLR	-	-	-	"Rotor leakage reactance for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_RRes	-	-	-	"Rotor resistance for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_SRes	-	-	-	"Stator resistance for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_SySp	-	-	-	"Synchronous speed for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_V1a	-	-	-	"Source voltage for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_VLL	-	-	-	"Line-to-line RMS voltage for Thevenin-equivalent circuit"
typedef	^	ParameterType	ReKi	TEC_Xe1	-	-	-	"Thevenin's equivalent stator leakage reactance (ohms)"	ohms
typedef	^	ParameterType	ReKi	GBRatio	-	-	-	"Gearbox ratio"	"shouldn't need to be here ((only in structural)"
typedef	^	ParameterType	ReKi	GBoxEff	-	-	-	"Gearbox efficiency"	"shouldn't need to be here ((only in structural)"
typedef	^	ParameterType	ReKi	GenEff	-	-	-	"Generator efficiency"
# parameters from TurbCont
typedef	^	ParameterType	ReKi	BlPitchInit	{:}	-	-	"Initial blade pitch angles"	radians

typedef	^	ParameterType	ReKi	BlPitchF	{:}	-	-	"Final blade pitch"

typedef	^	ParameterType	ReKi	NacYawF	-	-	-	"Final yaw angle after override yaw maneuver"
typedef	^	ParameterType	ReKi	SpdGenOn	-	-	-	"Generator speed to turn on the generator for a startup"
typedef	^	ParameterType	DbKi	THSSBrDp	-	-	-	"Time to initiate deployment of the shaft brake"	s
typedef	^	ParameterType	DbKi	THSSBrFl	-	-	-	"Time at which shaft brake is fully deployed"	s
#typedef	^	ParameterType	DbKi	TiDynBrk	-	-	-	"Time to initiate deployment of the dynamic generator brake"	s
typedef	^	ParameterType	DbKi	TimGenOf	-	-	-	"Time to turn off generator for braking or modeling a run-away"	s
typedef	^	ParameterType	DbKi	TimGenOn	-	-	-	"Time to turn on generator for startup"	s
typedef	^	ParameterType	DbKi	TPCOn	-	-	-	"Time to enable active pitch control"	s
typedef	^	ParameterType	DbKi	TPitManS	{:}	-	-	"Time to start pitch maneuvers for each blade"	s
typedef	^	ParameterType	DbKi	TYawManS	-	-	-	"Time to start override yaw maneuver"	s
typedef	^	ParameterType	DbKi	TYCOn	-	-	-	"Time to enable active yaw control"	s
typedef	^	ParameterType	ReKi	VS_RtGnSp	-	-	-	"Rated generator speed (HSS side)"	rad/s
typedef	^	ParameterType	ReKi	VS_RtTq	-	-	-	"Rated generator torque/constant generator torque in Region 3 (HSS side)"	N-m
typedef	^	ParameterType	ReKi	VS_Slope	-	-	-	"Torque/speed slope of region 2 1/2 induction generator"
typedef	^	ParameterType	ReKi	VS_SlPc	-	-	-	"Rated generator slip percentage in Region 2 1/2"	%
typedef	^	ParameterType	ReKi	VS_SySp	-	-	-	"Synchronous speed of region 2 1/2 induction generator"
typedef	^	ParameterType	ReKi	VS_TrGnSp	-	-	-	"Transitional generator speed between regions 2 and 2 1/2"
typedef	^	ParameterType	ReKi	YawPosCom	-	-	-	"Commanded yaw angle from user-defined routines"	rad
typedef	^	ParameterType	ReKi	YawRateCom	-	-	-	"Commanded yaw rate  from user-defined routines"	rad/s
typedef	^	ParameterType	IntKi	GenModel	-	-	-	"Generator model"
typedef	^	ParameterType	IntKi	HSSBrMode	-	-	-	"HSS brake model"
typedef	^	ParameterType	IntKi	PCMode	-	-	-	"Pitch control mode"
typedef	^	ParameterType	IntKi	VSContrl	-	-	-	"Variable-speed-generator control switch"
typedef	^	ParameterType	IntKi	YCMode	-	-	-	"Yaw control mode"
typedef	^	ParameterType	LOGICAL	GenTiStp	-	-	-	"Stop generator based upon T: time or F: generator power = 0"
typedef	^	ParameterType	LOGICAL	GenTiStr	-	-	-	"Start generator based upon T: time or F: generator speed"
typedef	^	ParameterType	ReKi	TBDepISp	{:}	-	-	"Deployment-initiation speed for the tip brakes"	rad/s
# parameters for output
typedef	^	ParameterType	IntKi	NumOuts	-	-	-	"Number of parameters in the output list (number of outputs requested)"	-
typedef	^	ParameterType	CHARACTER(1024)	RootName	-	-	-	"RootName for writing output files"	-
typedef	^	ParameterType	OutParmType	OutParam	{:}	-	-	"Names and units (and other characteristics) of all requested output parameters"	-
typedef	^	ParameterType	CHARACTER(1)	Delim	-	-	-	"Column delimiter for output text files"	-
# parameters from InitInput
typedef	^	ParameterType	IntKi	NumBl	-	-	-	"Number of blades on the turbine"
# parameters from TurbCont
typedef	^	ParameterType	ReKi	VS_Rgn2K	-	-	-	"Generator torque constant in Region 2 for simple variable-speed generator control (HSS side) [used only when VSContrl=1]"	N-m/(rad/s)^2
typedef	^	ParameterType	ReKi	YawNeut	-	-	-	"Neutral yaw position--yaw spring force is zero at this yaw"	radians
typedef	^	ParameterType	ReKi	YawSpr	-	-	-	"Nacelle-yaw spring constant"	N-m/rad
typedef	^	ParameterType	ReKi	YawDamp	-	-	-	"Nacelle-yaw constant"	N-m/(rad/s)
typedef	^	ParameterType	DbKi	TpBrDT	-	-	-	"Time for tip-brake to reach full deployment once released"	s
typedef	^	ParameterType	ReKi	TBDrConN	-	-	-	"Tip-brake drag constant during normal operation, Cd*Area"
typedef	^	ParameterType	ReKi	TBDrConD	-	-	-	"Tip-brake drag constant during fully-deployed operation, Cd*Area"

# ..... Inputs ....................................................................................................................
# Define inputs that are contained on the mesh here:
#typedef	^	InputType	MeshType	MeshedInput	-	-	-	"Meshed input data"	-
# Define inputs that are not on this mesh here:
typedef	^	InputType	ReKi	BlPitch	{:}	-	-	"Current blade pitch angles"	radians
typedef	^	InputType	ReKi	Yaw	-	-	-	"Current nacelle yaw"	radians
typedef	^	InputType	ReKi	YawRate	-	-	-	"Current nacelle yaw rate"	rad/s
typedef	^	InputType	ReKi	LSS_Spd	-	-	-	"Low-speed shaft (LSS) speed"	rad/s
typedef	^	InputType	ReKi	RotSpeed	-	-	-	"Rotor azimuth angular speed"	rad/s
typedef	^	InputType	ReKi	ExternalYawPosCom	-	-	-	"Commanded yaw position from Simulink or Labview"	radians
typedef	^	InputType	ReKi	ExternalYawRateCom	-	-	-	"Commanded yaw rate from Simulink or Labview"	rad/s
typedef	^	InputType	ReKi	ExternalBlPitchCom	{:}	-	-	"Commanded blade pitch from Simulink or LabVIEW"	radians
typedef	^	InputType	ReKi	ExternalGenTrq	-	-	-	"Electrical generator torque"	N-m
typedef	^	InputType	ReKi	ExternalElecPwr	-	-	-	"Electrical power"	W
typedef	^	InputType	ReKi	ExternalHSSBrFrac	-	-	-	"Fraction of full braking torque: 0 (off) <= HSSBrFrac <= 1 (full)"	-

# ..... Outputs ...................................................................................................................
# Define outputs that are contained on the mesh here:
#typedef	^	OutputType	MeshType	MeshedOutput	-	-	-	"Meshed output data"	-
# Define outputs that are not on this mesh here:
typedef	^	OutputType	ReKi	WriteOutput	{:}	-	-	"Data to be written to an output file: see WriteOutputHdr for names of each variable"	"see WriteOutputUnt"
typedef	^	OutputType	ReKi	BlPitchCom	{:}	-	-	"Commanded blade pitch angles"	radians
typedef	^	OutputType	ReKi	YawMom	-	-	-	"Torque transmitted through the yaw bearing"	N-m
#typedef	^	OutputType	ReKi	GBoxTrq	-	-	-	"Gearbox torque on the LSS side"	N-m
typedef	^	OutputType	ReKi	GenTrq	-	-	-	"Electrical generator torque"	N-m
typedef	^	OutputType	ReKi	HSSBrTrq	-	-	-	"Instantaneous HSS brake torque"	N-m
typedef	^	OutputType	ReKi	ElecPwr	-	-	-	"Electrical power"	W

#typedef	^	OutputType	ReKi	HSSBrFrac	-	-	-	"Fraction of full braking torque: 0 (off) <= HSSBrFrac <= 1 (full)"

typedef	^	OutputType	ReKi	TBDrCon	{:}	-	-	"Instantaneous tip-brake drag constant, Cd*Area"
